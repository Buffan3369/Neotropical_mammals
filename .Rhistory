# add silhouette
add_phylopic(x = 50, y = 7, name = "Ricardomys longidens", ysize = 5) +
annotate(geom = "text", x = 49.8, y = 3, label = "Rodentia", size = 4) +
# EOT line
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) +
annotate(geom = "text", x = 31, y = round(nrow(TsTe_rod)/2, digits = 0), label = "EOT", size = 8, colour = "red") +
# Artificially extend plotting window
annotate(geom = "text", x = 35, y = nrow(TsTe_rod)+0.5, label = " ") +
annotate(geom = "text", x = 35, y = 0.5, label = " ") +
# GTS
coord_geo(pos = list("bottom", "bottom"),
dat = list(gsc2, gsc1),
abbrv = list(T, F),
center_end_labels = TRUE,
height = unit(1.5, "line"),
size = "auto",
xlim = c(23.03, 53)) +
theme(axis.text.y = element_text(face = "italic", size = 9),
axis.title.x = element_text(size = 18, vjust = -0.5),
axis.title.y = element_text(size = 18),
axis.text.x = element_text(size = 15),
panel.background = element_rect(fill = "grey95"),
legend.position = "top",
legend.key=element_rect(fill="white"))
Rod_plot
ggsave("./figures/Figure_3/Rodentia_turnover.pdf", Rod_plot, height = 7, width = 8.5)
ggsave("./figures/Figure_3/Rodentia_turnover.png", Rod_plot, height = 7, width = 8.5, dpi = 600)
# Plot
Rod_plot <- TsTe_rod %>%
ggplot(aes(y = fct_inorder(genus), yend = fct_inorder(genus))) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
geom_segment(aes(x = ts, xend = te)) +
scale_x_reverse(breaks = seq(from = 23.03, to = 50, by = 5)) +
labs(x = "Time (Ma)", y = "Genus", colour = NULL) +
# add silhouette
add_phylopic(x = 50, y = 7, name = "Ricardomys longidens", ysize = 5) +
annotate(geom = "text", x = 49.8, y = 3, label = "Rodentia", size = 4) +
# EOT line
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) +
annotate(geom = "text", x = 31, y = round(nrow(TsTe_rod)/2, digits = 0), label = "EOT", size = 8, colour = "red") +
# Artificially extend plotting window
annotate(geom = "text", x = 35, y = nrow(TsTe_rod)+0.5, label = " ") +
annotate(geom = "text", x = 35, y = 0.5, label = " ") +
# GTS
coord_geo(pos = list("bottom", "bottom"),
dat = list(gsc2, gsc1),
abbrv = list(T, F),
center_end_labels = TRUE,
height = unit(1.5, "line"),
size = "auto",
xlim = c(23.03, 53)) +
theme(axis.text.y = element_text(face = "italic", size = 8),
axis.title.x = element_text(size = 18),
axis.title.y = element_text(size = 18),
axis.text.x = element_text(size = 15),
panel.background = element_rect(fill = "grey95"),
legend.position = "top",
legend.key=element_rect(fill="white"))
ggsave("./figures/Figure_3/Rodentia_turnover.pdf", Rod_plot, height = 7, width = 8.5)
ggsave("./figures/Figure_3/Rodentia_turnover.png", Rod_plot, height = 7, width = 8.5, dpi = 600)
rm(list = ls())
dev.off()
## Organic d13C from Falkowski et al. (2005) and Katz et al. (2005) -------------------------------------------------------------
d13C_org <- read.table("./data_2023/MBD/raw_environment_correlates/organic_carbon/organic_carbon.txt",
sep = "\t",
fill = TRUE,
header = TRUE)
d13C_org <- d13C_org[-which(d13C_org$Age > 66.15),]
#interpolate every 10ky
interpolated <- data.frame(Age = c(NA), C13organic = c(NA))
for(t in seq(from = 0, to = 66.15, by = 0.01)){
if(t %in% d13C_org$Age){
ind <- which(d13C_org$Age == t)
interpolated <- rbind(interpolated,
d13C_org[ind,])
}
else{
interpolated <- rbind(interpolated,
c(t, NA))
}
}
interpolated <- interpolated[-c(1),]
row.names(interpolated) <- 1:nrow(interpolated)
i = 1
while(i < nrow(interpolated-1)){
if(is.na(interpolated$C13organic[i])){ #i is the first na postition
D = 0
while(is.na(interpolated$C13organic[i+D])){
D = D+1
}
interpolated$C13organic[i:(i+D-1)] <- approx(x = c(interpolated$Age[(i-1)], interpolated$Age[(i+D)]),
y = c(interpolated$C13organic[(i-1)], interpolated$C13organic[(i+D)]),
n = D)$y
i = i+D
}
else{
i = i+1
}
}
#now downscale at a 500ky resolution
selected_indices <- 100 * seq(from = 0, to = 66, by = 0.5) + 1
colnames(interpolated) <- c("Age", "d13C_organic")
final <- interpolated[selected_indices,]
par(mfrow = c(1,2))
plot(x = d13C_org$Age, y = d13C_org$C13organic)
title("Original data")
plot(x = final$Age, y = final$d13C_organic)
title("Scaled data")
## Relative Leaf Area Index (Dunn et al. 2015) -----------------------------------------------------------------------
rLAI <- read_xlsx("./data_2023/MBD/rLAI.xlsx")
interpol_rlai <- approx(x = rLAI$Age[1:2], y = rLAI$rLAI[1:2], n=3)$y
library(readxl)
## Relative Leaf Area Index (Dunn et al. 2015) -----------------------------------------------------------------------
rLAI <- read_xlsx("./data_2023/MBD/rLAI.xlsx")
interpol_rlai <- approx(x = rLAI$Age[1:2], y = rLAI$rLAI[1:2], n=3)$y
for(i in 2:38){
interpol_rlai <- c(interpol_rlai,
approx(x = rLAI$Age[i:(i+1)], y = rLAI$rLAI[i:(i+1)], n=3)$y[-c(1)])
}
rlai_int <- data.frame(Age = seq(11, 49, 0.5),
rLAI = interpol_rlai)
plot(rlai_int$Age, rLAI$rLAI)
plot(rlai_int$Age, rlai_int$rLAI)
dev.off()
plot(rlai_int$Age, rlai_int$rLAI)
plot(rlai_int$Age, rlai_int$rLAI, type = "l")
## Temporal patterns on the relative abundance of open habitats in Patagonia (Solórzano et Nuñez 2021) --------------
p_open <- read_xlsx("./data_2023/MBD/vegetation_openness.xlsx")
interpol_op <- approx(x = p_open$Age[1:2], y = p_open$P_open[1:2], n=3)$y
for(i in 2:49){
interpol_op <- c(interpol_op,
approx(x = p_open$Age[i:(i+1)], y = p_open$P_open[i:(i+1)], n=3)$y[-c(1)])
}
p_op_int <- data.frame(Age = seq(0, 49, 0.5),
P_open = interpol_op)
par(mfrow = c(1.2))
par(mfrow(1.2))
dev.off()
par(mfrow = c(1,2))
plot(rlai_int$Age, rlai_int$rLAI, type = "l", main = "RLAI")
plot(p_open$Age, p_open$P_open, type = "l", main = "RLAI")
dev.off()
par(mfrow = c(1,2))
plot(rlai_int$Age, rlai_int$rLAI, type = "l", main = "RLAI")
plot(p_open$Age, p_open$P_open, type = "l", main = "Habitat openness")
dev.off()
library(tidyverse)
source("./R/useful/helper_functions.R")
## Plant diversity (from Jaramillo et al. (2006)) --------------------------------------------------------------------
plant_raw <- read.table("./data_2023/MBD/raw_environment_correlates/Cnz_Plant_diversity_Jaramillo_2006.txt", header = TRUE)
selected_indices <- sapply(X = seq(from = 23, to = 56, by = 0.5),
FUN = select_closer,
age_vect = plant_raw$Age)
plant_processed <- data.frame(Age = seq(from = 23, to = 56, by = 0.5),
Plant_diversity = plant_raw$Div[selected_indices])
## Andean Uplift (from Boschman (2021)) -----------------------------------------------------------------------------
Uplift <- read.table("./data_2023/MBD/raw_environment_correlates/andean_uplift/Andes_mean_elevations_no_basins_ALL.txt",
sep = " ",
header = TRUE)
#Write and save a dataset of the covariate with a 100ky time step
average_elevation <- data.frame(Age = 23:56,
Altitude = sapply(X = 23:56, FUN = function(x){return(mean(Uplift$Altitude[which(Uplift$Age == x)]))}))
interpol_av_el <- approx(x = average_elevation$Age[1:2], y = average_elevation$Altitude[1:2], n=3)$y
for(i in 24:56){
interpol_av_el <- c(interpol_av_el,
approx(x = average_elevation$Age[i:(i+1)], y = average_elevation$Altitude[i:(i+1)], n=3)$y[-c(1)])
}
library(tidyverse)
source("./R/useful/helper_functions.R")
## Plant diversity (from Jaramillo et al. (2006)) --------------------------------------------------------------------
plant_raw <- read.table("./data_2023/MBD/raw_environment_correlates/Cnz_Plant_diversity_Jaramillo_2006.txt", header = TRUE)
selected_indices <- sapply(X = seq(from = 23, to = 56, by = 0.5),
FUN = select_closer,
age_vect = plant_raw$Age)
plant_processed <- data.frame(Age = seq(from = 23, to = 56, by = 0.5),
Plant_diversity = plant_raw$Div[selected_indices])
### Verification ###
# par(mfrow = c(1,2))
# plot(x = plant_processed$Age, plant_processed$Plant_diversity, xlim = c(15, 90))
# plot(x = plant_raw$Age, y = plant_raw$Div)
# Full dataset
write.table.lucas(x = plant_processed,
file = "./data_2023/MBD/processed_predictors_full/1-Plant_Diversity_Eoc_Olig_500ky_step.txt")
# post_EECO dataset
write.table.lucas(x = plant_processed %>% filter(Age <= 51 & Age >= 34),
file = "./data_2023/MBD/processed_predictors_post_EECO/1-Plant_Diversity_post_EECO_500ky_step.txt")
# Oligocene dataset
write.table.lucas(x = plant_processed %>% filter(Age <= 34 & Age >= 23),
file = "./data_2023/MBD/processed_predictors_Oligocene_only/1-Plant_Diversity_Oligocene_only_500ky_step.txt")
library(tidyverse)
source("./R/useful/helper_functions.R")
## Plant diversity (from Jaramillo et al. (2006)) --------------------------------------------------------------------
plant_raw <- read.table("./data_2023/MBD/raw_environment_correlates/Cnz_Plant_diversity_Jaramillo_2006.txt", header = TRUE)
selected_indices <- sapply(X = seq(from = 23, to = 56, by = 0.5),
FUN = select_closer,
age_vect = plant_raw$Age)
plant_processed <- data.frame(Age = seq(from = 23, to = 56, by = 0.5),
Plant_diversity = plant_raw$Div[selected_indices])
View(plant_processed)
# Full dataset
write.table.lucas(x = plant_processed,
file = "./data_2023/MBD/processed_predictors_full/1-Plant_Diversity_Eoc_Olig_500ky_step.txt")
# Full dataset
write.table.lucas(x = plant_processed,
file = "./data_2023/MBD/processed_predictors_full/1-Plant_Diversity_Eoc_Olig_500ky_step.txt")
## Andean Uplift (from Boschman (2021)) -----------------------------------------------------------------------------
Uplift <- read.table("./data_2023/MBD/raw_environment_correlates/andean_uplift/Andes_mean_elevations_no_basins_ALL.txt",
sep = " ",
header = TRUE)
#Write and save a dataset of the covariate with a 100ky time step
average_elevation <- data.frame(Age = 0:66,
Altitude = sapply(X = 0:66, FUN = function(x){return(mean(Uplift$Altitude[which(Uplift$Age == x)]))}))
interpol_av_el <- approx(x = average_elevation$Age[1:2], y = average_elevation$Altitude[1:2], n=3)$y
for(i in 2:66){
interpol_av_el <- c(interpol_av_el,
approx(x = average_elevation$Age[i:(i+1)], y = average_elevation$Altitude[i:(i+1)], n=3)$y[-c(1)])
}
### Verification ###
# par(mfrow = c(1,2))
# plot(x = average_elevation$Age, y = average_elevation$Altitude)
# title("Original data")
# plot(x = seq(from = 0, to = 66, by = 0.5), y = interpol_av_el)
# title("Interpolated data")
Andes <- data.frame(Age = seq(from = 0, to = 66, by = 0.5),
Altitude = interpol_av_el)
# Full dataset
write.table.lucas(Andes %>% filter(Age >= 23 & Age <= 56),
file = "./data_2023/MBD/processed_predictors_full/2-Andes_mean_elevations_Eoc_Olig_500ky_step.txt")
# post_EECO dataset
write.table.lucas(x = Andes %>% filter(Age <= 51 & Age >= 34),
file = "./data_2023/MBD/processed_predictors_post_EECO/2-Andes_mean_elevations_post_EECO_500ky_step.txt")
# Oligocene dataset
write.table.lucas(x = Andes %>% filter(Age <= 34 & Age >= 23),
file = "./data_2023/MBD/processed_predictors_Oligocene_only/2-Andes_mean_elevations_Oligocene_only_500ky_step.txt")
View(Andes)
## Palaeotemperature (assembled by Boschman and Condamine 2022 using Cenozoic data from Westerhold et al. 2020) ----------------
Temp_Cnz <- read.table("./data_2023/MBD/raw_environment_correlates/palaeotemperature/merged_veizer_westerhold_Ts.txt",
sep = "\t",
header = TRUE)
Temp_Cnz <- Temp_Cnz[which(Temp_Cnz$Age <= 66), ]
#Write and save a dataset of the covariate with a 500ky time step
selected_indices <- sapply(X = seq(from = 0, to = 66, by = 0.5), FUN = select_closer, age_vect = Temp_Cnz$Age)
Temp_Cnz1 <- Temp_Cnz[selected_indices, ]
Temp_Cnz1$Age <- sapply(X = Temp_Cnz1$Age, FUN = round, digits = 1)
View(Temp_Cnz1)
# Full dataset
write.table.lucas(Temp_Cnz1 %>% filter(Age >= 23 & Age <= 56),
file = "./data_2023/MBD/processed_predictors_full/3-Temperature_Eoc_Olig_500ky_step.txt")
# Full dataset
write.table.lucas(Temp_Cnz1 %>% filter(Age >= 23 & Age <= 58),
file = "./data_2023/MBD/processed_predictors_full/3-Temperature_Eoc_Olig_500ky_step.txt")
# Full dataset
write.table.lucas(Temp_Cnz1 %>% filter(Age >= 23 & Age <= 57.5),
file = "./data_2023/MBD/processed_predictors_full/3-Temperature_Eoc_Olig_500ky_step.txt")
# Full dataset
write.table.lucas(Temp_Cnz1 %>% filter(Age >= 23 & Age <= 56),
file = "./data_2023/MBD/processed_predictors_full/3-Temperature_Eoc_Olig_500ky_step.txt")
# post_EECO dataset
write.table.lucas(x = Temp_Cnz1 %>% filter(Age <= 51 & Age >= 34),
file = "./data_2023/MBD/processed_predictors_post_EECO/3-Temperature_post_EECO_500ky_step.txt")
# Oligocene dataset
write.table.lucas(x = Temp_Cnz1 %>% filter(Age <= 34 & Age >= 23),
file = "./data_2023/MBD/processed_predictors_Oligocene_only/3-Temperature_Oligocene_only_500ky_step.txt")
## Global sea level (from Miller et al. 2020) -----------------------------------------------------------------------------------
sea_lvl <- read.table("./data_2023/MBD/raw_environment_correlates/sea_level/Miller_2020_sea_level_data.txt",
sep = "\t",
header = TRUE)
sea_lvl <- sea_lvl %>%
mutate(age_calkaBP = sapply(X = sea_lvl$age_calkaBP, FUN = function(x){x/1000})) %>%
rename(age_MaBP = "age_calkaBP")
selected_indices <- sapply(X = seq(from = 0, to = 66, by = 0.5), FUN = select_closer, age_vect = sea_lvl$age_MaBP)
#there are some intervals with lacks
ages <- sapply(X = sea_lvl$age_MaBP[selected_indices], FUN = round, digits = 1)
sel_sea_lvl <- sea_lvl$sealevel[selected_indices]
udc <- ages[which(ages %in% seq(0,66,0.5) == FALSE)]
to_add <- seq(0,66,0.5)[which(seq(0,66,0.5) %in% ages == FALSE)]
# replace udc by to_add
ages[which(ages %in% udc)] <- to_add
# dataframe
slvl <- data.frame(Age = ages,
Sea_level = sel_sea_lvl)
# Full dataset
write.table.lucas(x = slvl %>% filter(Age >= 23 & Age <= 56),
file = "./data_2023/MBD/processed_predictors_full/4-sea_level_Eoc_Olig_500ky_step.txt")
# post_EECO dataset
write.table.lucas(x = slvl %>% filter(Age <= 51 & Age >= 34),
file = "./data_2023/MBD/processed_predictors_full/4-sea_level_post_EECO_500ky_step.txt")
# Oligocene dataset
write.table.lucas(x = slvl %>% filter(Age <= 34 & Age >= 23),
file = "./data_2023/MBD/processed_predictors_full/4-sea_level_Oligocene_only_500ky_step.txt")
# post_EECO dataset
write.table.lucas(x = slvl %>% filter(Age <= 51 & Age >= 34),
file = "./data_2023/MBD/processed_predictors_post_EECO/4-sea_level_post_EECO_500ky_step.txt")
# Oligocene dataset
write.table.lucas(x = slvl %>% filter(Age <= 34 & Age >= 23),
file = "./data_2023/MBD/processed_predictors_Oligocene_only/4-sea_level_Oligocene_only_500ky_step.txt")
## Temporal patterns on the relative abundance of open habitats in Patagonia (Solórzano et Nuñez 2021 from Strömberg et al. 2013) ------------
p_open <- read_xlsx("./data_2023/MBD/raw_environment_correlates/vegetation_openness.xlsx")
interpol_op <- approx(x = p_open$Age[1:2], y = p_open$P_open[1:2], n=3)$y
for(i in 2:49){
interpol_op <- c(interpol_op,
approx(x = p_open$Age[i:(i+1)], y = p_open$P_open[i:(i+1)], n=3)$y[-c(1)])
}
p_op_int <- data.frame(Age = seq(0, 49, 0.5),
P_open = interpol_op)
# Full dataset
write.table.lucas(x = p_op_int %>% filter(Age >= 23 & Age <= 56),
file = "./data_2023/MBD/processed_predictors_full/5-habitat_openness_Eoc_Olig_500ky.txt")
# post_EECO dataset
write.table.lucas(x = p_op_int %>% filter(Age <= 51 & Age >= 34),
file = "./data_2023/MBD/processed_predictors_post_EECO/5-habitat_openness_post_EECO_500ky.txt")
# Oligocene dataset
write.table.lucas(x = p_op_int %>% filter(Age <= 34 & Age >= 23),
file = "./data_2023/MBD/processed_predictors_Oligocene_only/5-habitat_openness_post_EECO_500ky.txt")
## Relative Leaf Area Index (Dunn et al. 2015) -----------------------------------------------------------------------
rLAI <- read_xlsx("./data_2023/MBD/raw_environment_correlates/rLAI.xlsx")
interpol_rlai <- approx(x = rLAI$Age[1:2], y = rLAI$rLAI[1:2], n=3)$y
for(i in 2:38){
interpol_rlai <- c(interpol_rlai,
approx(x = rLAI$Age[i:(i+1)], y = rLAI$rLAI[i:(i+1)], n=3)$y[-c(1)])
}
rlai_int <- data.frame(Age = seq(11, 49, 0.5),
rLAI = interpol_rlai)
# Full dataset
write.table.lucas(x = rlai_int %>% filter(Age >= 23 & Age <= 56),
file = "./data_2023/MBD/processed_predictors_full/6-rLAI_Eoc_Olig.txt")
# post_EECO dataset
write.table.lucas(x = rlai_int %>% filter(Age <= 51 & Age >= 34),
file = "./data_2023/MBD/processed_predictors_post_EECO/6-rLAI_post_EECO.txt")
# Oligocene dataset
write.table.lucas(x = rlai_int %>% filter(Age <= 34 & Age >= 23),
file = "./data_2023/MBD/processed_predictors_Oligocene_only/6-rLAI_Oligocene_only.txt")
salma = "SALMA_smoothed"
tste_dir <- paste0("./results_EXTENDED/", salma, "/genus_level/1-Full/MH_sampler/LTT/")
tste <- list.files(path = tste_dir, pattern = "_se_est.txt")[1]
tste_full <- read.table(paste(tste_dir, tste, sep = "/"),
header = TRUE)
View(tste_full)
tste_dir <- paste0("./results_EXTENDED/", salma, "/genus_level/1-Full/MH_sampler/LTT/")
tste <- list.files(path = tste_dir, pattern = "_se_est_ltt.txt")[1]
tste_full <- read.table(paste(tste_dir, tste, sep = "/"),
header = TRUE)
View(tste_full)
View(tste_full)
rm(list = ls())
library(tidyverse)
source("./R/useful/helper_functions.R")
salma="SALMA_smoothed"
div_dir <- paste0("./results_EXTENDED/", salma, "/genus_level/1-Full/MH_sampler/LTT/")
div_file <- list.files(path = div_dir, pattern = "_se_est_ltt.txt")[1]
div_full <- read.table(paste(div_dir, div_file, sep = "/"),
header = TRUE)
View(div_full)
keys(tax_dict)
div_dir <- paste0("./results_EXTENDED/", salma, "/genus_level/1-Full/MH_sampler/LTT/")
div_file <- list.files(path = div_dir, pattern = ".txt")[1]
div_file
div_file <- list.files(path = div_dir, pattern = ".txt")
div_file
tste_dir <- paste0("./results_EXTENDED/", salma, "/genus_level/1-Full/MH_sampler/LTT/")
tste_file <- list.files(path = tste_dir, pattern = "se_est.txt")
tste_full <- read.table(paste(tste_dir, tste_file, sep = "/"),
header = TRUE)
View(tste_full)
# Eoc_Olig
write.table.lucas(x = tste_full %>% filter(ts <= 56 & te >= 23),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/1-Full/Full_Eocene_Oligocene_", salma, "se_est.txt"))
################################################################################
# Name: 6bis-Split_TsTe_interval.R
# Author: Lucas Buffan
# Contact: lucas.l.buffan@gmail.com
# Aim: Split TsTe tables according to the three periods tested in the MBD model.
################################################################################
library(tidyverse)
source("./R/useful/helper_functions.R")
for(salma in c("SALMA_smoothed", "SALMA_kept")){
tste_dir <- paste0("./results_EXTENDED/", salma, "/genus_level/1-Full/MH_sampler/LTT/")
tste_file <- list.files(path = tste_dir, pattern = "se_est.txt")
tste_full <- read.table(paste(tste_dir, tste_file, sep = "/"),
header = TRUE)
# Eoc_Olig
write.table.lucas(x = tste_full %>% filter(ts <= 56 & te >= 23), #sorting just based on one column, but enough
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/1-Full/Full_Eocene_Oligocene_", salma, "_se_est.txt"))
# post_EECO
write.table.lucas(x = tste_full %>% filter(ts <= 56 & te >= 34),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/1-Full/post_EECO/Full_post_EECO_", salma, "_se_est.txt"))
# Oligocene Only
write.table.lucas(x = tste_full %>% filter(ts <= 34 & te >= 23),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/1-Full/Oligocene_only/Full_Oligocene_only_", salma, "_se_est.txt"))
for(odr in keys(tax_dict)){
tste_dir <- paste0("./results_EXTENDED/", salma, "/genus_level/6-Order_level/", odr, "/LTT/")
tste_file <- list.files(path = tste_dir, pattern = "_se_est.txt")[1]
tste_odr <- read.table(paste(tste_dir, tste_file, sep = "/"),
header = TRUE)
# Eoc_Olig
write.table.lucas(x = tste_odr %>% filter(ts <= 56 & te >= 23),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/6-Order_level/", odr, "_Eocene_Oligocene_", salma, "_se_est.txt"))
# post_EECO
write.table.lucas(x = tste_odr %>% filter(ts <= 56 & te >= 34),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/6-Order_level/post_EECO/", odr, "_post_EECO_", salma, "_se_est.txt"))
# Oligocene Only
write.table.lucas(x = tste_odr %>% filter(ts <= 34 & te >= 23),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/6-Order_level/Oligocene_only/", odr, "_Oligocene_only_", salma, "_se_est.txt"))
}
}
keys(tax_dict)
tste_dir <- paste0("./results_EXTENDED/", salma, "/genus_level/6-Order_level/", odr, "/LTT")
list.files(path = tste_dir)
for(salma in c("SALMA_smoothed", "SALMA_kept")){
tste_dir <- paste0("./results_EXTENDED/", salma, "/genus_level/1-Full/MH_sampler/LTT/")
tste_file <- list.files(path = tste_dir, pattern = "se_est.txt")
tste_full <- read.table(paste(tste_dir, tste_file, sep = "/"),
header = TRUE)
# Eoc_Olig
write.table.lucas(x = tste_full %>% filter(ts <= 56 & te >= 23), #sorting just based on one column, but enough
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/1-Full/Full_Eocene_Oligocene_", salma, "_se_est.txt"))
# post_EECO
write.table.lucas(x = tste_full %>% filter(ts <= 56 & te >= 34),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/1-Full/post_EECO/Full_post_EECO_", salma, "_se_est.txt"))
# Oligocene Only
write.table.lucas(x = tste_full %>% filter(ts <= 34 & te >= 23),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/1-Full/Oligocene_only/Full_Oligocene_only_", salma, "_se_est.txt"))
for(odr in keys(tax_dict)){
tste_dir <- paste0("./results_EXTENDED/", salma, "/genus_level/6-Order_level/", odr, "/LTT")
tste_file <- list.files(path = tste_dir, pattern = "_level.txt")[1]
tste_odr <- read.table(paste(tste_dir, tste_file, sep = "/"),
header = TRUE)
# Eoc_Olig
write.table.lucas(x = tste_odr %>% filter(ts <= 56 & te >= 23),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/6-Order_level/", odr, "_Eocene_Oligocene_", salma, "_se_est.txt"))
# post_EECO
write.table.lucas(x = tste_odr %>% filter(ts <= 56 & te >= 34),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/6-Order_level/post_EECO/", odr, "_post_EECO_", salma, "_se_est.txt"))
# Oligocene Only
write.table.lucas(x = tste_odr %>% filter(ts <= 34 & te >= 23),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/6-Order_level/Oligocene_only/", odr, "_Oligocene_only_", salma, "_se_est.txt"))
}
}
for(salma in c("SALMA_smoothed", "SALMA_kept")){
tste_dir <- paste0("./results_EXTENDED/", salma, "/genus_level/1-Full/MH_sampler/LTT/")
tste_file <- list.files(path = tste_dir, pattern = "se_est.txt")
tste_full <- read.table(paste(tste_dir, tste_file, sep = "/"),
header = TRUE)
# Eoc_Olig
write.table.lucas(x = tste_full %>% filter(ts <= 56 & te >= 23), #sorting just based on one column, but enough
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/1-Full/Full_Eocene_Oligocene_", salma, "_se_est.txt"))
# post_EECO
write.table.lucas(x = tste_full %>% filter(ts <= 56 & te >= 34),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/1-Full/post_EECO/Full_post_EECO_", salma, "_se_est.txt"))
# Oligocene Only
write.table.lucas(x = tste_full %>% filter(ts <= 34 & te >= 23),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/1-Full/Oligocene_only/Full_Oligocene_only_", salma, "_se_est.txt"))
for(odr in keys(tax_dict)){
tste_dir <- paste0("./results_EXTENDED/", salma, "/genus_level/6-Order_level/", odr, "/LTT")
tste_file <- list.files(path = tste_dir, pattern = "_level.txt")[1]
tste_odr <- read.table(paste(tste_dir, tste_file, sep = "/"),
header = TRUE)
# Eoc_Olig
write.table.lucas(x = tste_odr %>% filter(ts <= 56 & te >= 23),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/", odr, "/6-Order_level/", odr, "_Eocene_Oligocene_", salma, "_se_est.txt"))
# post_EECO
write.table.lucas(x = tste_odr %>% filter(ts <= 56 & te >= 34),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/6-Order_level/", odr, "/post_EECO/", odr, "_post_EECO_", salma, "_se_est.txt"))
# Oligocene Only
write.table.lucas(x = tste_odr %>% filter(ts <= 34 & te >= 23),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/6-Order_level/", odr, "/Oligocene_only/", odr, "_Oligocene_only_", salma, "_se_est.txt"))
}
}
for(salma in c("SALMA_smoothed", "SALMA_kept")){
tste_dir <- paste0("./results_EXTENDED/", salma, "/genus_level/1-Full/MH_sampler/LTT/")
tste_file <- list.files(path = tste_dir, pattern = "se_est.txt")
tste_full <- read.table(paste(tste_dir, tste_file, sep = "/"),
header = TRUE)
# Eoc_Olig
write.table.lucas(x = tste_full %>% filter(ts <= 56 & te >= 23), #sorting just based on one column, but enough
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/1-Full/Full_Eocene_Oligocene_", salma, "_se_est.txt"))
# post_EECO
write.table.lucas(x = tste_full %>% filter(ts <= 56 & te >= 34),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/1-Full/post_EECO/Full_post_EECO_", salma, "_se_est.txt"))
# Oligocene Only
write.table.lucas(x = tste_full %>% filter(ts <= 34 & te >= 23),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/1-Full/Oligocene_only/Full_Oligocene_only_", salma, "_se_est.txt"))
for(odr in keys(tax_dict)){
tste_dir <- paste0("./results_EXTENDED/", salma, "/genus_level/6-Order_level/", odr, "/LTT")
tste_file <- list.files(path = tste_dir, pattern = "_level.txt")[1]
tste_odr <- read.table(paste(tste_dir, tste_file, sep = "/"),
header = TRUE)
# Eoc_Olig
write.table.lucas(x = tste_odr %>% filter(ts <= 56 & te >= 23),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/6-Order_level/", odr, "/", odr, "_Eocene_Oligocene_", salma, "_se_est.txt"))
# post_EECO
write.table.lucas(x = tste_odr %>% filter(ts <= 56 & te >= 34),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/6-Order_level/", odr, "/post_EECO/", odr, "_post_EECO_", salma, "_se_est.txt"))
# Oligocene Only
write.table.lucas(x = tste_odr %>% filter(ts <= 34 & te >= 23),
file = paste0("./results_EXTENDED/MBD/", salma, "/genus_level/6-Order_level/", odr, "/Oligocene_only/", odr, "_Oligocene_only_", salma, "_se_est.txt"))
}
}
## Temporal patterns on the relative abundance of open habitats in Patagonia (Solórzano et Nuñez 2021 from Strömberg et al. 2013) ------------
p_open <- read_xlsx("./data_2023/MBD/raw_environment_correlates/vegetation_openness.xlsx")
interpol_op <- approx(x = p_open$Age[1:2], y = p_open$P_open[1:2], n=3)$y
for(i in 2:49){
interpol_op <- c(interpol_op,
approx(x = p_open$Age[i:(i+1)], y = p_open$P_open[i:(i+1)], n=3)$y[-c(1)])
}
p_op_int <- data.frame(Age = seq(0, 49, 0.5),
P_open = interpol_op)
# Oligocene dataset
write.table.lucas(x = p_op_int %>% filter(Age <= 34 & Age >= 23),
file = "./data_2023/MBD/processed_predictors_Oligocene_only/5-habitat_openness_Oligocene_only_500ky.txt")

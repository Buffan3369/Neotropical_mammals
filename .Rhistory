#                   file = "./data_2023/MBD/processed_predictors_full/5-habitat_openness_Eoc_Olig_500ky.txt")
# # post_EECO dataset
# write.table.lucas(x = p_op_int %>% filter(Age <= 51 & Age >= 34),
#                   file = "./data_2023/MBD/processed_predictors_post_EECO/5-habitat_openness_post_EECO_500ky.txt")
# # Oligocene dataset
# write.table.lucas(x = p_op_int %>% filter(Age <= 34 & Age >= 23),
#                   file = "./data_2023/MBD/processed_predictors_Oligocene_only/5-habitat_openness_Oligocene_only_500ky.txt")
## Relative Leaf Area Index (Dunn et al. 2015) -----------------------------------------------------------------------
rLAI <- read_xlsx("./data_2023/MBD/raw_environment_correlates/rLAI.xlsx")
interpol_rlai <- approx(x = rLAI$Age[1:2], y = rLAI$rLAI[1:2], n=3)$y
for(i in 2:38){
interpol_rlai <- c(interpol_rlai,
approx(x = rLAI$Age[i:(i+1)], y = rLAI$rLAI[i:(i+1)], n=3)$y[-c(1)])
}
rlai_int <- data.frame(Age = seq(11, 49, 0.5),
rLAI = interpol_rlai)
# Full dataset
# write.table.lucas(x = rlai_int %>% filter(Age >= 23 & Age <= 56),
#                   file = "./data_2023/MBD/processed_predictors_full/6-rLAI_Eoc_Olig.txt")
# # post_EECO dataset
# write.table.lucas(x = rlai_int %>% filter(Age <= 51 & Age >= 34),
#                   file = "./data_2023/MBD/processed_predictors_post_EECO/6-rLAI_post_EECO.txt")
# # Oligocene dataset
# write.table.lucas(x = rlai_int %>% filter(Age <= 34 & Age >= 23),
#                   file = "./data_2023/MBD/processed_predictors_Oligocene_only/6-rLAI_Oligocene_only.txt")
#### Environment variable plot for SI Appendix ---------------------------------
library(deeptime)
library(ggpubr)
theme_lucas <- function(...){
theme(panel.background = element_blank(),
panel.border = element_rect(linewidth = .75, colour = "black", fill = NA),
axis.text = element_text(size = 8),
axis.title = element_text(size = 9),
plot.title = element_text(size = 12, hjust = 0.5),
...)
}
# Temperature
temp <- Temp_Cnz1 %>%
filter(Age > 24 & Age < 56) %>%
ggplot(aes(x = Age, y = Temperature)) +
geom_line(linewidth = 1.5, colour = "#d95f0e") +
labs(x = "Time (Ma)", y = "Temperature (°C)") +
ggtitle("Paleotemperature") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(15, 30, 3),
limits = c(12, 33)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = 3, height = units(0.5, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
library(deeptime)
library(ggpubr)
theme_lucas <- function(...){
theme(panel.background = element_blank(),
panel.border = element_rect(linewidth = .75, colour = "black", fill = NA),
axis.text = element_text(size = 8),
axis.title = element_text(size = 9),
plot.title = element_text(size = 12, hjust = 0.5),
...)
}
# Temperature
temp <- Temp_Cnz1 %>%
filter(Age > 24 & Age < 56) %>%
ggplot(aes(x = Age, y = Temperature)) +
geom_line(linewidth = 1.5, colour = "#d95f0e") +
labs(x = "Time (Ma)", y = "Temperature (°C)") +
ggtitle("Paleotemperature") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(15, 30, 3),
limits = c(12, 33)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = "auto", height = unit(0.5, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Andean uplift
upl <- Andes %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = Altitude)) +
geom_line(linewidth = 1.5, colour = "purple3") +
labs(x = "Time (Ma)", y = "Elevation (m)") +
ggtitle("Average andean uplift") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(500, 1000, 100),
limits = c(450, 1050)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = "auto", height = unit(0.5, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Sea level
slv <- slvl %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = Sea_level)) +
geom_line(linewidth = 1.5, colour = "skyblue3") +
labs(x = "Time (Ma)", y = "Sea level (m)") +
ggtitle("Eustatic variations") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(-25, 75, 25),
limits = c(-50, 80)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = "auto", height = unit(0.5, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Plants
plants <- plant_processed %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = Plant_diversity)) +
geom_line(linewidth = 1.5, colour = "#238b45") +
labs(x = "Time (Ma)", y = "Number of taxa") +
ggtitle("Neotropical Plant Diversity") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(200, 350, 30)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = "auto", height = unit(0.5, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Temporal patterns of open habitats
h_op <- p_op_int %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = P_open)) +
geom_line(linewidth = 1.5, colour = "grey40") +
labs(x = "Time (Ma)", y = "Nb. grassland taxa") +
ggtitle("Patterns of hab. openness") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = "auto", height = unit(0.5, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Relative leaf area index
rlai_p <- rlai_int %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = rLAI)) +
geom_line(linewidth = 1.5, colour = "darkred") +
labs(x = "Time (Ma)", y = "rLAI") +
ggtitle("Relative leaf area index") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(0, 3, 0.5),
limits = c(0, 3)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = "auto", height = unit(0.5, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Assemble and plot
tot_plot <- ggarrange(temp, upl, slv,
plants, h_op, rlai_p,
nrow = 2,
ncol = 3,
labels = c("(A)", "(B)", "(C)", "(D)", "(E)", "(F)"))
ggsave("./figures/supp_figs/evt_vbl_plot.pdf",
plot = tot_plot,
height = 150,
width = 210,
units = "mm")
# Temperature
temp <- Temp_Cnz1 %>%
filter(Age > 24 & Age < 56) %>%
ggplot(aes(x = Age, y = Temperature)) +
geom_line(linewidth = 1.5, colour = "#d95f0e") +
labs(x = "Time (Ma)", y = "Temperature (°C)") +
ggtitle("Paleotemperature") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(15, 30, 3),
limits = c(12, 33)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = "auto", height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Andean uplift
upl <- Andes %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = Altitude)) +
geom_line(linewidth = 1.5, colour = "purple3") +
labs(x = "Time (Ma)", y = "Elevation (m)") +
ggtitle("Average andean uplift") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(500, 1000, 100),
limits = c(450, 1050)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = "auto", height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Sea level
slv <- slvl %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = Sea_level)) +
geom_line(linewidth = 1.5, colour = "skyblue3") +
labs(x = "Time (Ma)", y = "Sea level (m)") +
ggtitle("Eustatic variations") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(-25, 75, 25),
limits = c(-50, 80)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = "auto", height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Plants
plants <- plant_processed %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = Plant_diversity)) +
geom_line(linewidth = 1.5, colour = "#238b45") +
labs(x = "Time (Ma)", y = "Number of taxa") +
ggtitle("Neotropical Plant Diversity") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(200, 350, 30)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = "auto", height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Temporal patterns of open habitats
h_op <- p_op_int %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = P_open)) +
geom_line(linewidth = 1.5, colour = "grey40") +
labs(x = "Time (Ma)", y = "Nb. grassland taxa") +
ggtitle("Patterns of hab. openness") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = "auto", height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Relative leaf area index
rlai_p <- rlai_int %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = rLAI)) +
geom_line(linewidth = 1.5, colour = "darkred") +
labs(x = "Time (Ma)", y = "rLAI") +
ggtitle("Relative leaf area index") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(0, 3, 0.5),
limits = c(0, 3)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = "auto", height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Assemble and plot
tot_plot <- ggarrange(temp, upl, slv,
plants, h_op, rlai_p,
nrow = 2,
ncol = 3,
labels = c("(A)", "(B)", "(C)", "(D)", "(E)", "(F)"))
ggsave("./figures/supp_figs/evt_vbl_plot.pdf",
plot = tot_plot,
height = 150,
width = 210,
units = "mm")
theme_lucas <- function(...){
theme(panel.background = element_blank(),
panel.border = element_rect(linewidth = .75, colour = "black", fill = NA),
axis.text = element_text(size = 8),
axis.title = element_text(size = 9),
plot.title = element_text(size = 12, hjust = 0.5),
...)
}
# Temperature
temp <- Temp_Cnz1 %>%
filter(Age > 24 & Age < 56) %>%
ggplot(aes(x = Age, y = Temperature)) +
geom_line(linewidth = 1.5, colour = "#d95f0e") +
labs(x = "Time (Ma)", y = "Temperature (°C)") +
ggtitle("Paleotemperature") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(15, 30, 3),
limits = c(12, 33)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = 1, height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Andean uplift
upl <- Andes %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = Altitude)) +
geom_line(linewidth = 1.5, colour = "purple3") +
labs(x = "Time (Ma)", y = "Elevation (m)") +
ggtitle("Average andean uplift") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(500, 1000, 100),
limits = c(450, 1050)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = 1, height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Sea level
slv <- slvl %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = Sea_level)) +
geom_line(linewidth = 1.5, colour = "skyblue3") +
labs(x = "Time (Ma)", y = "Sea level (m)") +
ggtitle("Eustatic variations") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(-25, 75, 25),
limits = c(-50, 80)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = 1, height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Plants
plants <- plant_processed %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = Plant_diversity)) +
geom_line(linewidth = 1.5, colour = "#238b45") +
labs(x = "Time (Ma)", y = "Number of taxa") +
ggtitle("Neotropical Plant Diversity") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(200, 350, 30)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = 1, height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Temporal patterns of open habitats
h_op <- p_op_int %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = P_open)) +
geom_line(linewidth = 1.5, colour = "grey40") +
labs(x = "Time (Ma)", y = "Nb. grassland taxa") +
ggtitle("Patterns of hab. openness") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = 1, height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Relative leaf area index
rlai_p <- rlai_int %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = rLAI)) +
geom_line(linewidth = 1.5, colour = "darkred") +
labs(x = "Time (Ma)", y = "rLAI") +
ggtitle("Relative leaf area index") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(0, 3, 0.5),
limits = c(0, 3)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = 1, height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Assemble and plot
tot_plot <- ggarrange(temp, upl, slv,
plants, h_op, rlai_p,
nrow = 2,
ncol = 3,
labels = c("(A)", "(B)", "(C)", "(D)", "(E)", "(F)"))
ggsave("./figures/supp_figs/evt_vbl_plot.pdf",
plot = tot_plot,
height = 150,
width = 210,
units = "mm")
temp <- Temp_Cnz1 %>%
filter(Age > 24 & Age < 56) %>%
ggplot(aes(x = Age, y = Temperature)) +
geom_line(linewidth = 1.5, colour = "#d95f0e") +
labs(x = "Time (Ma)", y = "Temperature (°C)") +
ggtitle("Paleotemperature") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(15, 30, 3),
limits = c(12, 33)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = 2.5, height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Andean uplift
upl <- Andes %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = Altitude)) +
geom_line(linewidth = 1.5, colour = "purple3") +
labs(x = "Time (Ma)", y = "Elevation (m)") +
ggtitle("Average andean uplift") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(500, 1000, 100),
limits = c(450, 1050)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = 2.5, height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Sea level
slv <- slvl %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = Sea_level)) +
geom_line(linewidth = 1.5, colour = "skyblue3") +
labs(x = "Time (Ma)", y = "Sea level (m)") +
ggtitle("Eustatic variations") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(-25, 75, 25),
limits = c(-50, 80)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = 2.5, height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Plants
plants <- plant_processed %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = Plant_diversity)) +
geom_line(linewidth = 1.5, colour = "#238b45") +
labs(x = "Time (Ma)", y = "Number of taxa") +
ggtitle("Neotropical Plant Diversity") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(200, 350, 30)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = 2.5, height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Temporal patterns of open habitats
h_op <- p_op_int %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = P_open)) +
geom_line(linewidth = 1.5, colour = "grey40") +
labs(x = "Time (Ma)", y = "Nb. grassland taxa") +
ggtitle("Patterns of hab. openness") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = 2.5, height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Relative leaf area index
rlai_p <- rlai_int %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = rLAI)) +
geom_line(linewidth = 1.5, colour = "darkred") +
labs(x = "Time (Ma)", y = "rLAI") +
ggtitle("Relative leaf area index") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(0, 3, 0.5),
limits = c(0, 3)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = 2.5, height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Assemble and plot
tot_plot <- ggarrange(temp, upl, slv,
plants, h_op, rlai_p,
nrow = 2,
ncol = 3,
labels = c("(A)", "(B)", "(C)", "(D)", "(E)", "(F)"))
ggsave("./figures/supp_figs/evt_vbl_plot.pdf",
plot = tot_plot,
height = 150,
width = 210,
units = "mm")
# Plants
plants <- plant_processed %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = Plant_diversity)) +
geom_line(linewidth = 1.5, colour = "#238b45") +
labs(x = "Time (Ma)", y = "Number of taxa") +
ggtitle("Neotropical Plant Diversity") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(200, 350, 30),
limits = c(200, 350)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = 2.5, height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Assemble and plot
tot_plot <- ggarrange(temp, upl, slv,
plants, h_op, rlai_p,
nrow = 2,
ncol = 3,
labels = c("(A)", "(B)", "(C)", "(D)", "(E)", "(F)"))
ggsave("./figures/supp_figs/evt_vbl_plot.pdf",
plot = tot_plot,
height = 150,
width = 210,
units = "mm")
# Plants
plants <- plant_processed %>%
filter(Age < 56 & Age > 24) %>%
ggplot(aes(x = Age, y = Plant_diversity)) +
geom_line(linewidth = 1.5, colour = "#238b45") +
labs(x = "Time (Ma)", y = "Number of taxa") +
ggtitle("Neotropical Plant Diversity") +
scale_x_reverse(breaks = seq(25, 55, 5)) +
scale_y_continuous(breaks = seq(200, 350, 30),
limits = c(215, 360)) +
theme_lucas() +
coord_geo(dat = "epochs", abbrv = FALSE, size = 2.5, height = unit(1, "line")) +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0)
# Assemble and plot
tot_plot <- ggarrange(temp, upl, slv,
plants, h_op, rlai_p,
nrow = 2,
ncol = 3,
labels = c("(A)", "(B)", "(C)", "(D)", "(E)", "(F)"))
ggsave("./figures/supp_figs/evt_vbl_plot.pdf",
plot = tot_plot,
height = 150,
width = 210,
units = "mm")

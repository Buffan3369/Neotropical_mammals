#   write.table.lucas(x = sp_trop,
#                     file = paste0("./data_2023/PyRate/", salma, "/species_level/3-Tropical_Extratropical/Tropical_EOT_sp_occ_", salma, ".txt"))
#   write.table.lucas(x = sp_Etrop,
#                     file = paste0("./data_2023/PyRate/", salma, "/species_level/3-Tropical_Extratropical/Extratropical_EOT_sp_occ_", salma, ".txt"))
#   #extract ages
#   extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/3-Tropical_Extratropical/Tropical_EOT_sp_occ_", salma, ".txt"),
#                replicates = 20)
#   extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/3-Tropical_Extratropical/Extratropical_EOT_sp_occ_", salma, ".txt"),
#                replicates = 20)
#   ### Diet types (10 replicates)
#   for(dt in c("carnivore", "herbivore", "omnivore", "insectivore")){ #frugivore omitted, not enough data
#     tmp <- occdf %>%
#       filter(diet == dt) %>%
#       select(accepted_name, status, min_ma, max_ma) %>%
#       rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
#     write.table.lucas(x = tmp,
#                       file = paste0("./data_2023/PyRate/", salma, "/species_level/4-Ecomorphotype/", dt, "_EOT_sp_occ_", salma, ".txt"))
#     extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/4-Ecomorphotype/", dt, "_EOT_sp_occ_", salma, ".txt"),
#                  replicates = 10)
#   }
### Order (10 replicates)
for(odr in keys(tax_dict)){
# Get the occ of the corresponding "order"
tmp_odr <- occdf %>%
filter(order %in% values(tax_dict[odr])) %>%
select(accepted_name, status, min_ma, max_ma) %>%
rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
# Save
write.table.lucas(x = tmp_odr,
file = paste0(paste0("./data_2023/PyRate/", salma, "/species_level/5-Order_level/", odr, "_EOT_sp_occ_", salma, ".txt")))
# Extract ages
extract.ages(paste0(paste0("./data_2023/PyRate/", salma, "/species_level/5-Order_level/", odr, "_EOT_sp_occ_", salma, ".txt")),
replicates = 10)
}
}
View(occdf)
occdf$order
unique(occdf$order)
# Get the occ of the corresponding "order"
tmp_odr <- occdf %>%
filter(order %in% values(tax_dict[odr]))
which(occdf$order %in% values(tax_dict[odr]))
values(tax_dict[odr])
values(tax_dict[odr])[1]
rm(list = ls())
library(dplyr)
## Accessory functions ---------------------------------------------------------
source("../../pyrate_utilities.R")
source("./R/useful/helper_functions.R")
i <- 4
for(salma in c("SALMA_kept", "SALMA_smoothed")){
i <- i+1
occdf <- readRDS(paste0("./data_2023/SPECIES_LISTS/", i, "-Fully_cleaned_EOT_SA_Mammals_", salma, "_Tropics_Diet.RDS"))
# ## Genus-level -----------------------------------------------------------------
#   ### Full & Singleton
#   #prepare data
#   gen_lvl <- occdf %>%
#     select(genus, gen_lvl_status, min_ma, max_ma) %>%
#     rename(Species = "genus", Status = "gen_lvl_status", min_age = "min_ma", max_age = "max_ma")
#   #save
#   write.table.lucas(x = gen_lvl,
#                     file = paste0("./data_2023/PyRate/", salma, "/genus_level/1-Full/Full_EOT_gen_occ_", salma, ".txt"))
#   #extract ages
#   extract.ages(paste0("./data_2023/PyRate/", salma, "/genus_level/1-Full/Full_EOT_gen_occ_", salma, ".txt"),
#                replicates = 20)
#   ### Spatially scaled
#   #subset unique genera at a given age and place (characterised by p_lng, p_lat (nb. could have been present-day lon/lat))
#   gen_lvl_scaled <- occdf %>%
#     group_by(genus, gen_lvl_status, min_ma, max_ma, p_lng, p_lat, age) %>%
#     distinct(genus) %>%
#     ungroup() %>%
#     select(genus, gen_lvl_status, min_ma, max_ma) %>%
#     rename(Species = "genus", Status = "gen_lvl_status", min_age = "min_ma", max_age = "max_ma")
#   #save
#   write.table.lucas(x = gen_lvl_scaled,
#                     file = paste0("./data_2023/PyRate/", salma, "/genus_level/2-Spatially_scaled/spatially_scaled_EOT_gen_occ_", salma, ".txt"))
#   #extract ages
#   extract.ages(paste0("./data_2023/PyRate/", salma, "/genus_level/2-Spatially_scaled/spatially_scaled_EOT_gen_occ_", salma, ".txt"),
#                replicates = 20)
#   ### Tropical/Extra-tropical
#   #subset tropical/extra-tropical taxa
#   trop <- occdf %>%
#     filter(loc == "T") %>%
#     select(genus, gen_lvl_status, min_ma, max_ma) %>%
#     rename(Species = "genus", Status = "gen_lvl_status", min_age = "min_ma", max_age = "max_ma")
#   Etrop <- occdf %>%
#     filter(loc == "E") %>%
#     select(genus, gen_lvl_status, min_ma, max_ma) %>%
#     rename(Species = "genus", Status = "gen_lvl_status", min_age = "min_ma", max_age = "max_ma")
#   #save
#   write.table.lucas(x = trop,
#                     file = paste0("./data_2023/PyRate/", salma, "/genus_level/3-Tropical_Extratropical/Tropical_EOT_gen_occ_", salma, ".txt"))
#   write.table.lucas(x = Etrop,
#                     file = paste0("./data_2023/PyRate/", salma, "/genus_level/3-Tropical_Extratropical/Extratropical_EOT_gen_occ_", salma, ".txt"))
#   #extract ages
#   extract.ages(paste0("./data_2023/PyRate/", salma, "/genus_level/3-Tropical_Extratropical/Tropical_EOT_gen_occ_", salma, ".txt"),
#                replicates = 20)
#   extract.ages(paste0("./data_2023/PyRate/", salma, "/genus_level/3-Tropical_Extratropical/Extratropical_EOT_gen_occ_", salma, ".txt"),
#                replicates = 20)
#   ### Diet types (10 replicates)
#   for(dt in c("carnivore", "herbivore", "omnivore", "insectivore")){ #frugivore omitted, not enough data
#     tmp <- occdf %>%
#       filter(diet == dt) %>%
#       select(genus, gen_lvl_status, min_ma, max_ma) %>%
#       rename(Species = "genus", Status = "gen_lvl_status", min_age = "min_ma", max_age = "max_ma")
#     write.table.lucas(x = tmp,
#                       file = paste0(paste0("./data_2023/PyRate/", salma, "/genus_level/4-Ecomorphotype/", dt, "_EOT_gen_occ_", salma, ".txt")))
#     extract.ages(paste0(paste0("./data_2023/PyRate/", salma, "/genus_level/4-Ecomorphotype/", dt, "_EOT_gen_occ_", salma, ".txt")),
#                  replicates = 10)
#   }
### Order (10 replicates)
for(odr in keys(tax_dict)){
# Get the occ of the corresponding "order"
tmp_odr <- occdf %>%
filter(order %in% values(tax_dict[odr]))
%>%
library(dplyr)
## Accessory functions ---------------------------------------------------------
source("../../pyrate_utilities.R")
source("./R/useful/helper_functions.R")
i <- 4
for(salma in c("SALMA_kept", "SALMA_smoothed")){
i <- i+1
occdf <- readRDS(paste0("./data_2023/SPECIES_LISTS/", i, "-Fully_cleaned_EOT_SA_Mammals_", salma, "_Tropics_Diet.RDS"))
# ## Genus-level -----------------------------------------------------------------
#   ### Full & Singleton
#   #prepare data
#   gen_lvl <- occdf %>%
#     select(genus, gen_lvl_status, min_ma, max_ma) %>%
#     rename(Species = "genus", Status = "gen_lvl_status", min_age = "min_ma", max_age = "max_ma")
#   #save
#   write.table.lucas(x = gen_lvl,
#                     file = paste0("./data_2023/PyRate/", salma, "/genus_level/1-Full/Full_EOT_gen_occ_", salma, ".txt"))
#   #extract ages
#   extract.ages(paste0("./data_2023/PyRate/", salma, "/genus_level/1-Full/Full_EOT_gen_occ_", salma, ".txt"),
#                replicates = 20)
#   ### Spatially scaled
#   #subset unique genera at a given age and place (characterised by p_lng, p_lat (nb. could have been present-day lon/lat))
#   gen_lvl_scaled <- occdf %>%
#     group_by(genus, gen_lvl_status, min_ma, max_ma, p_lng, p_lat, age) %>%
#     distinct(genus) %>%
#     ungroup() %>%
#     select(genus, gen_lvl_status, min_ma, max_ma) %>%
#     rename(Species = "genus", Status = "gen_lvl_status", min_age = "min_ma", max_age = "max_ma")
#   #save
#   write.table.lucas(x = gen_lvl_scaled,
#                     file = paste0("./data_2023/PyRate/", salma, "/genus_level/2-Spatially_scaled/spatially_scaled_EOT_gen_occ_", salma, ".txt"))
#   #extract ages
#   extract.ages(paste0("./data_2023/PyRate/", salma, "/genus_level/2-Spatially_scaled/spatially_scaled_EOT_gen_occ_", salma, ".txt"),
#                replicates = 20)
#   ### Tropical/Extra-tropical
#   #subset tropical/extra-tropical taxa
#   trop <- occdf %>%
#     filter(loc == "T") %>%
#     select(genus, gen_lvl_status, min_ma, max_ma) %>%
#     rename(Species = "genus", Status = "gen_lvl_status", min_age = "min_ma", max_age = "max_ma")
#   Etrop <- occdf %>%
#     filter(loc == "E") %>%
#     select(genus, gen_lvl_status, min_ma, max_ma) %>%
#     rename(Species = "genus", Status = "gen_lvl_status", min_age = "min_ma", max_age = "max_ma")
#   #save
#   write.table.lucas(x = trop,
#                     file = paste0("./data_2023/PyRate/", salma, "/genus_level/3-Tropical_Extratropical/Tropical_EOT_gen_occ_", salma, ".txt"))
#   write.table.lucas(x = Etrop,
#                     file = paste0("./data_2023/PyRate/", salma, "/genus_level/3-Tropical_Extratropical/Extratropical_EOT_gen_occ_", salma, ".txt"))
#   #extract ages
#   extract.ages(paste0("./data_2023/PyRate/", salma, "/genus_level/3-Tropical_Extratropical/Tropical_EOT_gen_occ_", salma, ".txt"),
#                replicates = 20)
#   extract.ages(paste0("./data_2023/PyRate/", salma, "/genus_level/3-Tropical_Extratropical/Extratropical_EOT_gen_occ_", salma, ".txt"),
#                replicates = 20)
#   ### Diet types (10 replicates)
#   for(dt in c("carnivore", "herbivore", "omnivore", "insectivore")){ #frugivore omitted, not enough data
#     tmp <- occdf %>%
#       filter(diet == dt) %>%
#       select(genus, gen_lvl_status, min_ma, max_ma) %>%
#       rename(Species = "genus", Status = "gen_lvl_status", min_age = "min_ma", max_age = "max_ma")
#     write.table.lucas(x = tmp,
#                       file = paste0(paste0("./data_2023/PyRate/", salma, "/genus_level/4-Ecomorphotype/", dt, "_EOT_gen_occ_", salma, ".txt")))
#     extract.ages(paste0(paste0("./data_2023/PyRate/", salma, "/genus_level/4-Ecomorphotype/", dt, "_EOT_gen_occ_", salma, ".txt")),
#                  replicates = 10)
#   }
### Order (10 replicates)
for(odr in keys(tax_dict)){
# Get the occ of the corresponding "order"
tmp_odr <- occdf %>%
filter(order %in% values(tax_dict[odr])) %>%
select(genus, gen_lvl_status, min_ma, max_ma) %>%
rename(Species = "genus", Status = "gen_lvl_status", min_age = "min_ma", max_age = "max_ma")
# Save
write.table.lucas(x = tmp_odr,
file = paste0(paste0("./data_2023/PyRate/", salma, "/genus_level/5-Order_level/", odr, "_EOT_gen_occ_", salma, ".txt")))
# Extract ages
extract.ages(paste0(paste0("./data_2023/PyRate/", salma, "/genus_level/5-Order_level/", odr, "_EOT_gen_occ_", salma, ".txt")),
replicates = 10)
}
# ## Species-level ---------------------------------------------------------------
#   ### Full & Singleton
#   #prepare data
#   sp_lvl <- occdf %>%
#     select(accepted_name, status, min_ma, max_ma) %>%
#     rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
#   #save
#   write.table.lucas(x = sp_lvl,
#                     file = paste0("./data_2023/PyRate/", salma, "/species_level/1-Full/Full_EOT_sp_occ_", salma, ".txt"))
#   #extract ages
#   extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/1-Full/Full_EOT_sp_occ_", salma, ".txt"),
#                replicates = 20)
#   ### Spatially scaled
#   #subset unique genera at a given age and place (characterised by p_lng, p_lat (nb. could have been present-day lon/lat))
#   sp_lvl_scaled <- occdf %>%
#     group_by(accepted_name, status, min_ma, max_ma, p_lng, p_lat, age) %>%
#     distinct(accepted_name) %>%
#     ungroup() %>%
#     select(accepted_name, status, min_ma, max_ma) %>%
#     rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
#   #save
#   write.table.lucas(x = sp_lvl_scaled,
#                     file = paste0("./data_2023/PyRate/", salma, "/species_level/2-Spatially_scaled/spatially_scaled_EOT_sp_occ_", salma, ".txt"))
#   #extract ages
#   extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/2-Spatially_scaled/spatially_scaled_EOT_sp_occ_", salma, ".txt"),
#                replicates = 20)
#   ### Tropical/Extra-tropical
#   #subset tropical/extra-tropical taxa
#   sp_trop <- occdf %>%
#     filter(loc == "T") %>%
#     select(accepted_name, status, min_ma, max_ma) %>%
#     rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
#   sp_Etrop <- occdf %>%
#     filter(loc == "E") %>%
#     select(accepted_name, status, min_ma, max_ma) %>%
#     rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
#   #save
#   write.table.lucas(x = sp_trop,
#                     file = paste0("./data_2023/PyRate/", salma, "/species_level/3-Tropical_Extratropical/Tropical_EOT_sp_occ_", salma, ".txt"))
#   write.table.lucas(x = sp_Etrop,
#                     file = paste0("./data_2023/PyRate/", salma, "/species_level/3-Tropical_Extratropical/Extratropical_EOT_sp_occ_", salma, ".txt"))
#   #extract ages
#   extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/3-Tropical_Extratropical/Tropical_EOT_sp_occ_", salma, ".txt"),
#                replicates = 20)
#   extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/3-Tropical_Extratropical/Extratropical_EOT_sp_occ_", salma, ".txt"),
#                replicates = 20)
#   ### Diet types (10 replicates)
#   for(dt in c("carnivore", "herbivore", "omnivore", "insectivore")){ #frugivore omitted, not enough data
#     tmp <- occdf %>%
#       filter(diet == dt) %>%
#       select(accepted_name, status, min_ma, max_ma) %>%
#       rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
#     write.table.lucas(x = tmp,
#                       file = paste0("./data_2023/PyRate/", salma, "/species_level/4-Ecomorphotype/", dt, "_EOT_sp_occ_", salma, ".txt"))
#     extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/4-Ecomorphotype/", dt, "_EOT_sp_occ_", salma, ".txt"),
#                  replicates = 10)
#   }
### Order (10 replicates)
for(odr in keys(tax_dict)){
# Get the occ of the corresponding "order"
tmp_odr <- occdf %>%
filter(order %in% values(tax_dict[odr])) %>%
select(accepted_name, status, min_ma, max_ma) %>%
rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
# Save
write.table.lucas(x = tmp_odr,
file = paste0(paste0("./data_2023/PyRate/", salma, "/species_level/5-Order_level/", odr, "_EOT_sp_occ_", salma, ".txt")))
# Extract ages
extract.ages(paste0(paste0("./data_2023/PyRate/", salma, "/species_level/5-Order_level/", odr, "_EOT_sp_occ_", salma, ".txt")),
replicates = 10)
}
}
recap_SALMA <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/SALMA/tab_2.tsb")
recap_SALMA <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/SALMA/tab_2.tsb", sep = ";")
library(dplyr)
?summarise
View(recap_SALMA)
recap_SALMA <- recap_SALMA %>%
select(-c(File_name, X)) %>%
group_by_all() %>%
summarise(across(HPP:X24.2, mean))
recap_SALMA <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/SALMA/tab_2.tsb", sep = ";")
recap_SALMA <- recap_SALMA %>%
select(-c(X)) %>%
group_by_all() %>%
summarise(File_name = c(File_name, "mean"),
across(where(is.numeric), ~c(., mean(.))))
mn <- sapply(X = !(colnames(recap_SALMA) %in% c("File_name", "X")),
FUN = function(x){
vec <- recap_SALMA[, x]
return(mean(vec, na.rm = TRUE))
})
recap_SALMA <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/SALMA/tab_2.tsb", sep = ";", stringsAsFactors = TRUE)
recap_SALMA <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/SALMA/tab_2.tsb", sep = ";", stringsAsFactors = TRUE)
library(dplyr)
!(colnames(recap_SALMA) %in% c("File_name", "X"))
recap_SALMA$X56.0[5] /5
mn <- sapply(X = colnames(recap_SALMA)[!(colnames(recap_SALMA) %in% c("File_name", "X"))],
FUN = function(x){
vec <- recap_SALMA[, x]
return(mean(vec, na.rm = TRUE))
})
recap_SALMA[, nrow(recap_SALMA)+1] <- c(NA, mn, NA)
recap_SALMA[nrow(recap_SALMA)+1, ] <- c(NA, mn, NA)
recap_SALMA <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/SALMA/tab_2.tsb", sep = ";", stringsAsFactors = TRUE)
mn <- sapply(X = colnames(recap_SALMA)[!(colnames(recap_SALMA) %in% c("File_name"))],
FUN = function(x){
vec <- recap_SALMA[, x]
return(mean(vec, na.rm = TRUE))
})
recap_SALMA[nrow(recap_SALMA)+1, ] <- c(NA, mn, NA)
library(dplyr)
recap_SALMA <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/SALMA/tab_2.tsb", sep = ";", stringsAsFactors = TRUE)
View(recap_SALMA)
recap_SALMA[nrow(recap_SALMA)+1, ] <- c("mean", mn)
recap_stages <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/stages/tab_1.tsb", sep = ";", stringsAsFactors = TRUE)
mn <- sapply(X = colnames(recap_stages)[!(colnames(recap_stages) %in% c("File_name"))],
FUN = function(x){
vec <- recap_stages[, x]
return(mean(vec, na.rm = TRUE))
})
recap_stages[nrow(recap_stages)+1, ] <- c("mean", mn)
View(recap_stages)
cat("\nThere are ", 50, " things I wanted to talk about")
library(dplyr)
library(dplyr)
for(salma in c("SALMA_kept")){
for(lvl in c("genus_level")){
#SALMA TPP
recap_SALMA <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/SALMA/tab_2.tsb", sep = ";", stringsAsFactors = TRUE)
mean_AICc_TPP_salma <- mean(recap_SALMA$TPP, na.rm = TRUE)
#stages TPP
recap_stages <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/stages/tab_1.tsb", sep = ";", stringsAsFactors = TRUE)
mean_AICc_TPP_stages <- mean(recap_stages$TPP, na.rm = TRUE)
if(mean_AICc_TPP_salma > mean_AICc_TPP_stages){
Winner <- "stages"
}
else{
Winner <- "SALMA"
}
cat("Retained TPP for ", salma, "at the ", lvl, ":", Winner)
}
}
for(salma in c("SALMA_kept")){
for(lvl in c("genus_level")){
#SALMA TPP
recap_SALMA <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/SALMA/tab_2.tsb", sep = ";", stringsAsFactors = TRUE)
mean_AICc_TPP_salma <- mean(recap_SALMA$TPP, na.rm = TRUE)
#stages TPP
recap_stages <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/stages/tab_1.tsb", sep = ";", stringsAsFactors = TRUE)
mean_AICc_TPP_stages <- mean(recap_stages$TPP, na.rm = TRUE)
if(mean_AICc_TPP_salma > mean_AICc_TPP_stages){
Winner <- "stages"
}
else{
Winner <- "SALMA"
}
cat("Retained TPP for", salma, "at the", lvl, ":", Winner)
}
}
library(dplyr)
## Accessory functions ---------------------------------------------------------
source("../../pyrate_utilities.R")
source("./R/useful/helper_functions.R")
i <- 5
for(salma in c("SALMA_kept", "SALMA_smoothed")){
i <- i+1
occdf <- readRDS(paste0("./data_2023/SPECIES_LISTS/", i, "-Fully_cleaned_EOT_SA_Mammals_", salma, "_Tropics_Diet.RDS"))
## Species-level ---------------------------------------------------------------
### Full & Singleton
#prepare data
sp_lvl <- occdf %>%
select(accepted_name, status, min_ma, max_ma) %>%
rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
#save
write.table.lucas(x = sp_lvl,
file = paste0("./data_2023/PyRate/", salma, "/species_level/1-Full/Full_EOT_sp_occ_", salma, ".txt"))
#extract ages
extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/1-Full/Full_EOT_sp_occ_", salma, ".txt"),
replicates = 20)
### Spatially scaled
#subset unique genera at a given age and place (characterised by p_lng, p_lat (nb. could have been present-day lon/lat))
sp_lvl_scaled <- occdf %>%
group_by(accepted_name, status, min_ma, max_ma, p_lng, p_lat, age) %>%
distinct(accepted_name) %>%
ungroup() %>%
select(accepted_name, status, min_ma, max_ma) %>%
rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
#save
write.table.lucas(x = sp_lvl_scaled,
file = paste0("./data_2023/PyRate/", salma, "/species_level/2-Spatially_scaled/spatially_scaled_EOT_sp_occ_", salma, ".txt"))
#extract ages
extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/2-Spatially_scaled/spatially_scaled_EOT_sp_occ_", salma, ".txt"),
replicates = 20)
### Tropical/Extra-tropical
#subset tropical/extra-tropical taxa
sp_trop <- occdf %>%
filter(loc == "T") %>%
select(accepted_name, status, min_ma, max_ma) %>%
rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
sp_Etrop <- occdf %>%
filter(loc == "E") %>%
select(accepted_name, status, min_ma, max_ma) %>%
rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
#save
write.table.lucas(x = sp_trop,
file = paste0("./data_2023/PyRate/", salma, "/species_level/3-Tropical_Extratropical/Tropical_EOT_sp_occ_", salma, ".txt"))
write.table.lucas(x = sp_Etrop,
file = paste0("./data_2023/PyRate/", salma, "/species_level/3-Tropical_Extratropical/Extratropical_EOT_sp_occ_", salma, ".txt"))
#extract ages
extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/3-Tropical_Extratropical/Tropical_EOT_sp_occ_", salma, ".txt"),
replicates = 20)
extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/3-Tropical_Extratropical/Extratropical_EOT_sp_occ_", salma, ".txt"),
replicates = 20)
### Diet types (10 replicates)
for(dt in c("carnivore", "herbivore", "omnivore", "insectivore")){ #frugivore omitted, not enough data
tmp <- occdf %>%
filter(diet == dt) %>%
select(accepted_name, status, min_ma, max_ma) %>%
rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
write.table.lucas(x = tmp,
file = paste0("./data_2023/PyRate/", salma, "/species_level/4-Ecomorphotype/", dt, "_EOT_sp_occ_", salma, ".txt"))
extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/4-Ecomorphotype/", dt, "_EOT_sp_occ_", salma, ".txt"),
replicates = 10)
}
### Order (10 replicates)
for(odr in keys(tax_dict)){
# Get the occ of the corresponding "order"
tmp_odr <- occdf %>%
filter(order %in% values(tax_dict[odr])) %>%
select(accepted_name, status, min_ma, max_ma) %>%
rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
# Save
write.table.lucas(x = tmp_odr,
file = paste0(paste0("./data_2023/PyRate/", salma, "/species_level/5-Order_level/", odr, "_EOT_sp_occ_", salma, ".txt")))
# Extract ages
extract.ages(paste0(paste0("./data_2023/PyRate/", salma, "/species_level/5-Order_level/", odr, "_EOT_sp_occ_", salma, ".txt")),
replicates = 10)
}
}
'./data_2023/SPECIES_LISTS/'
i <- 5
for(salma in c("SALMA_smoothed")){
i <- i+1
occdf <- readRDS(paste0("./data_2023/SPECIES_LISTS/", i, "-Fully_cleaned_EOT_SA_Mammals_", salma, "_Tropics_Diet.RDS"))
## Species-level ---------------------------------------------------------------
### Full & Singleton
#prepare data
sp_lvl <- occdf %>%
select(accepted_name, status, min_ma, max_ma) %>%
rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
#save
write.table.lucas(x = sp_lvl,
file = paste0("./data_2023/PyRate/", salma, "/species_level/1-Full/Full_EOT_sp_occ_", salma, ".txt"))
#extract ages
extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/1-Full/Full_EOT_sp_occ_", salma, ".txt"),
replicates = 20)
### Spatially scaled
#subset unique genera at a given age and place (characterised by p_lng, p_lat (nb. could have been present-day lon/lat))
sp_lvl_scaled <- occdf %>%
group_by(accepted_name, status, min_ma, max_ma, p_lng, p_lat, age) %>%
distinct(accepted_name) %>%
ungroup() %>%
select(accepted_name, status, min_ma, max_ma) %>%
rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
#save
write.table.lucas(x = sp_lvl_scaled,
file = paste0("./data_2023/PyRate/", salma, "/species_level/2-Spatially_scaled/spatially_scaled_EOT_sp_occ_", salma, ".txt"))
#extract ages
extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/2-Spatially_scaled/spatially_scaled_EOT_sp_occ_", salma, ".txt"),
replicates = 20)
### Tropical/Extra-tropical
#subset tropical/extra-tropical taxa
sp_trop <- occdf %>%
filter(loc == "T") %>%
select(accepted_name, status, min_ma, max_ma) %>%
rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
sp_Etrop <- occdf %>%
filter(loc == "E") %>%
select(accepted_name, status, min_ma, max_ma) %>%
rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
#save
write.table.lucas(x = sp_trop,
file = paste0("./data_2023/PyRate/", salma, "/species_level/3-Tropical_Extratropical/Tropical_EOT_sp_occ_", salma, ".txt"))
write.table.lucas(x = sp_Etrop,
file = paste0("./data_2023/PyRate/", salma, "/species_level/3-Tropical_Extratropical/Extratropical_EOT_sp_occ_", salma, ".txt"))
#extract ages
extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/3-Tropical_Extratropical/Tropical_EOT_sp_occ_", salma, ".txt"),
replicates = 20)
extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/3-Tropical_Extratropical/Extratropical_EOT_sp_occ_", salma, ".txt"),
replicates = 20)
### Diet types (10 replicates)
for(dt in c("carnivore", "herbivore", "omnivore", "insectivore")){ #frugivore omitted, not enough data
tmp <- occdf %>%
filter(diet == dt) %>%
select(accepted_name, status, min_ma, max_ma) %>%
rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
write.table.lucas(x = tmp,
file = paste0("./data_2023/PyRate/", salma, "/species_level/4-Ecomorphotype/", dt, "_EOT_sp_occ_", salma, ".txt"))
extract.ages(paste0("./data_2023/PyRate/", salma, "/species_level/4-Ecomorphotype/", dt, "_EOT_sp_occ_", salma, ".txt"),
replicates = 10)
}
### Order (10 replicates)
for(odr in keys(tax_dict)){
# Get the occ of the corresponding "order"
tmp_odr <- occdf %>%
filter(order %in% values(tax_dict[odr])) %>%
select(accepted_name, status, min_ma, max_ma) %>%
rename(Species = "accepted_name", Status = "status", min_age = "min_ma", max_age = "max_ma")
# Save
write.table.lucas(x = tmp_odr,
file = paste0(paste0("./data_2023/PyRate/", salma, "/species_level/5-Order_level/", odr, "_EOT_sp_occ_", salma, ".txt")))
# Extract ages
extract.ages(paste0(paste0("./data_2023/PyRate/", salma, "/species_level/5-Order_level/", odr, "_EOT_sp_occ_", salma, ".txt")),
replicates = 10)
}
}

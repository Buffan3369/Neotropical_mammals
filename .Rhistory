else{
return(BC)
}
}
# Compute Bray-Curtis pairwise assemblage dissimilarities
BC_matrix <- matrix(nrow = 5, ncol = 5)
stages <- c("Early_Eocene", "Mid_Eocene", "Late_Eocene", "Early_Oliogcene", "Late_Oligocene")
for(stg in stages){
a1 <- count_df1 %>%
filter(stage == stg) %>%
select(diet, diversity)
BC <- c()
for(stg1 in stages){
a2 <- count_df1 %>%
filter(stage == stg1) %>%
select(diet, diversity)
BC <- c(BC, bray_curtis(a1, a2, round=TRUE, d=3))
}
i <- which(stages == stg)
BC_matrix[,i] <- BC
}
BC_df <- data.frame(BC_matrix)
colnames(BC_df) <- stages
row.names(BC_df) <- stages
View(BC_df)
heatmap(BC_matrix)
?heatmap
heatmap(BC_matrix, Rowv = FALSE)
heatmap(BC_matrix, dendrogram='none', Rowv=FALSE, Colv=FALSE,trace='none')
write.table(BC_df, "./figures/Figure_2/Bray_Curtis_ecological_dissimilarities.txt", sep = "\t")
warnings()
write.table(BC_df, "./figures/Figure_2/Bray_Curtis_ecological_dissimilarities.txt", sep = "\t")
write.table(BC_df, "./figures/Figure_2/Bray_Curtis_ecological_dissimilarities.txt", sep = "\t")
dev.off()
View(count_df1)
# Plots
# Early Eocene
ee_only <- count_df1 %>% subset(stage == "Early_Eocene")
View(ee_only)
View(ee_only)
# Plots
# Early Eocene
ee_only <- count_df1 %>%
subset(stage == "Early_Eocene") %>%
mutate(prop = sapply(X = diversity, FUN = function(x){return(x/sum(diversity))}))
View(ee_only)
# Plots
# Early Eocene
ee_only <- count_df1 %>%
subset(stage == "Early_Eocene") %>%
mutate(prop = sapply(X = diversity, FUN = function(x){return(x/sum(diversity))})) %>%
ee_pie <- ee_only %>%
ggplot(aes(x = "", y = prop, fill = diet)) +
geom_bar(stat = "identity") +
coord_polar("y") +
scale_fill_manual(values = c("#de2d26", "#31a354", "#756bb1", "#2b8cbe")) +
theme_minimal() +
theme(axis.line = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank(),
axis.text = element_blank())
# Plots
# Early Eocene
ee_only <- count_df1 %>%
subset(stage == "Early_Eocene") %>%
mutate(prop = sapply(X = diversity, FUN = function(x){return(x/sum(diversity))}))
ee_pie <- ee_only %>%
ggplot(aes(x = "", y = prop, fill = diet)) +
geom_bar(stat = "identity") +
coord_polar("y") +
scale_fill_manual(values = c("#de2d26", "#31a354", "#756bb1", "#2b8cbe")) +
theme_minimal() +
theme(axis.line = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank(),
axis.text = element_blank())
ggsave("./figures/Figure_2/pie_charts.pdf", ee_pie, height = 50, width = 50, units = "mm")
ggsave("./figures/Figure_2/early_eocene.pdf", ee_pie, height = 50, width = 50, units = "mm")
# facet
int.labs <- c("Eocene", "Oligocene")
names(int.labs) <- c("Eocene", "Oligocene")
stg.labs <- c("Upper", "Lower")
names(stg.labs) <- c("Upper", "Lower")
pie_charts <- prop_df %>%
mutate(diet = factor(diet, levels = c("carnivore", "herbivore", "insectivore", "omnivore"))) %>%
ggplot(aes(x = "", y = diversity, fill = diet)) +
geom_bar(stat = "identity") +
coord_polar("y") +
scale_fill_manual(values = c("#de2d26", "#31a354", "#756bb1", "#2b8cbe")) +
facet_wrap(epoch~stage, labeller = labeller(epoch=int.labs, stage=stg.labs)) +
theme_minimal() +
theme(axis.line = element_blank(),
panel.grid = element_blank(),
axis.title = element_blank(),
axis.text = element_blank())
ggsave("./figures/Figure_2/pie_charts.pdf", height = 200, width = 200, units = "mm")
ggsave("./figures/Figure_2/early_eocene.pdf", ee_pie, height = 100, width = 100, units = "mm")
View(BC_df)
BC_df %>% pivot_wider(values_from = "BC_idx", names_from = "Stage")
?pivot_wider
BC_df %>% pivot_wider(values_from = "BC_idx")
BC_df1 <- BC_df
row.names(BC_df1) <- 1:nrow(BC_df1)
?pivot_longer
BC_df1 %>% pivot_longer(!(stage), names_to = "period", values_to = "BC_idx")
BC_df1$stage <-  c("Early_Eocene", "Mid_Eocene", "Late_Eocene", "Early_Oliogcene", "Late_Oligocene")
BC_df1 %>% pivot_longer(!(stage), names_to = "period", values_to = "BC_idx")
BC_df1 <- BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile()
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile()
BC_df1 <- BC_df
row.names(BC_df1) <- 1:nrow(BC_df1)
BC_df1$stage <-  c("Early_Eocene", "Mid_Eocene", "Late_Eocene", "Early_Oliogcene", "Late_Oligocene")
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile()
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
coord_fixed() +
geom_text(aes(label = BC_idx))
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
coord_fixed() +
geom_text(aes(label = BC_idx), colour = "white")
coord_fixed() +
geom_text(aes(label = BC_idx))
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() +
geom_text(aes(label = BC_idx))
?factor
BC_df1 <- BC_df
row.names(BC_df1) <- 1:nrow(BC_df1)
BC_df1$stage <- factor(x=c("Early_Eocene", "Mid_Eocene", "Late_Eocene", "Early_Oliogcene", "Late_Oligocene"),
levels = c("Early_Eocene", "Mid_Eocene", "Late_Eocene", "Early_Oliogcene", "Late_Oligocene"))
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
mutate(period = factor(x=c("Early_Eocene", "Mid_Eocene", "Late_Eocene", "Early_Oliogcene", "Late_Oligocene"),
levels = c("Early_Eocene", "Mid_Eocene", "Late_Eocene", "Early_Oliogcene", "Late_Oligocene"))) %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() +
geom_text(aes(label = BC_idx))
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() +
geom_text(aes(label = BC_idx))
BC_df1 <- BC_df
row.names(BC_df1) <- 1:nrow(BC_df1)
BC_df1$stage <- factor(x=c("Early_Eocene", "Mid_Eocene", "Late_Eocene", "Early_Oliogcene", "Late_Oligocene"),
levels = c("Early_Eocene", "Mid_Eocene", "Late_Eocene", "Early_Oliogcene", "Late_Oligocene"))
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
mutate(period = factor(period,
levels = c(rep("Early_Eocene",5), rep("Mid_Eocene", 5), rep("Late_Eocene", 5), rep("Early_Oliogcene", 5), rep("Late_Oligocene", 5)))) %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() +
geom_text(aes(label = BC_idx))
rlang::last_trace()
BC_df1 <- BC_df
row.names(BC_df1) <- 1:nrow(BC_df1)
colnames(BC_df1) <- c("1-Early_Eocene", "2-Mid_Eocene", "3-Late_Eocene", "4-Early_Oliogcene", "5-Late_Oligocene")
BC_df1$stage <- factor(x=c("Early_Eocene", "Mid_Eocene", "Late_Eocene", "Early_Oliogcene", "Late_Oligocene"),
levels = c("Early_Eocene", "Mid_Eocene", "Late_Eocene", "Early_Oliogcene", "Late_Oligocene"))
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() +
geom_text(aes(label = BC_idx))
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal(legend.position = "none")
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal(legend.position = "none")
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal() +
theme(legend.position = "none")
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank())
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
panel.border = element_rect())
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
panel.border = element_rect(fill="transparent"))
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
#  theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
panel.border = element_rect(fill="transparent"))
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
#  theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
plot.background = element_rect(fill="transparent"))
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
plot.background = element_rect(fill="transparent", colour = "black", linewidth = 2))
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 4))
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 14))
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 12))
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 10))
hm <- BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "red") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 10))
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "#fb6a4a") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 10))
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "#ef3b2c") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 10))
BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "#ef3b2c") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 10),
panel.border = element_rect(fill="transparent"))
hm <- BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "#ef3b2c") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 10),
panel.border = element_rect(fill="transparent"))
ggsave("./figures/Figure_2/Bray_Curtis_heatmap.pdf", hm, height = 100, width = 100, units="mm")
hm <- BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "#ef3b2c") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx)) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 5),
text = element_text(size = 5),
panel.border = element_rect(fill="transparent"))
ggsave("./figures/Figure_2/Bray_Curtis_heatmap.pdf", hm, height = 100, width = 100, units="mm")
hm <- BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "#ef3b2c") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx), size=5) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 5),
panel.border = element_rect(fill="transparent"))
ggsave("./figures/Figure_2/Bray_Curtis_heatmap.pdf", hm, height = 100, width = 100, units="mm")
hm <- BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "#ef3b2c") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx), size=1) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 5),
panel.border = element_rect(fill="transparent"))
ggsave("./figures/Figure_2/Bray_Curtis_heatmap.pdf", hm, height = 100, width = 100, units="mm")
hm <- BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "#ef3b2c") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx), size=3) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 5),
panel.border = element_rect(fill="transparent"))
ggsave("./figures/Figure_2/Bray_Curtis_heatmap.pdf", hm, height = 100, width = 100, units="mm")
hm <- BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "#ef3b2c") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx), size=2) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 5),
panel.border = element_rect(fill="transparent"))
ggsave("./figures/Figure_2/Bray_Curtis_heatmap.pdf", hm, height = 100, width = 100, units="mm")
hm <- BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "#ef3b2c") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx), size=2) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 6),
panel.border = element_rect(fill="transparent"))
ggsave("./figures/Figure_2/Bray_Curtis_heatmap.pdf", hm, height = 100, width = 100, units="mm")
hm <- BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_y_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "#ef3b2c") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx), size=2) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 6),
panel.border = element_rect(fill="transparent"))
ggsave("./figures/Figure_2/Bray_Curtis_heatmap.pdf", hm, height = 100, width = 100, units="mm")
ggsave("./figures/Figure_2/Bray_Curtis_heatmap.pdf", hm, height = 100, width = 100, units="mm")
hm <- BC_df1 %>%
pivot_longer(!(stage), names_to = "period", values_to = "BC_idx") %>%
ggplot(aes(x=period, y=stage, fill=BC_idx)) +
geom_tile() +
scale_x_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_y_discrete(labels = c("Early Eocene", "Middle Eocene", "Late Eocene", "Early Oliogcene", "Late Oligocene")) +
scale_fill_gradient(low = "white", high = "#ef3b2c") +
coord_fixed() + # keep squared
geom_text(aes(label = BC_idx), size=2) +
theme_minimal() +
theme(legend.position = "none",
axis.title = element_blank(),
axis.text = element_text(size = 8),
panel.border = element_rect(fill="transparent"))
ggsave("./figures/Figure_2/Bray_Curtis_heatmap.pdf", hm, height = 100, width = 100, units="mm")
rm(list = ls())

JI <- JI %>% add_column(pastes("jac_", t) = apply(X = keys(tax_dict), FUN = function(x){return(jac_idx(t, cls = x))}))
# compute Jaccard's similarities between Eocene and Oligocene assemblages of each of or five groups
JI <- data.frame(group = keys(tax_dict))
jac_idx <- function(t, cls){
sub <- TsTe_ttl %>% filter(class == cls)
Eoc_gen <- sub$genus[which(sub$ts >= t)]
Olig_gen <-  sub$genus[which(sub$te <= t)]
return(round(jaccard(Eoc_gen, Olig_gen), digits = 2))
}
for(t in seq(52, 24, -0.1)){
JI <- JI %>% add_column(apply(X = keys(tax_dict), FUN = function(x){return(jac_idx(t, cls = x))}))
colnames(JI) <- c(colnames(JI)[1:length(JI)-1], pastes("jac_", t))
}
# compute Jaccard's similarities between Eocene and Oligocene assemblages of each of or five groups
JI <- data.frame(group = keys(tax_dict))
jac_idx <- function(t, cls){
sub <- TsTe_ttl %>% filter(class == cls)
Eoc_gen <- sub$genus[which(sub$ts >= t)]
Olig_gen <-  sub$genus[which(sub$te <= t)]
return(round(jaccard(Eoc_gen, Olig_gen), digits = 2))
}
for(t in seq(52, 24, -0.1)){
JI <- JI %>% add_column(sapply(X = keys(tax_dict), FUN = function(x){return(jac_idx(t, cls = x))}))
colnames(JI) <- c(colnames(JI)[1:length(JI)-1], pastes("jac_", t))
}
for(t in seq(52, 24, -0.1)){
JI <- JI %>% add_column(sapply(X = keys(tax_dict), FUN = function(x){return(jac_idx(t, cls = x))}))
colnames(JI) <- c(colnames(JI)[1:length(JI)-1], paste0("jac_", t))
}
View(JI)
# compute Jaccard's similarities between Eocene and Oligocene assemblages of each of or five groups
JI <- data.frame(group = keys(tax_dict))
jac_idx <- function(t, cls){
sub <- TsTe_ttl %>% filter(class == cls)
Eoc_gen <- sub$genus[which(sub$ts >= t)]
Olig_gen <-  sub$genus[which(sub$te <= t)]
return(round(jaccard(Eoc_gen, Olig_gen), digits = 2))
}
t=52
JI <- JI %>% add_column(sapply(X = keys(tax_dict), FUN = function(x){return(jac_idx(t, cls = x))}))
colnames(JI) <- c(colnames(JI)[1:length(JI)-1], paste0("jac_", t))
View(JI)
JI <- data.frame(group = keys(tax_dict))
jac_idx <- function(t, cls){
sub <- TsTe_ttl %>% filter(class == cls)
Eoc_gen <- sub$genus[which(sub$ts >= t)]
Olig_gen <-  sub$genus[which(sub$te <= t)]
return(round(jaccard(Eoc_gen, Olig_gen), digits = 2))
}
for(t in seq(52, 24, -0.1)){
JI <- JI %>% add_column(sapply(X = keys(tax_dict), FUN = function(x){return(jac_idx(t, cls = x))}))
colnames(JI) <- c(colnames(JI)[1:length(JI)-1], paste0("jac_", t))
}
View(JI)
plot(x = seq(52, 24, -0.1),
y = JI[2,1:length(colnames(JI))])
JI[2,1:length(colnames(JI))]
length(JI[2,1:length(colnames(JI))])
length(seq(52, 24, -0.1))
seq(52, 24, -0.1)
plot(x = seq(52, 24, -0.1),
y = JI[2,2:length(colnames(JI))])
View(JI)
abline(v = 33.9)
JI <- data.frame(age = seq(52, 24, -0.1))
jac_idx <- function(t, cls){
sub <- TsTe_ttl %>% filter(class == cls)
Eoc_gen <- sub$genus[which(sub$ts >= t)]
Olig_gen <-  sub$genus[which(sub$te <= t)]
return(round(jaccard(Eoc_gen, Olig_gen), digits = 2))
}
for(c in keys(tax_dict)){
JI <- JI %>% add_column(c = sapply(X = seq(52, 24, -0.1), FUN = function(x){return(jac_idx(t = x, cls = c))}))
}
View(JI)
# compute Jaccard's similarities between Eocene and Oligocene assemblages of each of or five groups
JI <- data.frame(age = seq(52, 24, -0.1))
jac_idx <- function(t, cls){
sub <- TsTe_ttl %>% filter(class == cls)
Eoc_gen <- sub$genus[which(sub$ts >= t)]
Olig_gen <-  sub$genus[which(sub$te <= t)]
return(round(jaccard(Eoc_gen, Olig_gen), digits = 2))
}
for(cls in keys(tax_dict)){
JI <- JI %>% add_column(sapply(X = seq(52, 24, -0.1), FUN = function(x){return(jac_idx(t = x, cls = cls))}))
colnames(JI) <- c(colnames(JI)[1:length(JI)-1], cls)
}
plot(x = JI$age, y = JI$Metatheria)
abline(v = 33.9)
par(mforw = c(2, 3))
plot(x = JI$age, y = JI$Metatheria)
abline(v = 33.9)
plot(x = JI$age, y = JI$Notoungulata)
abline(v = 33.9)
plot(x = JI$age, y = JI$Other_SANUs)
abline(v = 33.9)
plot(x = JI$age, y = JI$Rodentia)
abline(v = 33.9)
plot(x = JI$age, y = JI$Xenarthra)
abline(v = 33.9)
par(mfrow = c(2, 3))
plot(x = JI$age, y = JI$Metatheria)
abline(v = 33.9)
plot(x = JI$age, y = JI$Notoungulata)
abline(v = 33.9)
plot(x = JI$age, y = JI$Other_SANUs)
abline(v = 33.9)
plot(x = JI$age, y = JI$Rodentia)
abline(v = 33.9)
plot(x = JI$age, y = JI$Xenarthra)
abline(v = 33.9)
################################################################################
# Name: 11-Jaccard_time_panel.R
# Author: Lucas Buffan
# Contact: lucas.l.buffan@gmail.com
# Aim: Script for Jaccard's index across time
################################################################################
library(tidyverse)
library(deeptime)
library(ggpubr)
library(rphylopic)
library(readxl)
source("./R/useful/helper_functions.R")
# Open species List
spl <- readRDS("./data_2023/SPECIES_LISTS/7-Fully_cleaned_EOT_extended_SA_Mammals_SALMA_kept_Tropics_Diet.RDS")
spl$genus <- sapply(X = spl$genus, FUN = spc_to_udsc) # e.g. "cf. Tarapotomys" => "cf._Tarapotomys"
# Function returning estimated age boundaries of a family
Ori_ext <- function(fam, gen_fam_tbl, TsTe_tbl, time = c("Ts", "Te")){
tmp_fam <- gen_fam_tbl %>% filter(family == fam)
TsTe_tmp <- TsTe_tbl %>% filter(genus %in% tmp_fam$genus)
if(time == "Ts"){
return(max(TsTe_tmp$ts))
}
else if(time == "Te"){
return(min(TsTe_tmp$te))
}
}
# GEOSCALES
# First geoscale
gsc1 <- deeptime::epochs
gsc1 <- gsc1 %>% filter(min_age < 56)
# Set second geoscale
gsc2 <- read_xlsx("./data_2023/time_bins/EarlyMidLate_epochs.xlsx")
gsc2 <- gsc2 %>% rename(min_age = "min_ma", max_age = "max_ma", name = "interval_name")
# DATA Preprocessing
# Reference dataset for taxonomic equivalents
ref <- read.table("./data_2023/PyRate/EXTENDED/SALMA_kept/genus_level/1-Full/Full_EOT_gen_occ_SALMA_kept_TaxonList.txt", header = TRUE)
ref$order <- sapply(X = ref$Species, FUN = function(x){unique(spl$order[which(spl$genus == x)])})
ref$family <- sapply(X = ref$Species, FUN = function(x){unique(spl$family[which(spl$genus == x)])})
# Full TsTe table
TsTe_ttl <- read.table("./results_EXTENDED/SALMA_smoothed/genus_level/1-Full/MH_sampler/LTT/Full_EOT_gen_occ_SALMA_smoothed_10_Grj_KEEP_se_est.txt",
header = TRUE)
TsTe_ttl <- TsTe_ttl %>%
add_column(order = ref$order, family = ref$family, genus = ref$Species)
# Compute mean ts and te
Ts_ttl <- TsTe_ttl %>%
select(matches("ts"))
Te_ttl <- TsTe_ttl %>%
select(matches("te"))
TsTe_ttl <- TsTe_ttl %>%
mutate(mean_ts = rowMeans(Ts_ttl),
mean_te = rowMeans(Te_ttl)) %>%
select(order, family, genus, mean_ts, mean_te) %>%
rename(ts = "mean_ts", te = "mean_te") %>%
filter(ts > 24 & te < 52 & genus %in% c("Bryanpattersonia", "Palaeocladosictis") == FALSE) # artefactual genera
rm(Ts_ttl, Te_ttl)
# define a key for displaying orders
TsTe_ttl$class <- "Other_mammalia"
for(key in keys(tax_dict)){
corr_odr <- values(tax_dict[key])
idx <- which(TsTe_ttl$order %in% corr_odr)
TsTe_ttl$class[idx] <- key
}
TsTe_ttl <- TsTe_ttl %>%
mutate(class = factor(class, levels = c("Other_mammalia", "Metatheria", "Xenarthra", "Rodentia", "Other_SANUs", "Notoungulata"))) %>%
arrange(class, ts)
# set extent of each class
MinMax <- data.frame("Other_mammalia" = c(0, which.max(which(TsTe_ttl$class == "Other_mammalia"))+1))
for(cl in c("Metatheria", "Xenarthra", "Rodentia", "Other_SANUs", "Notoungulata")){
corr_idx <- which(TsTe_ttl$class == cl)
MinMax <- MinMax %>% add_column(cl = c(corr_idx[which.min(corr_idx)],
corr_idx[which.max(corr_idx)]+1))
}
colnames(MinMax) <- c("Other_mammalia", "Metatheria", "Xenarthra", "Rodentia", "Other_SANUs", "Notoungulata")
# compute Jaccard's similarities through time across the five groups
JI <- data.frame(age = seq(52, 24, -0.1))
jac_idx <- function(t, cls){
sub <- TsTe_ttl %>% filter(class == cls)
Eoc_gen <- sub$genus[which(sub$ts >= t)]
Olig_gen <-  sub$genus[which(sub$te <= t)]
return(round(jaccard(Eoc_gen, Olig_gen), digits = 2))
}
for(cls in keys(tax_dict)){
JI <- JI %>% add_column(sapply(X = seq(52, 24, -0.1), FUN = function(x){return(jac_idx(t = x, cls = cls))}))
colnames(JI) <- c(colnames(JI)[1:length(JI)-1], cls)
}
View(JI)
par(mfrow = c(2, 3))
plot(x = JI$age, y = JI$Metatheria)
abline(v = 33.9)
plot(x = JI$age, y = JI$Notoungulata)
abline(v = 33.9)
plot(x = JI$age, y = JI$Other_SANUs)
abline(v = 33.9)
plot(x = JI$age, y = JI$Rodentia)
abline(v = 33.9)
plot(x = JI$age, y = JI$Xenarthra)
abline(v = 33.9)
ggplot(data = JI, aes(x = age, y = Metatheria)) +
geom_point()
ggplot(data = JI, aes(x = age, y = "Metatheria")) +
geom_point()
tmp_plt <- ggplot(data = JI, aes(x = age, y = Metatheria)) +
geom_point()
?pivot_longer
data("billboard")
force(billboard)
force(billboard)
View(billboard)
View(billboard %>%
pivot_longer(
cols = starts_with("wk"),
names_to = "week",
names_prefix = "wk",
values_to = "rank",
values_drop_na = TRUE
))
keys(tax_dict)
plot <- JI %>%
pivot_longer(cols = keys(tax_dict),
names_to = "group")
View(plot)
JI %>%
pivot_longer(cols = keys(tax_dict),
names_to = "group",
values_to = "jaccard") %>%
ggplot(aes(x = age, y = jaccard)) +
geom_point() +
labs(x = "Time (Ma)", y = "Jaccard's index") +
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) +
annotate(geom = "text", x = 32, y = 0.35, label = "EOT", size = 5, colour = "red") +
theme_minimal() +
facet_wrap(~group, ncol = 3)
JI %>%
pivot_longer(cols = keys(tax_dict),
names_to = "group",
values_to = "jaccard") %>%
ggplot(aes(x = age, y = jaccard)) +
scale_x_reverse() +
geom_point() +
labs(x = "Time (Ma)", y = "Jaccard's index") +
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) +
annotate(geom = "text", x = 32, y = 0.35, label = "EOT", size = 5, colour = "red") +
theme_minimal() +
facet_wrap(~group, ncol = 3)
JI %>%
pivot_longer(cols = keys(tax_dict),
names_to = "group",
values_to = "jaccard") %>%
ggplot(aes(x = age, y = jaccard)) +
scale_x_reverse() +
geom_point() +
labs(x = "Time (Ma)", y = "Jaccard's index") +
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) +
annotate(geom = "text", x = 32, y = 0.45, label = "EOT", size = 5, colour = "red") +
theme(axis.title = element_text(size = 18),
axis.text.x = element_text(size = 18, vjust = 0.2),
axis.text.y = element_text(size = 18, hjust = 0.5),
axis.ticks.y = element_blank(),
legend.position = "none",
strip.text.x = element_text(size = 18),
strip.text.y = element_text(size = 18),
strip.background = element_rect(colour = "black", fill = "bisque2"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
facet_wrap(~group, ncol = 3)
JI %>%
pivot_longer(cols = keys(tax_dict),
names_to = "group",
values_to = "jaccard") %>%
ggplot(aes(x = age, y = jaccard)) +
scale_x_reverse() +
#  geom_point() +
geom_line() +
labs(x = "Time (Ma)", y = "Jaccard's index") +
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) +
annotate(geom = "text", x = 32, y = 0.45, label = "EOT", size = 5, colour = "red") +
theme(axis.title = element_text(size = 18),
axis.text.x = element_text(size = 18, vjust = 0.2),
axis.text.y = element_text(size = 18, hjust = 0.5),
axis.ticks.y = element_blank(),
legend.position = "none",
strip.text.x = element_text(size = 18),
strip.text.y = element_text(size = 18),
strip.background = element_rect(colour = "black", fill = "bisque2"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
facet_wrap(~group, ncol = 3)
JI %>%
pivot_longer(cols = keys(tax_dict),
names_to = "group",
values_to = "jaccard") %>%
ggplot(aes(x = age, y = jaccard)) +
scale_x_reverse() +
#  geom_point() +
geom_line() +
labs(x = "Time (Ma)", y = "Jaccard's index") +
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) +
annotate(geom = "text", x = 32, y = 0.45, label = "EOT", size = 5, colour = "red") +
theme(axis.title = element_text(size = 18),
axis.text.x = element_text(size = 18, vjust = 0.2),
axis.text.y = element_text(size = 18, hjust = 0.5),
axis.ticks.y = element_blank(),
legend.position = "none",
strip.text.x = element_text(size = 18),
strip.text.y = element_text(size = 18),
strip.background = element_rect(colour = "black", fill = "bisque2"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
coord_geo(dat = "epochs") +
facet_wrap(~group, ncol = 3)
JI %>%
pivot_longer(cols = keys(tax_dict),
names_to = "group",
values_to = "jaccard") %>%
ggplot(aes(x = age, y = jaccard)) +
scale_x_reverse() +
#  geom_point() +
geom_line() +
labs(x = "Time (Ma)", y = "Jaccard's index") +
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) +
annotate(geom = "text", x = 32, y = 0.45, label = "EOT", size = 5, colour = "red") +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
theme(axis.title = element_text(size = 18),
axis.text.x = element_text(size = 18, vjust = 0.2),
axis.text.y = element_text(size = 18, hjust = 0.5),
axis.ticks.y = element_blank(),
legend.position = "none",
strip.text.x = element_text(size = 18),
strip.text.y = element_text(size = 18),
strip.background = element_rect(colour = "black", fill = "bisque2"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
coord_geo(pos = list("bottom", "bottom"),
dat = list(gsc2, gsc1),
abbrv = list(T, F),
lwd = 0.35,
center_end_labels = TRUE,
height = unit(1, "line"),
size = "auto") +
facet_wrap(~group, ncol = 3)
JI %>%
pivot_longer(cols = keys(tax_dict),
names_to = "group",
values_to = "jaccard") %>%
ggplot(aes(x = age, y = jaccard)) +
scale_x_reverse() +
#  geom_point() +
geom_line() +
labs(x = "Time (Ma)", y = "Jaccard's index") +
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) +
annotate(geom = "text", x = 32, y = 0.45, label = "EOT", size = 5, colour = "red") +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
theme(axis.title = element_text(size = 18),
axis.text.x = element_text(size = 18, vjust = 0.2),
axis.text.y = element_text(size = 18, hjust = 0.5),
legend.position = "none",
strip.text.x = element_text(size = 18),
strip.text.y = element_text(size = 18),
strip.background = element_rect(colour = "black", fill = "bisque2"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
coord_geo(pos = list("bottom", "bottom"),
dat = list(gsc2, gsc1),
abbrv = list(T, F),
lwd = 0.35,
center_end_labels = TRUE,
height = unit(1, "line"),
size = "auto") +
facet_wrap(~group, ncol = 3)
jac_plot <- JI %>%
pivot_longer(cols = keys(tax_dict),
names_to = "group",
values_to = "jaccard") %>%
ggplot(aes(x = age, y = jaccard)) +
scale_x_reverse() +
geom_line() +
labs(x = "Time (Ma)", y = "Jaccard's index") +
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) +
annotate(geom = "text", x = 32, y = 0.45, label = "EOT", size = 5, colour = "red") +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
theme(axis.title = element_text(size = 18),
axis.text.x = element_text(size = 18, vjust = 0.2),
axis.text.y = element_text(size = 18, hjust = 0.5),
legend.position = "none",
strip.text.x = element_text(size = 18),
strip.text.y = element_text(size = 18),
strip.background = element_rect(colour = "black", fill = "bisque2"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
coord_geo(pos = list("bottom", "bottom"),
dat = list(gsc2, gsc1),
abbrv = list(T, F),
lwd = 0.35,
center_end_labels = TRUE,
height = unit(1, "line"),
size = "auto") +
facet_wrap(~group, ncol = 3)
jac_plot <- JI %>%
pivot_longer(cols = keys(tax_dict),
names_to = "group",
values_to = "jaccard") %>%
ggplot(aes(x = age, y = jaccard)) +
scale_x_reverse() +
geom_line() +
labs(x = "Time (Ma)", y = "Jaccard's index") +
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) +
annotate(geom = "text", x = 32, y = 0.45, label = "EOT", size = 5, colour = "red") +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
theme(axis.title = element_text(size = 18),
axis.text.x = element_text(size = 18, vjust = 0.2),
axis.text.y = element_text(size = 18, hjust = 0.5),
legend.position = "none",
strip.text.x = element_text(size = 18),
strip.text.y = element_text(size = 18),
strip.background = element_rect(colour = "black", fill = "bisque2"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
coord_geo(pos = list("bottom", "bottom"),
dat = list(gsc2, gsc1),
abbrv = list(T, F),
lwd = 0.35,
center_end_labels = TRUE,
height = unit(1, "line"),
size = "auto") +
facet_wrap(~group, ncol = 2)
JI %>%
pivot_longer(cols = keys(tax_dict),
names_to = "group",
values_to = "jaccard") %>%
ggplot(aes(x = age, y = jaccard)) +
scale_x_reverse() +
geom_line() +
labs(x = "Time (Ma)", y = "Jaccard's index") +
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) +
annotate(geom = "text", x = 32, y = 0.45, label = "EOT", size = 5, colour = "red") +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
theme(axis.title = element_text(size = 18),
axis.text.x = element_text(size = 18, vjust = 0.2),
axis.text.y = element_text(size = 18, hjust = 0.5),
legend.position = "none",
strip.text.x = element_text(size = 18),
strip.text.y = element_text(size = 18),
strip.background = element_rect(colour = "black", fill = "bisque2"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
coord_geo(pos = list("bottom", "bottom"),
dat = list(gsc2, gsc1),
abbrv = list(T, F),
lwd = 0.35,
center_end_labels = TRUE,
height = unit(1, "line"),
size = "auto") +
facet_wrap(~group, ncol = 2)
jac_plot <- JI %>%
pivot_longer(cols = keys(tax_dict),
names_to = "group",
values_to = "jaccard") %>%
ggplot(aes(x = age, y = jaccard)) +
scale_x_reverse() +
geom_line() +
labs(x = "Time (Ma)", y = "Jaccard's index") +
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) +
annotate(geom = "text", x = 32, y = 0.45, label = "EOT", size = 5, colour = "red") +
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey50", ymin = -Inf, ymax = Inf, alpha = 0.2, linewidth = 0) +
theme(axis.title = element_text(size = 18),
axis.text.x = element_text(size = 18, vjust = 0.2),
axis.text.y = element_text(size = 18, hjust = 0.5),
legend.position = "none",
strip.text.x = element_text(size = 18),
strip.text.y = element_text(size = 18),
strip.background = element_rect(colour = "black", fill = "bisque2"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
coord_geo(pos = list("bottom", "bottom"),
dat = list(gsc2, gsc1),
abbrv = list(T, F),
lwd = 0.35,
center_end_labels = TRUE,
height = unit(1, "line"),
size = "auto") +
facet_wrap(~group, ncol = 3)
ggsave("./figures/supp_figs/jaccard_through_time", plot = jac_plot, height = 200, width = 300, units = "mm")
ggsave("./figures/supp_figs/jaccard_through_time.png", plot = jac_plot, height = 200, width = 300, units = "mm")
ggsave("./figures/supp_figs/jaccard_through_time.pdf", plot = jac_plot, height = 200, width = 300, units = "mm")
dev.off()
---
title: "The fate of South America's endemic mammal fauna in response to the most dramatic Cenozoic climate disruption"
---
title: "The fate of South America's endemic mammal fauna in response to the most dramatic Cenozoic climate disruption"

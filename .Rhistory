y_limits = c(-0.21, 0.45),
restrict_thr = 0.45,
stage_x_breaks = FALSE,
manual_x_breaks = seq(25, 50, 5),
axes.labelsize=15,
ticks.labelsize = 12,
net_col="#252525",
display_gts = FALSE,
xlim = c(52, 24),
plot.border = FALSE,
x.axis = FALSE,
display_EECO_MECO = TRUE) +
# Temporal bands
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey10", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey10", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey10", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) + # EOT
annotate(geom = "text", x = 31, y = 0.425, label = "EOT", size = 6, colour = "red") +
annotate(geom = "segment", x = 46, xend = 49, y = 0.35, yend = 0.35, colour = "#504A4B", linewidth = 1) +
annotate(geom = "text", x = 41, y = 0.35, label = "Net diversification\n rate", size = 3)
## Combine all these plots and save the output ---------------------------------
p <- comb_ltt_rtt(sp_ex_all_in_one, net_div_all_in_one, ltt.plot, Q_plot, n_plots = 4)
ggsave("./figures/supp_figs/CTA_TAR_redated/RTT_LTT_Q.pdf",
plot = p,
height = 200,
width = 200,
units = "mm")
# q-rates plot
Q_plot <- q_plot(omega,
ltt_tbl,
axes.labelsize = 15,
stage_x_breaks = FALSE,
manual_x_breaks = seq(25, 50, 5),
x_lim = c(52, 24),
several_gts = TRUE,
y_lab = NULL,
geoscale = gsc1_bis,
geoscale2 = gsc2_bis,
geoscale_height = unit(1, "line"),
geoscale_labelsize = 4,
abbr = list(TRUE, FALSE))  +
# Temporal bands
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey10", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey10", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey10", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) + # EOT
annotate(geom = "segment", x = 47, xend = 50, y = 1.1, yend = 1.1, colour = "#260154", linewidth = 1) +
annotate(geom = "text", x = 44, y = 1.1, label = "Preservation\n rate", size = 3)
## Combine all these plots and save the output ---------------------------------
p <- comb_ltt_rtt(sp_ex_all_in_one, net_div_all_in_one, ltt.plot, Q_plot, n_plots = 4)
ggsave("./figures/supp_figs/CTA_TAR_redated/RTT_LTT_Q.pdf",
plot = p,
height = 200,
width = 200,
units = "mm")
# LTT plot
ltt.plot <- ltt_plot(ltt_tbl,
stage_x_breaks = FALSE,
manual_x_breaks = seq(25, 50, 5),
axes.labelsize=15,
ticks.labelsize = 12,
x_lab = "Time (Ma)",
y_lab = NULL,
y_breaks = seq(0,(round(max(ltt_tbl$Diversity), -1) + 10),20),
y_limits = c(40,(round(max(ltt_tbl$Diversity), -1) + 12)),
display_gts = TRUE,
xlim = c(52, 24),
avg_col = "#006d2c",
ribbon_col = "#74c476",
plot.border = FALSE,
x.axis = TRUE,
several_gts = TRUE,
geoscale = gsc1_bis,
geoscale2 = gsc2_bis,
geoscale_height = unit(1, "line"),
geoscale_labelsize = 4,
abbr = list(TRUE, FALSE),
display_EECO_MECO = TRUE) +
# Temporal bands
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey10", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey10", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey10", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) +
annotate(geom = "segment", x = 44.5, xend = 47, y = 115, yend = 115, colour = "#006d2c", linewidth = 1) +
annotate(geom = "text", x = 41.5, y = 115, label = "Diversity", size = 3)
## Preservation (q) rates ------------------------------------------------------
# q-rates table
omega <- read.table("./results_EXTENDED/SALMA_smoothed/genus_level/1bis-Full_CTA_TAR_redated/Q_SHIFTS/Parsed_Q_rates.txt", sep = "\t", header = TRUE)
omega <- omega %>% filter(Age > 23.03 & Age <= 56)
if(56 %in% omega$Age){
omega$Age[which(omega$Age == 56)] <- 52
}
# q-rates plot
Q_plot <- q_plot(omega,
ltt_tbl,
axes.labelsize = 15,
stage_x_breaks = FALSE,
manual_x_breaks = seq(25, 50, 5),
x_lim = c(52, 24),
several_gts = TRUE,
y_lab = NULL,
geoscale = gsc1_bis,
geoscale2 = gsc2_bis,
geoscale_height = unit(1, "line"),
geoscale_labelsize = 4,
abbr = list(TRUE, FALSE))  +
# Temporal bands
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey10", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey10", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey10", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) + # EOT
annotate(geom = "segment", x = 47, xend = 50, y = 1.1, yend = 1.1, colour = "#260154", linewidth = 1) +
annotate(geom = "text", x = 44, y = 1.1, label = "Preservation\n rate", size = 3)
## Combine all these plots and save the output ---------------------------------
p <- comb_ltt_rtt(sp_ex_all_in_one, net_div_all_in_one, ltt.plot, Q_plot, n_plots = 4)
ggsave("./figures/supp_figs/CTA_TAR_redated/RTT_LTT_Q.pdf",
plot = p,
height = 200,
width = 200,
units = "mm")
# q-rates plot
Q_plot <- q_plot(omega,
ltt_tbl,
axes.labelsize = 15,
ticks.labelsize = 12,
stage_x_breaks = FALSE,
manual_x_breaks = seq(25, 50, 5),
x_lim = c(52, 24),
several_gts = TRUE,
y_lab = NULL,
geoscale = gsc1_bis,
geoscale2 = gsc2_bis,
geoscale_height = unit(1, "line"),
geoscale_labelsize = 4,
abbr = list(TRUE, FALSE))  +
# Temporal bands
annotate(geom = "rect", xmin = 47.8, xmax = Inf, fill = "grey10", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
annotate(geom = "rect", xmin = 33.9, xmax = 37.71, fill = "grey10", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
annotate(geom = "rect", xmin = -Inf, xmax = 27.8, fill = "grey10", ymin = -Inf, ymax = Inf, alpha = 0.1, linewidth = 0) +
geom_vline(xintercept = 33.9, linetype="dashed", color = "red", linewidth = 0.8) + # EOT
annotate(geom = "segment", x = 47, xend = 50, y = 1.1, yend = 1.1, colour = "#260154", linewidth = 1) +
annotate(geom = "text", x = 44, y = 1.1, label = "Preservation\n rate", size = 3)
## Combine all these plots and save the output ---------------------------------
p <- comb_ltt_rtt(sp_ex_all_in_one, net_div_all_in_one, ltt.plot, Q_plot, n_plots = 4)
ggsave("./figures/supp_figs/CTA_TAR_redated/RTT_LTT_Q.pdf",
plot = p,
height = 200,
width = 200,
units = "mm")
################################################################################
# Title: 7-Process_envt_correlates.R
# Author: Lucas Buffan
# Date: 2024-03-28
# Aim: Process environmental correlates for MBD.
################################################################################
library(tidyverse)
source("./R/useful/helper_functions.R")
## Plant diversity (from Jaramillo et al. (2006)) --------------------------------------------------------------------
plant_raw <- read.table("./data_2023/MBD/raw_environment_correlates/Cnz_Plant_diversity_Jaramillo_2006.txt", header = TRUE)
selected_indices <- sapply(X = seq(from = 23, to = 56, by = 0.5),
FUN = select_closer,
age_vect = plant_raw$Age)
plant_processed <- data.frame(Age = seq(from = 23, to = 56, by = 0.5),
Plant_diversity = plant_raw$Div[selected_indices])
### Verification ###
# par(mfrow = c(1,2))
# plot(x = plant_processed$Age, plant_processed$Plant_diversity, xlim = c(15, 90))
# plot(x = plant_raw$Age, y = plant_raw$Div)
# # Full dataset
# write.table.lucas(x = plant_processed,
#                   file = "./data_2023/MBD/processed_predictors_full/1-Plant_Diversity_Eoc_Olig_500ky_step.txt")
# # post_EECO dataset
# write.table.lucas(x = plant_processed %>% filter(Age <= 51 & Age >= 34),
#                   file = "./data_2023/MBD/processed_predictors_post_EECO/1-Plant_Diversity_post_EECO_500ky_step.txt")
# # Oligocene dataset
# write.table.lucas(x = plant_processed %>% filter(Age <= 34 & Age >= 23),
#                   file = "./data_2023/MBD/processed_predictors_Oligocene_only/1-Plant_Diversity_Oligocene_only_500ky_step.txt")
## Andean Uplift (from Boschman (2021)) -----------------------------------------------------------------------------
Uplift <- read.table("./data_2023/MBD/raw_environment_correlates/andean_uplift/Andes_mean_elevations_no_basins_ALL.txt",
sep = " ",
header = TRUE)
#Write and save a dataset of the covariate with a 100ky time step
average_elevation <- data.frame(Age = 0:66,
Altitude = sapply(X = 0:66, FUN = function(x){return(mean(Uplift$Altitude[which(Uplift$Age == x)]))}))
interpol_av_el <- approx(x = average_elevation$Age[1:2], y = average_elevation$Altitude[1:2], n=3)$y
for(i in 2:66){
interpol_av_el <- c(interpol_av_el,
approx(x = average_elevation$Age[i:(i+1)], y = average_elevation$Altitude[i:(i+1)], n=3)$y[-c(1)])
}
### Verification ###
# par(mfrow = c(1,2))
# plot(x = average_elevation$Age, y = average_elevation$Altitude)
# title("Original data")
# plot(x = seq(from = 0, to = 66, by = 0.5), y = interpol_av_el)
# title("Interpolated data")
Andes <- data.frame(Age = seq(from = 0, to = 66, by = 0.5),
Altitude = interpol_av_el)
# # Full dataset
# write.table.lucas(Andes %>% filter(Age >= 23 & Age <= 56),
#                   file = "./data_2023/MBD/processed_predictors_full/2-Andes_mean_elevations_Eoc_Olig_500ky_step.txt")
# # post_EECO dataset
# write.table.lucas(x = Andes %>% filter(Age <= 51 & Age >= 34),
#                   file = "./data_2023/MBD/processed_predictors_post_EECO/2-Andes_mean_elevations_post_EECO_500ky_step.txt")
# # Oligocene dataset
# write.table.lucas(x = Andes %>% filter(Age <= 34 & Age >= 23),
#                   file = "./data_2023/MBD/processed_predictors_Oligocene_only/2-Andes_mean_elevations_Oligocene_only_500ky_step.txt")
#
## Palaeotemperature (assembled by Boschman and Condamine 2022 using Cenozoic data from Westerhold et al. 2020) ----------------
Temp_Cnz <- read.table("./data_2023/MBD/raw_environment_correlates/palaeotemperature/merged_veizer_westerhold_Ts.txt",
sep = "\t",
header = TRUE)
Temp_Cnz <- Temp_Cnz[which(Temp_Cnz$Age <= 66), ]
#Write and save a dataset of the covariate with a 500ky time step
selected_indices <- sapply(X = seq(from = 0, to = 66, by = 0.5), FUN = select_closer, age_vect = Temp_Cnz$Age)
Temp_Cnz1 <- Temp_Cnz[selected_indices, ]
Temp_Cnz1$Age <- sapply(X = Temp_Cnz1$Age, FUN = round, digits = 1)
### Verification ###
# par(mfrow = c(1,2))
# plot(x = Temp_Cnz$Age, y = Temp_Cnz$Temperature)
# title("Original data")
# plot(x = Temp_Cnz1$Age, y = Temp_Cnz1$Temperature)
# title("Subsampled data")
# # Full dataset
# write.table.lucas(Temp_Cnz1 %>% filter(Age >= 23 & Age <= 56),
#                   file = "./data_2023/MBD/processed_predictors_full/3-Temperature_Eoc_Olig_500ky_step.txt")
# # post_EECO dataset
# write.table.lucas(x = Temp_Cnz1 %>% filter(Age <= 51 & Age >= 34),
#                   file = "./data_2023/MBD/processed_predictors_post_EECO/3-Temperature_post_EECO_500ky_step.txt")
# # Oligocene dataset
# write.table.lucas(x = Temp_Cnz1 %>% filter(Age <= 34 & Age >= 23),
#                   file = "./data_2023/MBD/processed_predictors_Oligocene_only/3-Temperature_Oligocene_only_500ky_step.txt")
## Global sea level (from Miller et al. 2020) -----------------------------------------------------------------------------------
sea_lvl <- read.table("./data_2023/MBD/raw_environment_correlates/sea_level/Miller_2020_sea_level_data.txt",
sep = "\t",
header = TRUE)
sea_lvl <- sea_lvl %>%
mutate(age_calkaBP = sapply(X = sea_lvl$age_calkaBP, FUN = function(x){x/1000})) %>%
rename(age_MaBP = "age_calkaBP")
selected_indices <- sapply(X = seq(from = 0, to = 66, by = 0.5), FUN = select_closer, age_vect = sea_lvl$age_MaBP)
#there are some intervals with lacks
ages <- sapply(X = sea_lvl$age_MaBP[selected_indices], FUN = round, digits = 1)
sel_sea_lvl <- sea_lvl$sealevel[selected_indices]
udc <- ages[which(ages %in% seq(0,66,0.5) == FALSE)]
to_add <- seq(0,66,0.5)[which(seq(0,66,0.5) %in% ages == FALSE)]
# replace udc by to_add
ages[which(ages %in% udc)] <- to_add
# dataframe
slvl <- data.frame(Age = ages,
Sea_level = sel_sea_lvl)
### Verification ###
# par(mfrow = c(1,2))
# plot(x = sea_lvl$age_MaBP, y = sea_lvl$sealevel)
# title("Original data")
# plot(x = slvl$Age, y = slvl$Sea_level)
# title("Scaled data")
# # Full dataset
# write.table.lucas(x = slvl %>% filter(Age >= 23 & Age <= 56),
#                   file = "./data_2023/MBD/processed_predictors_full/4-sea_level_Eoc_Olig_500ky_step.txt")
# # post_EECO dataset
# write.table.lucas(x = slvl %>% filter(Age <= 51 & Age >= 34),
#                   file = "./data_2023/MBD/processed_predictors_post_EECO/4-sea_level_post_EECO_500ky_step.txt")
# # Oligocene dataset
# write.table.lucas(x = slvl %>% filter(Age <= 34 & Age >= 23),
#                   file = "./data_2023/MBD/processed_predictors_Oligocene_only/4-sea_level_Oligocene_only_500ky_step.txt")
#
## Temporal patterns on the relative abundance of open habitats in Patagonia (Solórzano et Nuñez 2021 from Strömberg et al. 2013) ------------
p_open <- read_xlsx("./data_2023/MBD/raw_environment_correlates/vegetation_openness.xlsx")
################################################################################
# Title: 7-Process_envt_correlates.R
# Author: Lucas Buffan
# Date: 2024-03-28
# Aim: Process environmental correlates for MBD.
################################################################################
library(tidyverse)
library(readxl)
source("./R/useful/helper_functions.R")
## Plant diversity (from Jaramillo et al. (2006)) --------------------------------------------------------------------
plant_raw <- read.table("./data_2023/MBD/raw_environment_correlates/Cnz_Plant_diversity_Jaramillo_2006.txt", header = TRUE)
selected_indices <- sapply(X = seq(from = 23, to = 56, by = 0.5),
FUN = select_closer,
age_vect = plant_raw$Age)
plant_processed <- data.frame(Age = seq(from = 23, to = 56, by = 0.5),
Plant_diversity = plant_raw$Div[selected_indices])
### Verification ###
# par(mfrow = c(1,2))
# plot(x = plant_processed$Age, plant_processed$Plant_diversity, xlim = c(15, 90))
# plot(x = plant_raw$Age, y = plant_raw$Div)
# # Full dataset
# write.table.lucas(x = plant_processed,
#                   file = "./data_2023/MBD/processed_predictors_full/1-Plant_Diversity_Eoc_Olig_500ky_step.txt")
# # post_EECO dataset
# write.table.lucas(x = plant_processed %>% filter(Age <= 51 & Age >= 34),
#                   file = "./data_2023/MBD/processed_predictors_post_EECO/1-Plant_Diversity_post_EECO_500ky_step.txt")
# # Oligocene dataset
# write.table.lucas(x = plant_processed %>% filter(Age <= 34 & Age >= 23),
#                   file = "./data_2023/MBD/processed_predictors_Oligocene_only/1-Plant_Diversity_Oligocene_only_500ky_step.txt")
## Andean Uplift (from Boschman (2021)) -----------------------------------------------------------------------------
Uplift <- read.table("./data_2023/MBD/raw_environment_correlates/andean_uplift/Andes_mean_elevations_no_basins_ALL.txt",
sep = " ",
header = TRUE)
#Write and save a dataset of the covariate with a 100ky time step
average_elevation <- data.frame(Age = 0:66,
Altitude = sapply(X = 0:66, FUN = function(x){return(mean(Uplift$Altitude[which(Uplift$Age == x)]))}))
interpol_av_el <- approx(x = average_elevation$Age[1:2], y = average_elevation$Altitude[1:2], n=3)$y
for(i in 2:66){
interpol_av_el <- c(interpol_av_el,
approx(x = average_elevation$Age[i:(i+1)], y = average_elevation$Altitude[i:(i+1)], n=3)$y[-c(1)])
}
### Verification ###
# par(mfrow = c(1,2))
# plot(x = average_elevation$Age, y = average_elevation$Altitude)
# title("Original data")
# plot(x = seq(from = 0, to = 66, by = 0.5), y = interpol_av_el)
# title("Interpolated data")
Andes <- data.frame(Age = seq(from = 0, to = 66, by = 0.5),
Altitude = interpol_av_el)
# # Full dataset
# write.table.lucas(Andes %>% filter(Age >= 23 & Age <= 56),
#                   file = "./data_2023/MBD/processed_predictors_full/2-Andes_mean_elevations_Eoc_Olig_500ky_step.txt")
# # post_EECO dataset
# write.table.lucas(x = Andes %>% filter(Age <= 51 & Age >= 34),
#                   file = "./data_2023/MBD/processed_predictors_post_EECO/2-Andes_mean_elevations_post_EECO_500ky_step.txt")
# # Oligocene dataset
# write.table.lucas(x = Andes %>% filter(Age <= 34 & Age >= 23),
#                   file = "./data_2023/MBD/processed_predictors_Oligocene_only/2-Andes_mean_elevations_Oligocene_only_500ky_step.txt")
#
## Palaeotemperature (assembled by Boschman and Condamine 2022 using Cenozoic data from Westerhold et al. 2020) ----------------
Temp_Cnz <- read.table("./data_2023/MBD/raw_environment_correlates/palaeotemperature/merged_veizer_westerhold_Ts.txt",
sep = "\t",
header = TRUE)
Temp_Cnz <- Temp_Cnz[which(Temp_Cnz$Age <= 66), ]
#Write and save a dataset of the covariate with a 500ky time step
selected_indices <- sapply(X = seq(from = 0, to = 66, by = 0.5), FUN = select_closer, age_vect = Temp_Cnz$Age)
Temp_Cnz1 <- Temp_Cnz[selected_indices, ]
Temp_Cnz1$Age <- sapply(X = Temp_Cnz1$Age, FUN = round, digits = 1)
### Verification ###
# par(mfrow = c(1,2))
# plot(x = Temp_Cnz$Age, y = Temp_Cnz$Temperature)
# title("Original data")
# plot(x = Temp_Cnz1$Age, y = Temp_Cnz1$Temperature)
# title("Subsampled data")
# # Full dataset
# write.table.lucas(Temp_Cnz1 %>% filter(Age >= 23 & Age <= 56),
#                   file = "./data_2023/MBD/processed_predictors_full/3-Temperature_Eoc_Olig_500ky_step.txt")
# # post_EECO dataset
# write.table.lucas(x = Temp_Cnz1 %>% filter(Age <= 51 & Age >= 34),
#                   file = "./data_2023/MBD/processed_predictors_post_EECO/3-Temperature_post_EECO_500ky_step.txt")
# # Oligocene dataset
# write.table.lucas(x = Temp_Cnz1 %>% filter(Age <= 34 & Age >= 23),
#                   file = "./data_2023/MBD/processed_predictors_Oligocene_only/3-Temperature_Oligocene_only_500ky_step.txt")
## Global sea level (from Miller et al. 2020) -----------------------------------------------------------------------------------
sea_lvl <- read.table("./data_2023/MBD/raw_environment_correlates/sea_level/Miller_2020_sea_level_data.txt",
sep = "\t",
header = TRUE)
sea_lvl <- sea_lvl %>%
mutate(age_calkaBP = sapply(X = sea_lvl$age_calkaBP, FUN = function(x){x/1000})) %>%
rename(age_MaBP = "age_calkaBP")
selected_indices <- sapply(X = seq(from = 0, to = 66, by = 0.5), FUN = select_closer, age_vect = sea_lvl$age_MaBP)
#there are some intervals with lacks
ages <- sapply(X = sea_lvl$age_MaBP[selected_indices], FUN = round, digits = 1)
sel_sea_lvl <- sea_lvl$sealevel[selected_indices]
udc <- ages[which(ages %in% seq(0,66,0.5) == FALSE)]
to_add <- seq(0,66,0.5)[which(seq(0,66,0.5) %in% ages == FALSE)]
# replace udc by to_add
ages[which(ages %in% udc)] <- to_add
# dataframe
slvl <- data.frame(Age = ages,
Sea_level = sel_sea_lvl)
### Verification ###
# par(mfrow = c(1,2))
# plot(x = sea_lvl$age_MaBP, y = sea_lvl$sealevel)
# title("Original data")
# plot(x = slvl$Age, y = slvl$Sea_level)
# title("Scaled data")
# # Full dataset
# write.table.lucas(x = slvl %>% filter(Age >= 23 & Age <= 56),
#                   file = "./data_2023/MBD/processed_predictors_full/4-sea_level_Eoc_Olig_500ky_step.txt")
# # post_EECO dataset
# write.table.lucas(x = slvl %>% filter(Age <= 51 & Age >= 34),
#                   file = "./data_2023/MBD/processed_predictors_post_EECO/4-sea_level_post_EECO_500ky_step.txt")
# # Oligocene dataset
# write.table.lucas(x = slvl %>% filter(Age <= 34 & Age >= 23),
#                   file = "./data_2023/MBD/processed_predictors_Oligocene_only/4-sea_level_Oligocene_only_500ky_step.txt")
#
## Temporal patterns on the relative abundance of open habitats in Patagonia (Solórzano et Nuñez 2021 from Strömberg et al. 2013) ------------
p_open <- read_xlsx("./data_2023/MBD/raw_environment_correlates/vegetation_openness.xlsx")
interpol_op <- approx(x = p_open$Age[1:2], y = p_open$P_open[1:2], n=3)$y
for(i in 2:49){
interpol_op <- c(interpol_op,
approx(x = p_open$Age[i:(i+1)], y = p_open$P_open[i:(i+1)], n=3)$y[-c(1)])
}
p_op_int <- data.frame(Age = seq(0, 49, 0.5),
P_open = interpol_op)
# Full dataset
# write.table.lucas(x = p_op_int %>% filter(Age >= 23 & Age <= 56),
#                   file = "./data_2023/MBD/processed_predictors_full/5-habitat_openness_Eoc_Olig_500ky.txt")
# # post_EECO dataset
# write.table.lucas(x = p_op_int %>% filter(Age <= 51 & Age >= 34),
#                   file = "./data_2023/MBD/processed_predictors_post_EECO/5-habitat_openness_post_EECO_500ky.txt")
# # Oligocene dataset
# write.table.lucas(x = p_op_int %>% filter(Age <= 34 & Age >= 23),
#                   file = "./data_2023/MBD/processed_predictors_Oligocene_only/5-habitat_openness_Oligocene_only_500ky.txt")
## Relative Leaf Area Index (Dunn et al. 2015) -----------------------------------------------------------------------
rLAI <- read_xlsx("./data_2023/MBD/raw_environment_correlates/rLAI.xlsx")
interpol_rlai <- approx(x = rLAI$Age[1:2], y = rLAI$rLAI[1:2], n=3)$y
for(i in 2:38){
interpol_rlai <- c(interpol_rlai,
approx(x = rLAI$Age[i:(i+1)], y = rLAI$rLAI[i:(i+1)], n=3)$y[-c(1)])
}
rlai_int <- data.frame(Age = seq(11, 49, 0.5),
rLAI = interpol_rlai)
# Full dataset
#write.table.lucas(x = rlai_int %>% filter(Age >= 23 & Age <= 56),
#                  file = "./data_2023/MBD/processed_predictors_full/6-rLAI_Eoc_Olig.txt")
# post_EECO dataset
#write.table.lucas(x = rlai_int %>% filter(Age <= 51 & Age >= 34),
#                  file = "./data_2023/MBD/processed_predictors_post_EECO/6-rLAI_post_EECO.txt")
# Oligocene dataset
#write.table.lucas(x = rlai_int %>% filter(Age <= 34 & Age >= 23),
#                  file = "./data_2023/MBD/processed_predictors_Oligocene_only/6-rLAI_Oligocene_only.txt")
par(mfrow = c(2, 2))
# Plants
plot(x = plant_raw$Age, y = plant_raw$Div, main = "Raw plant diversity")
plot(x = plant_processed$Age, plant_processed$Plant_diversity, xlim = c(15, 90), main = "Interpolated plant diversity")
# Andean uplift
plot(x = average_elevation$Age, y = average_elevation$Altitude)
title("Original data")
plot(x = seq(from = 0, to = 66, by = 0.5), y = interpol_av_el)
title("Interpolated data")
ggplot(plant_processed, aes(x = Age, y = Plant_diversity)) +
geom_line() +
scale_x_reverse()
ggplot(plant_processed, aes(x = Age, y = Plant_diversity)) +
geom_line() +
scale_x_reverse() +
theme_minimal() +
labs(x = "Time (Ma)", y = "Plant Diversity")
coord_geo(dat = "epochs")
theme_lucas <- function(...){
theme(panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_text(size = 12),
plot.title = element_text(size = 15),
...)
}
ggplot(plant_processed, aes(x = Age, y = Plant_diversity)) +
geom_line() +
scale_x_reverse() +
theme_lucas() +
labs(x = "Time (Ma)", y = "Plant Diversity") +
coord_geo(dat = "epochs")
library(ggplot2)
library(deeptime)
theme_lucas <- function(...){
theme(panel.grid = element_blank(),
panel.background = element_blank(),
axis.text = element_text(size = 12),
plot.title = element_text(size = 15),
...)
}
ggplot(plant_processed, aes(x = Age, y = Plant_diversity)) +
geom_line() +
scale_x_reverse() +
theme_lucas() +
labs(x = "Time (Ma)", y = "Plant Diversity") +
coord_geo(dat = "epochs")
ggplot(plant_processed, aes(x = Age, y = Plant_diversity)) +
geom_line() +
scale_x_reverse() +
theme_lucas() +
labs(x = "Time (Ma)", y = "Plant Diversity") +
coord_geo(dat = "epochs", abbr = FALSE)
ggplot(plant_processed, aes(x = Age, y = Plant_diversity)) +
geom_line(size = 2, face = "chartreuse") +
scale_x_reverse() +
theme_lucas() +
labs(x = "Time (Ma)", y = "Plant Diversity") +
coord_geo(dat = "epochs", abbr = FALSE)
ggplot(plant_processed, aes(x = Age, y = Plant_diversity)) +
geom_line(size = 2, colour = "chartreuse") +
scale_x_reverse() +
theme_lucas() +
labs(x = "Time (Ma)", y = "Plant Diversity") +
coord_geo(dat = "epochs", abbr = FALSE)
theme_lucas <- function(...){
theme(panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(size = 1)
axis.text = element_text(size = 12),
theme_lucas <- function(...){
theme(panel.grid = element_blank(),
panel.background = element_blank(),
axis.line = element_line(size = 1),
axis.text = element_text(size = 12),
plot.title = element_text(size = 15),
...)
}
# Plants
plants <- ggplot(plant_processed, aes(x = Age, y = Plant_diversity)) +
geom_line(linewidth = 2, colour = "chartreuse") +
scale_x_reverse() +
theme_lucas() +
labs(x = "Time (Ma)", y = "Plant Diversity") +
coord_geo(dat = "epochs", abbr = FALSE)
ggplot(plant_processed, aes(x = Age, y = Plant_diversity)) +
geom_line(linewidth = 2, colour = "chartreuse") +
scale_x_reverse() +
theme_lucas() +
labs(x = "Time (Ma)", y = "Plant Diversity") +
coord_geo(dat = "epochs", abbr = FALSE)
rm(list = ls())
dev.off()

library(dplyr)
for(salma in c("SALMA_kept", "SALMA_smoothed")){
for(lvl in c("species_level", "genus_level")){
if(salma=="SALMA_smoothed" & lvl="species_level"){
for(salma in c("SALMA_kept", "SALMA_smoothed")){
for(lvl in c("species_level", "genus_level")){
if(salma=="SALMA_smoothed" & lvl=="species_level"){
next
}
#SALMA TPP
recap_SALMA <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/SALMA/tab_2.tsb", sep = ";", stringsAsFactors = TRUE)
mean_AICc_TPP_salma <- mean(recap_SALMA$TPP, na.rm = TRUE)
#stages TPP
recap_stages <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/stages/tab_1.tsb", sep = ";", stringsAsFactors = TRUE)
mean_AICc_TPP_stages <- mean(recap_stages$TPP, na.rm = TRUE)
if(mean_AICc_TPP_salma > mean_AICc_TPP_stages){
Winner <- "stages"
}
else{
Winner <- "SALMA"
}
cat("Retained TPP for", salma, "at the", lvl, ":", Winner)
}
}
setwd("/media/lucas/SAMSUNG/PhD_Chap1/Neotropical_Mammals/REPO/Neotropical_mammals")
for(salma in c("SALMA_kept", "SALMA_smoothed")){
for(lvl in c("species_level", "genus_level")){
if(salma=="SALMA_smoothed" & lvl=="species_level"){
next
}
#SALMA TPP
recap_SALMA <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/SALMA/tab_2.tsb", sep = ";", stringsAsFactors = TRUE)
mean_AICc_TPP_salma <- mean(recap_SALMA$TPP, na.rm = TRUE)
#stages TPP
recap_stages <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/stages/tab_1.tsb", sep = ";", stringsAsFactors = TRUE)
mean_AICc_TPP_stages <- mean(recap_stages$TPP, na.rm = TRUE)
if(mean_AICc_TPP_salma > mean_AICc_TPP_stages){
Winner <- "stages"
}
else{
Winner <- "SALMA"
}
cat("Retained TPP for", salma, "at the", lvl, ":", Winner)
}
}
for(salma in c("SALMA_kept", "SALMA_smoothed")){
for(lvl in c("species_level", "genus_level")){
if(salma=="SALMA_smoothed" & lvl=="species_level"){
next
}
#SALMA TPP
recap_SALMA <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/SALMA/tab_2.tsb", sep = ";", stringsAsFactors = TRUE)
mean_AICc_TPP_salma <- mean(recap_SALMA$TPP, na.rm = TRUE)
#stages TPP
recap_stages <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/stages/tab_1.tsb", sep = ";", stringsAsFactors = TRUE)
mean_AICc_TPP_stages <- mean(recap_stages$TPP, na.rm = TRUE)
if(mean_AICc_TPP_salma > mean_AICc_TPP_stages){
Winner <- "stages"
}
else{
Winner <- "SALMA"
}
cat("Retained TPP for", salma, "at the", lvl, ":", Winner"\n")
for(salma in c("SALMA_kept", "SALMA_smoothed")){
for(lvl in c("species_level", "genus_level")){
if(salma=="SALMA_smoothed" & lvl=="species_level"){
next
}
#SALMA TPP
recap_SALMA <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/SALMA/tab_2.tsb", sep = ";", stringsAsFactors = TRUE)
mean_AICc_TPP_salma <- mean(recap_SALMA$TPP, na.rm = TRUE)
#stages TPP
recap_stages <- read.csv("./results/SALMA_kept/genus_level/PPmodeltest/stages/tab_1.tsb", sep = ";", stringsAsFactors = TRUE)
mean_AICc_TPP_stages <- mean(recap_stages$TPP, na.rm = TRUE)
if(mean_AICc_TPP_salma > mean_AICc_TPP_stages){
Winner <- "stages"
}
else{
Winner <- "SALMA"
}
cat("Retained TPP for", salma, "at the", lvl, ":", Winner,"\n")
}
}
library(sf)
library(ggplot2)
library(tidyverse)
library(spData)
soa <- data("world")
soa <- data("world") %>% filter(continent == "South America")
soa <- soa %>% filter(continent == "South America")
soa <- data("world")
soa <- soa %>% filter(continent == "South America")
occdf <- readRDS("./data_2023/SPECIES_LISTS/5-Fully_cleaned_EOT_SA_Mammals_SALMA_kept_Tropics_Diet.RDS")
world <- data("world")
rm(soa)
world <- data("world")
world
library(spData)
world <- data("world")
library(geobr)
world <- data("world")
world %>%
ggplot() +
geom_sf()
library(sf)
library(spData)
library(ggplot2)
library(tidyverse)
library(geobr)
world <- data("world")
library(reaxl)
library(readxl)
SALMA <- read_xlsx("./data_2023/time_bins/SALMA_EOT.xlsx")
View(SALMA)
deeptime::periods
SALMA <- read_xlsx("./data_2023/time_bins/SALMA_EOT.xlsx")
View(SALMA)
?runif
SALMA <- read_xlsx("./data_2023/time_bins/SALMA_EOT.xlsx")
View(SALMA)
SALMA <- read_xlsx("./data_2023/time_bins/SALMA_EOT.xlsx")
library(dplyr)
SALMA <- SALMA %>% rename(min_ma = "min_age")
SALMA <- SALMA %>% rename(min_age = "min_ma")
SALMA <- read_xlsx("./data_2023/time_bins/SALMA_EOT.xlsx")
SALMA <- SALMA %>% rename(min_age = "min_ma", max_age = "max_ma", interval_name = "name")
SALMA <- read_xlsx("./data_2023/time_bins/SALMA_EOT.xlsx")
SALMA <- SALMA %>% rename(min_age = "min_ma", max_age = "max_ma", name = "interval_name")
library(ggplot2)
ggplot() +
geom_point(aes(y = runif(1000, 1, 8), x = runif(1000, 23.03, 56))) +
scale_x_reverse(breaks = c(23.03, 27.82, 33.9, 37.8, 41.2, 47.8, 56)) +
coord_geo(pos = list("bottom", "bottom"), dat = list(SALMA, deeptime::epochs)) +
theme_classic()
library(deeptime)
ggplot() +
geom_point(aes(y = runif(1000, 1, 8), x = runif(1000, 23.03, 56))) +
scale_x_reverse(breaks = c(23.03, 27.82, 33.9, 37.8, 41.2, 47.8, 56)) +
coord_geo(pos = list("bottom", "bottom"), dat = list(SALMA, deeptime::epochs)) +
theme_classic()
library(deeptime)
library(readxl)
library(dplyr)
library(ggplot2)
SALMA <- read_xlsx("./data_2023/time_bins/SALMA_EOT.xlsx")
SALMA <- SALMA %>% rename(min_age = "min_ma", max_age = "max_ma", name = "interval_name")
ggplot() +
geom_point(aes(y = runif(1000, 1, 8), x = runif(1000, 23.03, 56))) +
scale_x_reverse(breaks = c(23.03, 27.82, 33.9, 37.8, 41.2, 47.8, 56)) +
coord_geo(pos = list("bottom", "bottom"), dat = list(SALMA, deeptime::epochs)) +
theme_classic()
ggplot() +
geom_point(aes(y = runif(1000, 1, 8), x = runif(1000, 23.03, 56))) +
scale_x_reverse(breaks = c(23.03, 27.82, 33.9, 37.8, 41.2, 47.8, 56)) +
coord_geo(pos = list("bottom", "bottom"), dat = list(SALMA, deeptime::epochs), abbrv = c(TRUE, FALSE)) +
theme_classic()
ggplot() +
geom_point(aes(y = runif(1000, 1, 8), x = runif(1000, 23.03, 56))) +
scale_x_reverse(breaks = c(23.03, 27.82, 33.9, 37.8, 41.2, 47.8, 56)) +
coord_geo(pos = list("bottom", "bottom"), dat = list(SALMA, deeptime::epochs), abbrv = list(TRUE, FALSE)) +
theme_classic()
SALMA <- read_xlsx("./data_2023/time_bins/SALMA_EOT.xlsx")
SALMA <- SALMA %>% rename(min_age = "min_ma", max_age = "max_ma", name = "interval_name")
ggplot() +
geom_point(aes(y = runif(1000, 1, 8), x = runif(1000, 23.03, 56))) +
scale_x_reverse(breaks = c(23.03, 27.82, 33.9, 37.8, 41.2, 47.8, 56)) +
coord_geo(pos = list("bottom", "bottom"), dat = list(SALMA, deeptime::epochs), abbrv = list(TRUE, FALSE)) +
theme_classic()
p <- ggplot() +
geom_point(aes(y = runif(1000, 1, 8), x = runif(1000, 23.03, 56))) +
scale_x_reverse(breaks = c(23.03, 27.82, 33.9, 37.8, 41.2, 47.8, 56)) +
ylim(c(0, 8)) +
coord_geo(pos = list("bottom", "bottom"), dat = list(SALMA, deeptime::epochs), abbrv = list(TRUE, FALSE)) +
theme_classic()
ggsave("./figures/methods_figure/for_SALMA_scale.png", plot = p, dpi = 600, width = 300, height = 100)
ggsave("./figures/methods_figure/for_SALMA_scale.png", plot = p, dpi = 600, width = 300, height = 100, units = "cm")
ggsave("./figures/methods_figure/for_SALMA_scale.png", plot = p, dpi = 60, width = 30, height = 10)
ggsave("./figures/methods_figure/for_SALMA_scale.png", plot = p, dpi = 60, width = 6, height = 2)
ggsave("./figures/methods_figure/for_SALMA_scale.png", plot = p, dpi = 60, width = 12, height = 6)
ggsave("./figures/methods_figure/for_SALMA_scale.png", plot = p, dpi = 600, width = 12, height = 6)
ggsave("./figures/methods_figure/for_SALMA_scale.pdf", plot = p)
ggsave("./figures/methods_figure/for_SALMA_scale.pdf", plot = p, width = 12, height = 6)
libarary("dplyr")
library("readxl")
library("hash")
library("DDD")
SALMA <- read_xlsx("./data_2023/time_bins/SALMA_EOT.xlsx")
SALMA %>% rename(min_age = "min_ma", max_age = "max_ma", name = "Interval_name")
library("dplyr")
SALMA %>% rename(min_age = "min_ma", max_age = "max_ma", name = "Interval_name")
SALMA %>% rename(min_age = "min_ma", max_age = "max_ma", name = "interval_name")
SALMA <- SALMA %>% rename(min_age = "min_ma", max_age = "max_ma", name = "interval_name")
View(SALMA)
source("../CorsaiR/R/1-extract_param_from_PyRate_outputs.R")
source("../CorsaiR/R/2-plotting_facilities.R")
rtt_all_in_one <- extract_rtt("results/SALMA_kept/genus_level/1-Full/combined_logs/RTT_plots.r")
rtt_all_in_one <- extract_rtt("results/SALMA_kept/genus_level/1-Full/combined_logs/RTT_plots.r", ana = "RJMCMC")
rtt_plot(data = rtt_all_in_one,
type = "SpEx",
several_gts = TRUE,
geoscale2 = SALMA,
abbr = list(TRUE, FALSE))
rtt_plot(data = rtt_all_in_one,
type = "net",
several_gts = TRUE,
geoscale2 = SALMA,
abbr = list(TRUE, FALSE))
ltt_df <- extract_ltt("./results/SALMA_kept/genus_level/1-Full/LTT/per_replicate/")
ltt_plot(ltt_df,
y_breaks = seq(0,(round(max(ltt_df$Diversity), -1) + 10),30),
y_limits = c(0,(round(max(ltt_df$Diversity), -1) + 20)),
several_gts = TRUE,
geoscale2 = SALMA,
abbr = list(TRUE, FALSE))
omega <- read.table("./results/SALMA_kept/genus_level/1-Full/Q_SHIFTS/Parsed_Q_rates.csv")
omega <- read.table("./results/SALMA_kept/genus_level/1-Full/Q_SHIFTS/Parsed_Q_rates.csv", header = TRUE)
q_plot(omega,
ltt_df,
several_gts = TRUE,
geoscale2 = SALMA,
abbr = list(TRUE, FALSE))
rm(list = ls())
dev.off()
raw <- read.csv("./data_2023/SPECIES_LISTS/1-Raw_Cnz_SA_Mammals.csv", header = TRUE)
rm(raw)
mtc <- readRDS("./data_2023/SPECIES_LISTS/2-Matched_Uncleaned_Cnz_SA_Mammals.RDS")
mtc <- readRDS("./data_2023/SPECIES_LISTS/3-Fully_cleaned_Cnz_SA_mammals_SALMA_kept_Tropics_Diet.RDS")
mtc <- readRDS("./data_2023/SPECIES_LISTS/5-Fully_cleaned_EOT_SA_Mammals_SALMA_kept_Tropics_Diet.RDS")
rm(mtc)

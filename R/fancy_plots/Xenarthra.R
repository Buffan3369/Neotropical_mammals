################################################################################
###################### Plotting Xenarthra RTT and LTT ##########################
################################################################################

library(ggplot2)
library(deeptime)

## Pilosa ----------------------------------------------------------------------
time <- c(-0.144217315, -0.43265194500000004,-0.7210865750000001,-1.009521205,-1.2979558350000002,-1.586390465,-1.8748250949999998,-2.163259725,-2.4516943550000003,-2.740128985,-3.028563615,-3.316998245,-3.6054328750000004,-3.893867505,-4.1823021350000005,-4.470736765000001,-4.759171395000001,-5.047606025000001,-5.336040655000001,-5.624475285000001,-5.912909915000001,-6.201344545,-6.489779175000001,-6.778213805000001,-7.066648435000001,-7.355083065000001,-7.643517695000001,-7.931952325,-8.220386955,-8.508821585,-8.797256215,-9.085690845,-9.374125475,-9.662560105,-9.950994735,-10.239429365000001,-10.527863995,-10.816298625,-11.104733255000001,-11.393167885,-11.681602515,-11.970037145000001,-12.258471775,-12.546906405,-12.835341035,-13.123775665,-13.412210295000001,-13.700644925,-13.989079555,-14.277514185000001,-14.565948815,-14.854383445000002,-15.142818075000001,-15.431252705,-15.719687335000001,-16.008121965,-16.296556595000002,-16.584991225000003,-16.873425855000004,-17.161860485000002,-17.450295115000003,-17.738729745000004,-18.027164375,-18.315599005000003,-18.604033635000004,-18.892468265,-19.180902895000003,-19.469337525000004,-19.757772155,-20.046206785000003,-20.334641415000004,-20.623076045000005,-20.911510675000002,-21.199945305000004,-21.488379935000005,-21.776814565000002,-22.065249195000003,-22.353683825000005,-22.642118455000002,-22.930553085000003,-23.218987715000004,-23.507422345000002,-23.795856975000003,-24.084291605000004,-24.372726235000002,-24.661160865000003,-24.949595495000004,-25.238030125,-25.526464755000003,-25.814899385000004,-26.103334015000005,-26.391768645000003,-26.680203275000004,-26.968637905000005,-27.257072535000002,-27.545507165000004,-27.833941795000005,-28.122376425000002,-28.410811055000003,-28.699245685)
time <- abs(time)
  #Speciation rate
sp_rate <- c(0.27575715063646333, 0.27575715063646333,0.27575715063646333,0.27575715063646333,0.2711875862695101,0.26524360712218964,0.2608498377410575,0.25795188341304076,0.2550266728752828,0.25079957980227596,0.24672807898578136,0.24383997771884525,0.24198770178206008,0.24116936893916888,0.24061328978271718,0.24008262112597722,0.23987204411532653,0.23974825396689065,0.23928790238750838,0.23916003053273052,0.2386461932826131,0.23840913425557778,0.2381598552023575,0.23800697529383114,0.2378321555223486,0.23760257139098517,0.23770196233349902,0.2378321555223486,0.2378321555223486,0.23793532319276517,0.23835130009315075,0.2383822934414093,0.23849374623541653,0.2386461932826131,0.23907975410922044,0.23961436510167622,0.23986413103713214,0.2400496710772515,0.240532571752678,0.24102736820416426,0.2413077989608744,0.24128817830502602,0.2413077989608744,0.2413077989608744,0.24131759656585233,0.24131759656585233,0.24131759656585233,0.24131759656585233,0.24134306933712568,0.24153343154723253,0.24153343154723253,0.24159341875602974,0.24159341875602974,0.24159341875602974,0.24161404224888552,0.24166388322314883,0.2417164746723902,0.2417164746723902,0.24170155583129577,0.2417164746723902,0.24185035898214483,0.2420161654382958,0.24206398310777144,0.2422714088740487,0.24228006542123637,0.2424776706423461,0.2428203752722117,0.24308059940236493,0.2437922056079029,0.2440637290199651,0.24520707351245544,0.24772888843521562,0.2503890909761912,0.25308441732055464,0.2566677415219376,0.2602169762574165,0.26428988770702033,0.2677266082772728,0.2721663091159073,0.2787815913093997,0.2839157488309394,0.28520846571864406,0.2857543722360451,0.2856131355762495,0.28520846571864406,0.28498757362403465,0.2847088737423246,0.2843663218838933,0.2843663218838933,0.28454849385563685,0.28482800943214903,0.28519794719322117,0.28558077755291045,0.28566240716152247,0.2857543722360451,0.28609741230839825,0.28649426573597325,0.28687189981841343,0.2875172726405014,0.2883225151626492)
sp_minHPD <- c(0.1784656467967239, 0.1784656467967239,0.1784656467967239,0.1784656467967239,0.17014407834430295,0.17566399655054377,0.16880621925220138,0.16060647399037511,0.14985522334231127,0.15817263330567252,0.14985522334231127,0.14497667655402774,0.14910763244740677,0.16060647399037511,0.15994177848636867,0.1588374526737055,0.16136691340469075,0.1588374526737055,0.1626415497913554,0.16417989569134808,0.16417989569134808,0.16422386110333673,0.16417989569134808,0.16358458785760602,0.16417989569134808,0.16417989569134808,0.16417989569134808,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16417989569134808,0.16417989569134808,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.1693585353708357,0.16880621925220138,0.1693585353708357,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.1693585353708357,0.16938033840008465,0.1693585353708357,0.1693585353708357,0.1693585353708357,0.1693585353708357,0.1693585353708357,0.1693585353708357,0.1693585353708357,0.1693585353708357,0.1693585353708357,0.16457853694763014,0.16356754281520794,0.16417989569134808,0.16341439327460724,0.16280016802660044,0.16417989569134808,0.16341439327460724,0.16417989569134808,0.16280016802660044,0.16060647399037511,0.16106530942641478,0.16060647399037511,0.1545368321250407,0.14628831192567007,0.16060647399037511,0.16060647399037511,0.16280016802660044,0.1586396594479816,0.1501400520268001,0.16548290293838658,0.17987786947618067,0.17756087557980635,0.17046546659273426,0.17046546659273426,0.17756087557980635,0.18898709098197736,0.18195427462335062,0.1874657474917303,0.18898709098197736,0.1874657474917303,0.1874657474917303,0.184499792277952,0.1874657474917303,0.1874657474917303,0.18899995545243828,0.18821245806654496,0.18899995545243828,0.18195427462335062,0.17206507965274695)
sp_maxHPD <- c(0.7623261497765501, 0.7623261497765501,0.7623261497765501,0.7623261497765501,0.7238425516926109,0.6802421115633681,0.6477756268059125,0.6163266995399617,0.565556747945624,0.5191395072312001,0.450443665692801,0.37507721172048275,0.3285095283538658,0.3269792482430655,0.31833590926545563,0.31442293225394075,0.31377749262120513,0.31102974591477306,0.3106078396585028,0.3097222467878235,0.3088296967788758,0.3074088790454396,0.30706782570626506,0.30593856858474905,0.30593856858474905,0.3056368279290621,0.30507897964296155,0.3097222467878235,0.3097222467878235,0.3097222467878235,0.30935427139858707,0.3097222467878235,0.30935427139858707,0.3051330281117357,0.3056368279290621,0.311204070670234,0.31102974591477306,0.3110198904396909,0.31102974591477306,0.3110198904396909,0.311204070670234,0.31102974591477306,0.3110198904396909,0.3103942725180649,0.30935427139858707,0.30935427139858707,0.30923313372233097,0.30923313372233097,0.30923313372233097,0.30923313372233097,0.30923313372233097,0.30923313372233097,0.30923313372233097,0.30923313372233097,0.30935427139858707,0.3103942725180649,0.3103942725180649,0.3106078396585028,0.31102974591477306,0.311204070670234,0.3132699560669323,0.30935427139858707,0.30935427139858707,0.311204070670234,0.31102974591477306,0.31155341709292145,0.31690918061037426,0.31982716526921035,0.3269440929096976,0.3287567518075959,0.34918423564082723,0.41397619264873714,0.46272788461668946,0.48561163449684863,0.5333057835484303,0.5881719091150849,0.6220445207306258,0.687778920907029,0.7910388926617645,1.0520962054902272,1.2258731480217386,1.2759033235940032,1.20855391036886,0.9699412533222352,0.785768368364471,0.7290081020335527,0.6960938088383998,0.677676190039101,0.680574945820171,0.6767042628369824,0.670646575782647,0.6767042628369824,0.680574945820171,0.680574945820171,0.6870196166060801,0.690712374725952,0.6962362037161851,0.7085426946106305,0.7110842345650994,0.7085426946106305)
sp_ribbon <- data.frame(time = time,
                        min = sp_minHPD,
                        max = sp_maxHPD)
  #Extinction rate
ex_rate <- c(0.7377948069288194, 0.7377948069288194,0.7377948069288194,0.7377948069288194,0.5384580941572665,0.48721833542778514,0.478944748185121,0.4767299825159494,0.4764824268704355,0.4770603273569346,0.4751947079987919,0.47382121440712166,0.4702793807281055,0.45912548969639577,0.43235931373004444,0.4105023040032832,0.3800672139951153,0.35613489019991196,0.3405849595464756,0.32414029065298977,0.29911823325965337,0.22174684193759678,0.19409256480172443,0.17545828590475443,0.16596682121854578,0.1629931133103872,0.16080678789016245,0.1596996014109094,0.15804120145572367,0.15531483898072718,0.151858604719236,0.15002249556904346,0.14864740349015243,0.14731459415791107,0.1471605869507572,0.1469964094991015,0.1467682642670433,0.14671881141517207,0.1466658805203023,0.1466658805203023,0.14680860694023934,0.14680860694023934,0.14688656641797382,0.14695037592347931,0.14684195891735544,0.1469964094991015,0.14713939338274035,0.14722863079166426,0.1474617643691564,0.14814218020024797,0.14902763882279868,0.1497663292412872,0.15070631913239144,0.15132620906180888,0.1513814658795939,0.15146610096786595,0.1513814658795939,0.15101112710131065,0.15070631913239144,0.1504107137032773,0.15001326647030974,0.14982453079636102,0.1496012460994362,0.14935983543800352,0.1492434006702799,0.14921060030418815,0.1491603216695378,0.14916684379021916,0.14916684379021916,0.14902763882279868,0.14902763882279868,0.14902763882279868,0.14906591289045054,0.14906591289045054,0.14891838959692882,0.14896206750446428,0.1489095441544497,0.14896206750446428,0.14891838959692882,0.14891838959692882,0.14896206750446428,0.1491603216695378,0.14917342743689893,0.1492434006702799,0.14928141974813408,0.14921649454841307,0.14921060030418815,0.14921060030418815,0.14916684379021916,0.14911658405162764,0.1491603216695378,0.14918916167655105,0.14917342743689893,0.1491603216695378,0.14903758811161547,0.14896206750446428,0.14891838959692882,0.14896206750446428,0.148827059056082,0.1487756833237875)
ex_minHPD <- c(0.3513163162100252, 0.3513163162100252,0.3513163162100252,0.3513163162100252,0.16276129925979219,0.18143977935283054,0.19505702197837838,0.19277140389357028,0.21542213704181495,0.21672497166381743,0.18026467013389932,0.18026467013389932,0.17118858168652729,0.1539516733491682,0.1369405523694416,0.13303012417816815,0.12773434050331758,0.1325945560516171,0.1192902877063682,0.11987612470905537,0.1134533536319352,0.11154089581641272,0.10118749123459396,0.09678653710386244,0.09003546663396568,0.08570771561478031,0.08149307885519066,0.08570771561478031,0.0871659590852057,0.08191137068977432,0.07673378355554536,0.011881208629692606,0.014498192672360164,0.02159348182812895,0.026817723546626888,0.02712998362964172,0.031866274873299315,0.031866274873299315,0.03270543390795675,0.031866274873299315,0.03456102782751237,0.051308360028315896,0.05308588096984832,0.05308588096984832,0.04971273393269465,0.051308360028315896,0.061884888458963436,0.06381044953228414,0.07267442436443784,0.07010318762475691,0.07817975418748216,0.07716624475085054,0.07916841656189498,0.0841364653183371,0.08191137068977432,0.08149307885519066,0.0841364653183371,0.08634948517123879,0.0871659590852057,0.08753041943319682,0.0841364653183371,0.0871659590852057,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.08366371166964635,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.08149307885519066,0.08149307885519066,0.08004477055404588,0.07842817191769715,0.07682723106560285,0.07682723106560285,0.07682723106560285,0.07533549927158008,0.07486772274769016,0.07533549927158008,0.06903644276233795,0.07533549927158008,0.07486772274769016,0.07533549927158008,0.07486772274769016,0.07390284283915519,0.07127418647495491,0.0683233503345664,0.06457673657268538,0.0683233503345664,0.06457673657268538,0.04843741245705131,0.04843741245705131)
ex_maxHPD <- c(1.6930341050567619, 1.6930341050567619,1.6930341050567619,1.6930341050567619,1.1815527228516989,0.8359858654948805,0.8268816359715114,0.8180110072520903,0.8359858654948805,0.8359858654948805,0.796780113821738,0.7940155835387568,0.7811897110301207,0.7649987271727255,0.7286566435230202,0.6971962218544338,0.6469005750621662,0.6360710010683684,0.6045384080486202,0.6014991760772299,0.5802672936663693,0.5558880297010317,0.5194034901310113,0.47976318042331845,0.42062894479927915,0.3913354474047974,0.3741160683597694,0.36337911966116226,0.3563793840007575,0.34082983744307593,0.3370875367649103,0.23803033278111826,0.22725274568796128,0.22589694989488637,0.22846393671107484,0.22608472164054827,0.22725274568796128,0.2266593130338479,0.22725274568796128,0.22589694989488637,0.22725274568796128,0.24323623148126075,0.24261856626978395,0.24261856626978395,0.23803033278111826,0.23803033278111826,0.24323623148126075,0.24261856626978395,0.24453749217386272,0.23803033278111826,0.23803033278111826,0.22725274568796128,0.22725274568796128,0.22725274568796128,0.22725274568796128,0.22725274568796128,0.22717125945135946,0.22717125945135946,0.22652793432328727,0.22612590698845322,0.22244592790667742,0.22589694989488637,0.2220203661301491,0.22177467456143807,0.22227760313483774,0.22244592790667742,0.22244592790667742,0.22244592790667742,0.22244592790667742,0.22244592790667742,0.22244592790667742,0.22244592790667742,0.22339099903005752,0.22339099903005752,0.22339099903005752,0.22339099903005752,0.22349285634671948,0.22227760313483774,0.22244592790667742,0.22244592790667742,0.22244592790667742,0.22177467456143807,0.22244592790667742,0.22717125945135946,0.2266593130338479,0.22967462080107873,0.23086904309880252,0.2266593130338479,0.23760986685808227,0.23565759575580353,0.23803033278111826,0.23896642077018848,0.23896642077018848,0.23803033278111826,0.23896642077018848,0.23803033278111826,0.24515189364014284,0.24838561466117207,0.23760986685808227,0.23803033278111826)
ex_ribbon <- data.frame(time = time,
                        min = ex_minHPD,
                        max = ex_maxHPD)

rates <- data.frame(time  = time,
                    sp_rate = sp_rate,
                    ex_rate = ex_rate)

ggplot(data = rates, aes(x = time, y = sp_rate))+
  scale_x_reverse(breaks = c(2.58, 5.33, 15.97, 23.03, 27.82, 33.9)) +
  geom_ribbon(data = sp_ribbon, aes(x = time, ymin = min, ymax = max),
              fill = "#4c4cec",
              alpha = 0.2) +
  geom_ribbon(data = ex_ribbon, aes(x = time, ymin = min, ymax = max),
              fill = "#e34a33",
              alpha = 0.2) +
  geom_line(aes(x = time, y = sp_rate),
            linewidth = 1, colour = "#4c4cec") +
  geom_line(aes(x = time, y = ex_rate),
            linewidth = 1, colour = "#e34a33") +
  xlab("Time (Ma)") +
  ylab("Rate (event/lineage/Myr)") +
  theme(axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        axis.text = element_text(size = 12),
        panel.background = element_blank(),
        panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
  #scale_colour_manual(values = c("")) +
  coord_geo(dat = "epochs", abbrv = FALSE)





sp_rates <- data.frame(time = time,
                       value = sp_rate)

ggplot(data = sp_rates, aes(x = time, y = sp_rate))+
  scale_x_reverse(breaks = c(2.58, 5.33, 15.97, 23.03, 27.82, 33.9)) +
  geom_ribbon(data = sp_ribbon, aes(x = time, ymin = min, ymax = max),
              fill = "#4c4cec",
              alpha = 0.2) +
  geom_line(linewidth = 1, colour = "#4c4cec") +
  xlab("Time (Ma)") +
  ylab("Rate (event/lineage/Myr)") +
  theme(axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        axis.text = element_text(size = 12),
        panel.background = element_blank(),
        panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
  #scale_colour_manual(values = c("")) +
  coord_geo(dat = "epochs")

  
  
  
  
  

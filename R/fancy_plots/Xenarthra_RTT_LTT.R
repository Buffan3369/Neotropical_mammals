################################################################################
###################### Plotting Xenarthra RTT and LTT ##########################
################################################################################

library(ggplot2)
library(deeptime)
library(cowplot)

## Pilosa ----------------------------------------------------------------------
time <- c(-0.144217315, -0.43265194500000004,-0.7210865750000001,-1.009521205,-1.2979558350000002,-1.586390465,-1.8748250949999998,-2.163259725,-2.4516943550000003,-2.740128985,-3.028563615,-3.316998245,-3.6054328750000004,-3.893867505,-4.1823021350000005,-4.470736765000001,-4.759171395000001,-5.047606025000001,-5.336040655000001,-5.624475285000001,-5.912909915000001,-6.201344545,-6.489779175000001,-6.778213805000001,-7.066648435000001,-7.355083065000001,-7.643517695000001,-7.931952325,-8.220386955,-8.508821585,-8.797256215,-9.085690845,-9.374125475,-9.662560105,-9.950994735,-10.239429365000001,-10.527863995,-10.816298625,-11.104733255000001,-11.393167885,-11.681602515,-11.970037145000001,-12.258471775,-12.546906405,-12.835341035,-13.123775665,-13.412210295000001,-13.700644925,-13.989079555,-14.277514185000001,-14.565948815,-14.854383445000002,-15.142818075000001,-15.431252705,-15.719687335000001,-16.008121965,-16.296556595000002,-16.584991225000003,-16.873425855000004,-17.161860485000002,-17.450295115000003,-17.738729745000004,-18.027164375,-18.315599005000003,-18.604033635000004,-18.892468265,-19.180902895000003,-19.469337525000004,-19.757772155,-20.046206785000003,-20.334641415000004,-20.623076045000005,-20.911510675000002,-21.199945305000004,-21.488379935000005,-21.776814565000002,-22.065249195000003,-22.353683825000005,-22.642118455000002,-22.930553085000003,-23.218987715000004,-23.507422345000002,-23.795856975000003,-24.084291605000004,-24.372726235000002,-24.661160865000003,-24.949595495000004,-25.238030125,-25.526464755000003,-25.814899385000004,-26.103334015000005,-26.391768645000003,-26.680203275000004,-26.968637905000005,-27.257072535000002,-27.545507165000004,-27.833941795000005,-28.122376425000002,-28.410811055000003,-28.699245685)
time <- abs(time)
  #Speciation rate
sp_rate <- c(0.27575715063646333, 0.27575715063646333,0.27575715063646333,0.27575715063646333,0.2711875862695101,0.26524360712218964,0.2608498377410575,0.25795188341304076,0.2550266728752828,0.25079957980227596,0.24672807898578136,0.24383997771884525,0.24198770178206008,0.24116936893916888,0.24061328978271718,0.24008262112597722,0.23987204411532653,0.23974825396689065,0.23928790238750838,0.23916003053273052,0.2386461932826131,0.23840913425557778,0.2381598552023575,0.23800697529383114,0.2378321555223486,0.23760257139098517,0.23770196233349902,0.2378321555223486,0.2378321555223486,0.23793532319276517,0.23835130009315075,0.2383822934414093,0.23849374623541653,0.2386461932826131,0.23907975410922044,0.23961436510167622,0.23986413103713214,0.2400496710772515,0.240532571752678,0.24102736820416426,0.2413077989608744,0.24128817830502602,0.2413077989608744,0.2413077989608744,0.24131759656585233,0.24131759656585233,0.24131759656585233,0.24131759656585233,0.24134306933712568,0.24153343154723253,0.24153343154723253,0.24159341875602974,0.24159341875602974,0.24159341875602974,0.24161404224888552,0.24166388322314883,0.2417164746723902,0.2417164746723902,0.24170155583129577,0.2417164746723902,0.24185035898214483,0.2420161654382958,0.24206398310777144,0.2422714088740487,0.24228006542123637,0.2424776706423461,0.2428203752722117,0.24308059940236493,0.2437922056079029,0.2440637290199651,0.24520707351245544,0.24772888843521562,0.2503890909761912,0.25308441732055464,0.2566677415219376,0.2602169762574165,0.26428988770702033,0.2677266082772728,0.2721663091159073,0.2787815913093997,0.2839157488309394,0.28520846571864406,0.2857543722360451,0.2856131355762495,0.28520846571864406,0.28498757362403465,0.2847088737423246,0.2843663218838933,0.2843663218838933,0.28454849385563685,0.28482800943214903,0.28519794719322117,0.28558077755291045,0.28566240716152247,0.2857543722360451,0.28609741230839825,0.28649426573597325,0.28687189981841343,0.2875172726405014,0.2883225151626492)
sp_minHPD <- c(0.1784656467967239, 0.1784656467967239,0.1784656467967239,0.1784656467967239,0.17014407834430295,0.17566399655054377,0.16880621925220138,0.16060647399037511,0.14985522334231127,0.15817263330567252,0.14985522334231127,0.14497667655402774,0.14910763244740677,0.16060647399037511,0.15994177848636867,0.1588374526737055,0.16136691340469075,0.1588374526737055,0.1626415497913554,0.16417989569134808,0.16417989569134808,0.16422386110333673,0.16417989569134808,0.16358458785760602,0.16417989569134808,0.16417989569134808,0.16417989569134808,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16417989569134808,0.16417989569134808,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.1693585353708357,0.16880621925220138,0.1693585353708357,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.16938033840008465,0.1693585353708357,0.16938033840008465,0.1693585353708357,0.1693585353708357,0.1693585353708357,0.1693585353708357,0.1693585353708357,0.1693585353708357,0.1693585353708357,0.1693585353708357,0.1693585353708357,0.16457853694763014,0.16356754281520794,0.16417989569134808,0.16341439327460724,0.16280016802660044,0.16417989569134808,0.16341439327460724,0.16417989569134808,0.16280016802660044,0.16060647399037511,0.16106530942641478,0.16060647399037511,0.1545368321250407,0.14628831192567007,0.16060647399037511,0.16060647399037511,0.16280016802660044,0.1586396594479816,0.1501400520268001,0.16548290293838658,0.17987786947618067,0.17756087557980635,0.17046546659273426,0.17046546659273426,0.17756087557980635,0.18898709098197736,0.18195427462335062,0.1874657474917303,0.18898709098197736,0.1874657474917303,0.1874657474917303,0.184499792277952,0.1874657474917303,0.1874657474917303,0.18899995545243828,0.18821245806654496,0.18899995545243828,0.18195427462335062,0.17206507965274695)
sp_maxHPD <- c(0.7623261497765501, 0.7623261497765501,0.7623261497765501,0.7623261497765501,0.7238425516926109,0.6802421115633681,0.6477756268059125,0.6163266995399617,0.565556747945624,0.5191395072312001,0.450443665692801,0.37507721172048275,0.3285095283538658,0.3269792482430655,0.31833590926545563,0.31442293225394075,0.31377749262120513,0.31102974591477306,0.3106078396585028,0.3097222467878235,0.3088296967788758,0.3074088790454396,0.30706782570626506,0.30593856858474905,0.30593856858474905,0.3056368279290621,0.30507897964296155,0.3097222467878235,0.3097222467878235,0.3097222467878235,0.30935427139858707,0.3097222467878235,0.30935427139858707,0.3051330281117357,0.3056368279290621,0.311204070670234,0.31102974591477306,0.3110198904396909,0.31102974591477306,0.3110198904396909,0.311204070670234,0.31102974591477306,0.3110198904396909,0.3103942725180649,0.30935427139858707,0.30935427139858707,0.30923313372233097,0.30923313372233097,0.30923313372233097,0.30923313372233097,0.30923313372233097,0.30923313372233097,0.30923313372233097,0.30923313372233097,0.30935427139858707,0.3103942725180649,0.3103942725180649,0.3106078396585028,0.31102974591477306,0.311204070670234,0.3132699560669323,0.30935427139858707,0.30935427139858707,0.311204070670234,0.31102974591477306,0.31155341709292145,0.31690918061037426,0.31982716526921035,0.3269440929096976,0.3287567518075959,0.34918423564082723,0.41397619264873714,0.46272788461668946,0.48561163449684863,0.5333057835484303,0.5881719091150849,0.6220445207306258,0.687778920907029,0.7910388926617645,1.0520962054902272,1.2258731480217386,1.2759033235940032,1.20855391036886,0.9699412533222352,0.785768368364471,0.7290081020335527,0.6960938088383998,0.677676190039101,0.680574945820171,0.6767042628369824,0.670646575782647,0.6767042628369824,0.680574945820171,0.680574945820171,0.6870196166060801,0.690712374725952,0.6962362037161851,0.7085426946106305,0.7110842345650994,0.7085426946106305)
sp_ribbon <- data.frame(time = time,
                        min = sp_minHPD,
                        max = sp_maxHPD)
  #Extinction rate
ex_rate <- c(0.7377948069288194, 0.7377948069288194,0.7377948069288194,0.7377948069288194,0.5384580941572665,0.48721833542778514,0.478944748185121,0.4767299825159494,0.4764824268704355,0.4770603273569346,0.4751947079987919,0.47382121440712166,0.4702793807281055,0.45912548969639577,0.43235931373004444,0.4105023040032832,0.3800672139951153,0.35613489019991196,0.3405849595464756,0.32414029065298977,0.29911823325965337,0.22174684193759678,0.19409256480172443,0.17545828590475443,0.16596682121854578,0.1629931133103872,0.16080678789016245,0.1596996014109094,0.15804120145572367,0.15531483898072718,0.151858604719236,0.15002249556904346,0.14864740349015243,0.14731459415791107,0.1471605869507572,0.1469964094991015,0.1467682642670433,0.14671881141517207,0.1466658805203023,0.1466658805203023,0.14680860694023934,0.14680860694023934,0.14688656641797382,0.14695037592347931,0.14684195891735544,0.1469964094991015,0.14713939338274035,0.14722863079166426,0.1474617643691564,0.14814218020024797,0.14902763882279868,0.1497663292412872,0.15070631913239144,0.15132620906180888,0.1513814658795939,0.15146610096786595,0.1513814658795939,0.15101112710131065,0.15070631913239144,0.1504107137032773,0.15001326647030974,0.14982453079636102,0.1496012460994362,0.14935983543800352,0.1492434006702799,0.14921060030418815,0.1491603216695378,0.14916684379021916,0.14916684379021916,0.14902763882279868,0.14902763882279868,0.14902763882279868,0.14906591289045054,0.14906591289045054,0.14891838959692882,0.14896206750446428,0.1489095441544497,0.14896206750446428,0.14891838959692882,0.14891838959692882,0.14896206750446428,0.1491603216695378,0.14917342743689893,0.1492434006702799,0.14928141974813408,0.14921649454841307,0.14921060030418815,0.14921060030418815,0.14916684379021916,0.14911658405162764,0.1491603216695378,0.14918916167655105,0.14917342743689893,0.1491603216695378,0.14903758811161547,0.14896206750446428,0.14891838959692882,0.14896206750446428,0.148827059056082,0.1487756833237875)
ex_minHPD <- c(0.3513163162100252, 0.3513163162100252,0.3513163162100252,0.3513163162100252,0.16276129925979219,0.18143977935283054,0.19505702197837838,0.19277140389357028,0.21542213704181495,0.21672497166381743,0.18026467013389932,0.18026467013389932,0.17118858168652729,0.1539516733491682,0.1369405523694416,0.13303012417816815,0.12773434050331758,0.1325945560516171,0.1192902877063682,0.11987612470905537,0.1134533536319352,0.11154089581641272,0.10118749123459396,0.09678653710386244,0.09003546663396568,0.08570771561478031,0.08149307885519066,0.08570771561478031,0.0871659590852057,0.08191137068977432,0.07673378355554536,0.011881208629692606,0.014498192672360164,0.02159348182812895,0.026817723546626888,0.02712998362964172,0.031866274873299315,0.031866274873299315,0.03270543390795675,0.031866274873299315,0.03456102782751237,0.051308360028315896,0.05308588096984832,0.05308588096984832,0.04971273393269465,0.051308360028315896,0.061884888458963436,0.06381044953228414,0.07267442436443784,0.07010318762475691,0.07817975418748216,0.07716624475085054,0.07916841656189498,0.0841364653183371,0.08191137068977432,0.08149307885519066,0.0841364653183371,0.08634948517123879,0.0871659590852057,0.08753041943319682,0.0841364653183371,0.0871659590852057,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.08366371166964635,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.0841364653183371,0.08149307885519066,0.08149307885519066,0.08004477055404588,0.07842817191769715,0.07682723106560285,0.07682723106560285,0.07682723106560285,0.07533549927158008,0.07486772274769016,0.07533549927158008,0.06903644276233795,0.07533549927158008,0.07486772274769016,0.07533549927158008,0.07486772274769016,0.07390284283915519,0.07127418647495491,0.0683233503345664,0.06457673657268538,0.0683233503345664,0.06457673657268538,0.04843741245705131,0.04843741245705131)
ex_maxHPD <- c(1.6930341050567619, 1.6930341050567619,1.6930341050567619,1.6930341050567619,1.1815527228516989,0.8359858654948805,0.8268816359715114,0.8180110072520903,0.8359858654948805,0.8359858654948805,0.796780113821738,0.7940155835387568,0.7811897110301207,0.7649987271727255,0.7286566435230202,0.6971962218544338,0.6469005750621662,0.6360710010683684,0.6045384080486202,0.6014991760772299,0.5802672936663693,0.5558880297010317,0.5194034901310113,0.47976318042331845,0.42062894479927915,0.3913354474047974,0.3741160683597694,0.36337911966116226,0.3563793840007575,0.34082983744307593,0.3370875367649103,0.23803033278111826,0.22725274568796128,0.22589694989488637,0.22846393671107484,0.22608472164054827,0.22725274568796128,0.2266593130338479,0.22725274568796128,0.22589694989488637,0.22725274568796128,0.24323623148126075,0.24261856626978395,0.24261856626978395,0.23803033278111826,0.23803033278111826,0.24323623148126075,0.24261856626978395,0.24453749217386272,0.23803033278111826,0.23803033278111826,0.22725274568796128,0.22725274568796128,0.22725274568796128,0.22725274568796128,0.22725274568796128,0.22717125945135946,0.22717125945135946,0.22652793432328727,0.22612590698845322,0.22244592790667742,0.22589694989488637,0.2220203661301491,0.22177467456143807,0.22227760313483774,0.22244592790667742,0.22244592790667742,0.22244592790667742,0.22244592790667742,0.22244592790667742,0.22244592790667742,0.22244592790667742,0.22339099903005752,0.22339099903005752,0.22339099903005752,0.22339099903005752,0.22349285634671948,0.22227760313483774,0.22244592790667742,0.22244592790667742,0.22244592790667742,0.22177467456143807,0.22244592790667742,0.22717125945135946,0.2266593130338479,0.22967462080107873,0.23086904309880252,0.2266593130338479,0.23760986685808227,0.23565759575580353,0.23803033278111826,0.23896642077018848,0.23896642077018848,0.23803033278111826,0.23896642077018848,0.23803033278111826,0.24515189364014284,0.24838561466117207,0.23760986685808227,0.23803033278111826)
ex_ribbon <- data.frame(time = time,
                        min = ex_minHPD,
                        max = ex_maxHPD)

rates <- data.frame(time = time,
                    sp_rate = sp_rate,
                    ex_rate = ex_rate)

sp_ex <- ggplot(data = rates, aes(x = time, y = sp_rate)) +
  scale_x_reverse(breaks = c(2.58, 5.33, 15.97, 23.03, 27.82, 33.9)) +
  geom_ribbon(data = sp_ribbon, aes(x = time, ymin = min, ymax = max),
              fill = "#4c4cec",
              alpha = 0.2) +
  geom_ribbon(data = ex_ribbon, aes(x = time, ymin = min, ymax = max),
              fill = "#e34a33",
              alpha = 0.2) +
  geom_line(aes(x = time, y = sp_rate),
            linewidth = 1, colour = "#4c4cec",) +
  geom_line(aes(x = time, y = ex_rate),
            linewidth = 1, colour = "#e34a33") +
  labs(x = NULL,
       y = "Rate (event/lineage/Myr)") +
#  ylim(c(0, 1.5)) +
  theme(axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        axis.text = element_text(size = 12),
        legend.text = element_text(size = 10),
        panel.background = element_blank(),
        panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
  #scale_colour_manual(values = c("")) +
  coord_geo(dat = "epochs", abbrv = FALSE, size = 3)

  #Net diversification rate
net_rate=c(-0.5231326338420785, -0.5231326338420785,-0.5231326338420785,-0.5231326338420785,-0.23701835332885424,-0.17769640088551353,-0.181975508817844,-0.18835108615328747,-0.20137422634225063,-0.21784456200609084,-0.22786857518233183,-0.23578248249047964,-0.23652537556073774,-0.22457597626782086,-0.20028214486198379,-0.1717443474072659,-0.1394851356219399,-0.11531756001250883,-0.10233663734812896,-0.08902647331910944,-0.07139228963407952,-0.042225213005950946,-0.0207781997595397,0.00821082029440744,0.03171895929069984,0.042566146226062224,0.048737124666477526,0.05278268403441448,0.058052451590912914,0.06555789531872025,0.0764510721871748,0.08322403067515945,0.08855679594808631,0.09091969943037018,0.09214102713293006,0.0933324224679298,0.09439523585469746,0.09472572119388936,0.09593080963878554,0.09688117100219865,0.09746416695047776,0.09726280299539197,0.09667005985965622,0.09607913619732984,0.09601565283156727,0.09542103890367966,0.09483987666042769,0.09462420661556935,0.09396879620253622,0.09312842654515564,0.091290781149161,0.08854808776234782,0.08429032188179901,0.08126067386305755,0.08040255013125107,0.08028513472284605,0.08155832191336884,0.08355348638539652,0.08552067252656805,0.08616799650296433,0.0879925515180185,0.08886994425280768,0.08961382286811662,0.09017334344215382,0.09054787118349317,0.09092409982057639,0.09200971493578788,0.09278164872500134,0.09440362096647642,0.09555966363334197,0.09928607316854018,0.10529204156206355,0.11350202847475767,0.12280263557391048,0.13538678723225367,0.15190094556394082,0.16930683118478168,0.1903350624560539,0.21687587838216943,0.2601857446488707,0.29928815587550167,0.2999159418026766,0.29408897375831683,0.26681445300744605,0.23422448951393904,0.2179226168752535,0.20590618599587351,0.20050878949470413,0.20029331234765813,0.20188697427685992,0.20066531383802452,0.20293343278704426,0.20429743985022103,0.2046158504949696,0.20459390778344932,0.20593651408231667,0.20771411064045173,0.2080322998462527,0.20951638877500955,0.21098617806520062)
net_minHPD=c(-1.465817812738589, -1.465817812738589,-1.465817812738589,-1.465817812738589,-0.9419053807593144,-0.6045438078668308,-0.6045438078668308,-0.6045438078668308,-0.6045438078668308,-0.6042877696275104,-0.6045438078668308,-0.605865440746322,-0.578845258837585,-0.5535053622089805,-0.5077727713778516,-0.4696705642404476,-0.41449672770561874,-0.3974580946523528,-0.39357433903348316,-0.37921211130904353,-0.350818052709238,-0.32723789266298997,-0.29778357417317414,-0.24711592456071796,-0.19808113763813656,-0.17655009164320476,-0.16013598248313432,-0.14890226126637618,-0.1366729878146916,-0.1117620668359916,-0.08703188728482389,-0.03631341511338426,-0.02741578162598468,-0.020800146160220884,-0.020800146160220884,-0.01685846721448031,-0.0008147024984604401,0.0008130296983139274,0.0008130296983139274,0.0008130296983139274,0.0008130296983139274,0.0008130296983139274,0.0008130296983139274,-0.0079029326077516,-0.006165607033685738,-0.006165607033685738,-0.006165607033685738,-0.006165607033685738,-0.0079029326077516,-0.014767570352054726,-0.012865890465673713,-0.020800146160220884,-0.025026767431802488,-0.025026767431802488,-0.026385606558764207,-0.027412402863337904,-0.023775389090613247,-0.020800146160220884,-0.0193362487853182,-0.01863346210126282,-0.0193362487853182,-0.022649288626033603,-0.019967017036058105,-0.019967017036058105,-0.01685846721448031,-0.020800146160220884,-0.025026767431802488,-0.019967017036058105,-0.019967017036058105,-0.023775389090613247,-0.027412402863337904,-0.027921139086895336,-0.03550225017337558,-0.021429525832160873,-0.023775389090613247,-0.027921139086895336,-0.023775389090613247,-0.023425294117625922,-0.06393712862136725,-0.06393712862136725,-0.023425294117625922,-0.023425294117625922,-0.007366803426746504,-0.023425294117625922,-0.007366803426746504,-0.013628148259387574,0.024341761760215547,0.02177553298204965,0.02355294062767005,0.02177553298204965,0.02355294062767005,0.02355294062767005,0.02177553298204965,0.01727025304570054,0.02177553298204965,0.01727025304570054,0.02355294062767005,-0.013628148259387574,-0.013628148259387574,-0.013374233130794111)
net_maxHPD=c(0.18379621539362256, 0.18379621539362256,0.18379621539362256,0.18379621539362256,0.39768344807473555,0.318482842050299,0.24562912946874815,0.20636918100466628,0.14469999186737048,0.10764301011938948,0.07507710742791765,0.04968257895769812,0.06794729054787141,0.09577184982062359,0.12103745308799213,0.1363997437093755,0.14876802113853196,0.14641644926250036,0.1382762706856286,0.14286015149131098,0.15357729116565327,0.15622190255408658,0.16652943889532057,0.17284426927766589,0.17865414886321998,0.17661342891673573,0.17661342891673573,0.17140096134412353,0.17052987098989342,0.17865414886321998,0.18482821306185238,0.2012041486365715,0.19037472408192646,0.19099998267506102,0.1892793000294329,0.19037472408192646,0.20352340809293498,0.2033248353330404,0.2033248353330404,0.20352340809293498,0.2033248353330404,0.20278273316647819,0.2012041486365715,0.19099998267506102,0.1918868028888315,0.1918868028888315,0.19099998267506102,0.19099998267506102,0.19037472408192646,0.18274651906980427,0.18274651906980427,0.17284426927766589,0.17284426927766589,0.17284426927766589,0.17284426927766589,0.1725823698072875,0.17284426927766589,0.17293444472817632,0.17293444472817632,0.17284426927766589,0.17317199132484326,0.17317199132484326,0.1771740380077867,0.1777023937327502,0.18228870681044534,0.18060959192051557,0.1842447332962655,0.19369606550672475,0.20040924367193746,0.2019752267170909,0.23009019766687758,0.2684379274493839,0.3065499458209505,0.3647691503589384,0.38867851500266726,0.44377913963619336,0.4882923432144194,0.556177441336365,0.6273202077266228,0.8871842293693771,1.1002106161741305,1.1034049604981124,1.0706881249987115,0.849108935941276,0.6522497685177691,0.5650113753561748,0.5602531700138798,0.5437938351040258,0.5437938351040258,0.5322617324636131,0.5299507261268999,0.5437938351040258,0.5437938351040258,0.5340753644303368,0.5437938351040258,0.5432432139065773,0.5624671857586032,0.5399921689564299,0.5500999079663832,0.5534329355973359)

net_rate_df <- data.frame(time = time,
                          net_rate = net_rate)
net_ribbon <- data.frame(time = time,
                         min = net_minHPD,
                         max = net_maxHPD)
net_plot <- ggplot(data = net_rate_df, aes(x = time, y = net_rate))+
  scale_x_reverse(breaks = c(2.58, 5.33, 15.97, 23.03, 27.82, 33.9)) +
  geom_ribbon(data = net_ribbon, aes(x = time, ymin = min, ymax = max),
              fill = "#504A4B",
              alpha = 0.2) +
  geom_line(aes(x = time, y = net_rate),
            linewidth = 1, colour = "#504A4B") +
  geom_hline(yintercept = 0,
             linetype = "dashed", colour = "red") +
  labs(x = NULL,
       y = "Rate (event/lineage/Myr)") +
  ylim(c(-1.5, 1.2)) +
  theme(axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        axis.text = element_text(size = 12),
        panel.background = element_blank(),
        panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
  #scale_colour_manual(values = c("")) +
  coord_geo(dat = "epochs", abbrv = FALSE, size = 3)

  #LTT
ltt_tbl <- read.table(file = "../../PyRate_outputs/Xenarthra_cleaned/Pilosa/combined_logs/combined_6KEEP_se_est_ltt.txt",
                      header = T)
ltt_plot <- ggplot(data = ltt_tbl, aes(x = time, y = diversity)) +
  scale_x_reverse(breaks = c(2.58, 5.33, 15.97, 23.03, 27.82, 33.9)) +
  geom_line(linewidth = 1, colour = "#a1d99b") +
  xlab("Time (Ma)") +
  ylab("Diversity (nb. lineages)") +
  ylim(c(0, 40)) +
  theme(axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        axis.text = element_text(size = 12),
        panel.background = element_blank(),
        panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
  #scale_colour_manual(values = c("")) +
  coord_geo(dat = "epochs", abbrv = FALSE, size = 3)

  #Combine
top_row <- cowplot::plot_grid(sp_ex, net_plot,
                              ncol = 2,
                              rel_widths = c(1/2, 1/2))
bottom_row <- cowplot::plot_grid(NULL, ltt_plot, NULL,
                                 ncol = 3,
                                 rel_widths = c(1, 2.5, 1))
p <- cowplot::plot_grid(top_row, bottom_row, nrow = 2)

  #Save
ggsave("./figures/Pilosa_RTT_LTT.png",
       plot = p,
       height = 300,
       width = 400,
       units = "mm",
       dpi = 600)

rm(list = ls())
## Cingulata -------------------------------------------------------------------
time <- c(-0.270137365, -0.810412095,-1.350686825,-1.890961555,-2.431236285,-2.971511015,-3.511785745,-4.052060475,-4.592335205,-5.1326099350000005,-5.672884665000001,-6.213159395,-6.753434125,-7.293708855,-7.833983585,-8.374258315,-8.914533045,-9.454807775,-9.995082505000001,-10.535357235000001,-11.075631965000001,-11.615906695000001,-12.156181425000002,-12.696456155,-13.236730885,-13.777005615,-14.317280345,-14.857555075,-15.397829805,-15.938104535,-16.478379265,-17.018653995,-17.558928725,-18.099203455,-18.639478185,-19.179752915,-19.720027645000002,-20.260302375000002,-20.800577105000002,-21.340851835000002,-21.881126565000002,-22.421401295000003,-22.961676025000003,-23.501950755000003,-24.042225485000003,-24.582500215000003,-25.122774945000003,-25.663049675,-26.203324405,-26.743599135,-27.283873865,-27.824148595,-28.364423325,-28.904698055,-29.444972785,-29.985247515,-30.525522245,-31.065796975,-31.606071705,-32.146346435000005,-32.686621165000005,-33.226895895000006,-33.767170625000006,-34.307445355000006,-34.847720085000006,-35.387994815000006,-35.928269545000006,-36.468544275000006,-37.00881900500001,-37.54909373500001,-38.08936846500001,-38.62964319500001,-39.16991792500001,-39.71019265500001,-40.25046738500001,-40.79074211500001,-41.33101684500001,-41.87129157500001,-42.41156630500001,-42.95184103500001,-43.49211576500001,-44.03239049500001,-44.57266522500001,-45.11293995500001,-45.65321468500001,-46.19348941500001,-46.73376414500001,-47.27403887500001,-47.81431360500001,-48.35458833500001,-48.89486306500001,-49.43513779500001,-49.97541252500001,-50.51568725500001,-51.05596198500001,-51.596236715,-52.136511445000004,-52.676786175000004,-53.217060905000004,-53.757335635000004)
time <- abs(time)

#Speciation rate
sp_rate <- c(0.1557864655797222, 0.1557864655797222,0.15555109681718343,0.15506329294292076,0.15493827601049054,0.15483420662078318,0.1547727533225593,0.1546220143870643,0.15446197049758686,0.15423975704791587,0.15403307504026947,0.15377518825459408,0.1536176400864905,0.15360062205605896,0.15361052733657377,0.15361052733657377,0.15361052733657377,0.15361052733657377,0.15361052733657377,0.15359454820898488,0.15413825015703086,0.15684113954246356,0.15765387538409353,0.15520245696354257,0.15322542362031508,0.1530286866348292,0.1529817670506602,0.1529817670506602,0.1529572034076946,0.15294679689023136,0.15293586734663128,0.15292678340217886,0.15283066404092915,0.1528170555858942,0.1528093061903849,0.1528093061903849,0.15279671529393868,0.15279671529393868,0.1527724236064994,0.15274361159032124,0.15270881821167975,0.15270881821167975,0.15270881821167975,0.15270881821167975,0.15267167727827752,0.15267167727827752,0.15267167727827752,0.15264186962853177,0.1525827130890039,0.15256001422110593,0.15255163198126298,0.15255163198126298,0.15255163198126298,0.1525194248969199,0.15250877106907837,0.15250877106907837,0.15250877106907837,0.15250877106907837,0.15250877106907837,0.15250877106907837,0.1525194248969199,0.1525194248969199,0.1525194248969199,0.1525194248969199,0.1525194248969199,0.1525194248969199,0.1525194248969199,0.1525194248969199,0.1525194248969199,0.1525373448618004,0.1525373448618004,0.1525373448618004,0.1525194248969199,0.1525194248969199,0.1525194248969199,0.1525194248969199,0.1525194248969199,0.1525194248969199,0.1525194248969199,0.15255163198126298,0.15255163198126298,0.1525373448618004,0.1525373448618004,0.1525373448618004,0.1525373448618004,0.1525373448618004,0.1525373448618004,0.15256001422110593,0.1525827130890039,0.15267167727827752,0.15279671529393868,0.1528170555858942,0.15293586734663128,0.1530723532658634,0.15322925311174293,0.1539379148117254,0.15449145558520483,0.15508344429316878,0.15671579327723498,0.15873174122520667)
sp_minHPD <- c(0.09878660810985569, 0.09878660810985569,0.09878660810985569,0.1038922041132605,0.11017691795041365,0.11017691795041365,0.11225277627774793,0.11303122846817655,0.11303122846817655,0.11424545940182831,0.11455178087198986,0.11032257979841546,0.11093726508258804,0.11093726508258804,0.11093726508258804,0.11093726508258804,0.11093726508258804,0.11093726508258804,0.11093726508258804,0.11017691795041365,0.1082911855401007,0.1027650794305872,0.10884626425854167,0.08120439565454232,0.10133205318569734,0.10147356680311743,0.10183060736947794,0.10183060736947794,0.10201875587312324,0.10233153870407713,0.10233153870407713,0.10233153870407713,0.10233153870407713,0.10125882880246875,0.10125882880246875,0.10125882880246875,0.10125882880246875,0.10125882880246875,0.10233153870407713,0.10233153870407713,0.10233153870407713,0.10233153870407713,0.10233153870407713,0.10233153870407713,0.10233153870407713,0.10216909733527732,0.10216909733527732,0.10183060736947794,0.10125882880246875,0.10125882880246875,0.10125882880246875,0.10125882880246875,0.10125882880246875,0.10125882880246875,0.10125882880246875,0.10125882880246875,0.10125882880246875,0.10125882880246875,0.10021988211022745,0.10021988211022745,0.10021988211022745,0.10021988211022745,0.10021988211022745,0.10021988211022745,0.10021988211022745,0.10021988211022745,0.09986963901325749,0.09986963901325749,0.09986963901325749,0.09986963901325749,0.09948651169738829,0.09953502698042571,0.09948651169738829,0.09948651169738829,0.09948651169738829,0.09948651169738829,0.09948651169738829,0.09948651169738829,0.09948651169738829,0.10021988211022745,0.10021988211022745,0.10021988211022745,0.09986963901325749,0.09986963901325749,0.09948651169738829,0.09948651169738829,0.09948651169738829,0.09948651169738829,0.09948651169738829,0.09948651169738829,0.09652198244560006,0.09626944323058181,0.09221331909057941,0.0886914851966124,0.08684407210575648,0.03871670824888766,0.06609032538533727,0.0771853397739996,0.0771853397739996,0.08070410422681557)
sp_maxHPD <- c(0.21543219045587453, 0.21543219045587453,0.20342682115002497,0.19208660463535102,0.1935567719205154,0.19049525555219132,0.19090707702292362,0.18958616634696335,0.18921865545406685,0.18927549556232964,0.18927549556232964,0.18543961731480163,0.18570308397375088,0.1855455346353444,0.1855455346353444,0.1855455346353444,0.1855455346353444,0.1855455346353444,0.1855455346353444,0.1855455346353444,0.19112263814716451,0.7876275643998232,0.9240650598192209,0.6504456542398928,0.18543961731480163,0.18378269349655715,0.18407856336041503,0.18407856336041503,0.18407856336041503,0.18407856336041503,0.18393535536750322,0.18378269349655715,0.18407856336041503,0.18297812082221274,0.18307771725263253,0.18307771725263253,0.18307771725263253,0.18307771725263253,0.18407856336041503,0.18407856336041503,0.18393535536750322,0.18393535536750322,0.18393535536750322,0.18393535536750322,0.18407856336041503,0.18407856336041503,0.18407856336041503,0.18407856336041503,0.18377812512729785,0.18393535536750322,0.18393535536750322,0.18377812512729785,0.18377812512729785,0.18377812512729785,0.18377812512729785,0.18377812512729785,0.18377812512729785,0.18393535536750322,0.18297812082221274,0.18297812082221274,0.18297812082221274,0.18297812082221274,0.18297812082221274,0.18297812082221274,0.18297812082221274,0.18322170095751475,0.18297812082221274,0.18297812082221274,0.18297812082221274,0.18297812082221274,0.1828246304359141,0.18297812082221274,0.18297812082221274,0.18297812082221274,0.18297812082221274,0.18297812082221274,0.18297812082221274,0.18297812082221274,0.18297812082221274,0.18427146065762762,0.18427146065762762,0.18427146065762762,0.18407856336041503,0.18407856336041503,0.18377812512729785,0.18393535536750322,0.18393535536750322,0.18393535536750322,0.18407856336041503,0.18543961731480163,0.18371645017971217,0.18543961731480163,0.18427146065762762,0.18427146065762762,0.18879031404059593,0.204775329764815,0.4162723215438532,0.5706776649992907,0.8061637479813948,1.0437589500472728)
sp_ribbon <- data.frame(time = time,
                        min = sp_minHPD,
                        max = sp_maxHPD)
#Extinction rate
ex_rate <- c(0.5558005752086348, 0.5558005752086348,0.4693608237193192,0.42816007070932277,0.4270198376490297,0.48622507945442295,0.49359994518853484,0.4807938940864377,0.36078016120585377,0.09709194020546519,0.0876250413925142,0.0797136187608674,0.078861989867991,0.07878945460088627,0.0787621827445091,0.07874154612916637,0.07874154612916637,0.07873091380009375,0.07873091380009375,0.07867834550255212,0.07867834550255212,0.07867834550255212,0.07867834550255212,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.0787053274777191,0.07867834550255212,0.07867834550255212,0.07867834550255212,0.07867834550255212,0.07867834550255212,0.07867834550255212,0.07866739881582563,0.07866314391429281,0.07865609973634917,0.07865609973634917,0.07865609973634917,0.07864629663009667,0.07864629663009667,0.07864629663009667,0.07863433050487324,0.07863433050487324,0.07862248417022052,0.07862248417022052,0.07862248417022052,0.07862248417022052,0.07862248417022052,0.07862248417022052,0.07859778474098889,0.07855161514281878,0.07852446020826273,0.07851560372245664,0.07845177560367195,0.07843008211339211,0.07842685198880259,0.07841832900900178,0.07839381199434207,0.07830192025577248,0.07830192025577248,0.07830192025577248,0.07827502479583616,0.07826578442975134,0.07823463368313929,0.07823463368313929,0.07823463368313929,0.07823463368313929,0.07822372515965645,0.07821602159727079,0.0782100328441442,0.07820544420270477,0.07820544420270477,0.07820544420270477,0.07820078673108777,0.07820078673108777,0.07819589461091994,0.07819251868892546,0.07818339017677095,0.07811816917256267,0.07811816917256267,0.07817542764143251,0.07815841905663864,0.07815841905663864,0.07818339017677095)
ex_minHPD <- c(0.3255554432306724, 0.3255554432306724,7.96120965061777e-05,7.96120965061777e-05,7.96120965061777e-05,0.2548413793834918,0.2673894498860155,0.06859322416675762,0.06164083761275604,0.05795275845551761,0.054209639894602535,0.04993409251135692,0.05651561096017765,0.05737914656596711,0.05750973610133401,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.05810362849209133,0.05810362849209133,0.05810362849209133,0.05810362849209133,0.05810362849209133,0.05810362849209133,0.05810362849209133,0.05810362849209133,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.05810362849209133,0.05810362849209133,0.05810362849209133,0.05810362849209133,0.05810362849209133,0.057372181873870956,0.057372181873870956,0.05810362849209133,0.05810362849209133,0.05810362849209133,0.05810362849209133,0.05810362849209133,0.05810362849209133,0.057372181873870956,0.057372181873870956,0.05810362849209133,0.05810362849209133,0.05810362849209133,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.05810362849209133,0.05810362849209133,0.057372181873870956,0.057372181873870956,0.057372181873870956,0.05750973610133401,0.05737914656596711,0.05737914656596711,0.05737914656596711,0.05737914656596711,0.05690212170545692,0.05690212170545692,0.05690212170545692,0.05656452412621852,0.05652224026444685,0.05651561096017765,0.05651561096017765,0.05651561096017765,0.05651561096017765,0.056443641818944554,0.05606840257674254,0.05606840257674254,0.05588236696487376,0.05588236696487376,0.05588236696487376,0.05621848205122671,0.05621848205122671,0.05606840257674254,0.05588236696487376,0.05510025443300171,0.055035930322019436,0.0547061437025691,0.05454819244216511,0.054298516580898654,0.054298516580898654,0.054209639894602535)
ex_maxHPD <- c(1.2386003647950359, 1.2386003647950359,0.9800740703549815,0.6340543825882184,0.6339001021186331,0.9909678793403249,0.9039777117134224,0.8219754310179709,0.5671557277844617,0.5003439434231137,0.467578135661328,0.12690698308722698,0.1042044375161574,0.10353600042407435,0.10355912787797603,0.10319295413666671,0.10314384771760478,0.10308231315649075,0.10308231315649075,0.10306834286639169,0.10297259733655703,0.10297259733655703,0.10288173977305817,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10288173977305817,0.10288173977305817,0.10288173977305817,0.10288173977305817,0.10288173977305817,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10288173977305817,0.10288173977305817,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10280173639279472,0.10280173639279472,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10288173977305817,0.10288173977305817,0.10288173977305817,0.10288173977305817,0.10288173977305817,0.10297259733655703,0.10297259733655703,0.10288173977305817,0.10288173977305817,0.10288173977305817,0.10355912787797603,0.10355912787797603,0.10288173977305817,0.10297259733655703,0.10306834286639169,0.10355912787797603,0.10353600042407435,0.10353600042407435,0.10353600042407435,0.10353600042407435,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10353600042407435,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.1042044375161574,0.1042044375161574,0.1042044375161574,0.1042044375161574,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10355912787797603,0.10353600042407435)
ex_ribbon <- data.frame(time = time,
                        min = ex_minHPD,
                        max = ex_maxHPD)

rates <- data.frame(time = time,
                    sp_rate = sp_rate,
                    ex_rate = ex_rate)

sp_ex <- ggplot(data = rates, aes(x = time, y = sp_rate)) +
  scale_x_reverse(breaks = c(2.58, 5.33, 15.97, 23.03, 27.82, 33.9, 53.75),
                  labels = c(2.58, 5.33, 15.97, 23.03, 27.82, 33.9, 53.75)) +
  geom_ribbon(data = sp_ribbon, aes(x = time, ymin = min, ymax = max),
              fill = "#4c4cec",
              alpha = 0.2) +
  geom_ribbon(data = ex_ribbon, aes(x = time, ymin = min, ymax = max),
              fill = "#e34a33",
              alpha = 0.2) +
  geom_line(aes(x = time, y = sp_rate),
            linewidth = 1, colour = "#4c4cec",) +
  geom_line(aes(x = time, y = ex_rate),
            linewidth = 1, colour = "#e34a33") +
  labs(x = NULL,
       y = "Rate (event/lineage/Myr)") +
  #  ylim(c(0, 1.5)) +
  theme(axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        axis.text = element_text(size = 12),
        legend.text = element_text(size = 10),
        panel.background = element_blank(),
        panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
  #scale_colour_manual(values = c("")) +
  coord_geo(dat = "epochs", abbrv = FALSE, size = 3)

#Net diversification rate
net_rate <- c(-0.5000652210945788, -0.5000652210945788,-0.3125388499201431,-0.21214378186714103,-0.2125591123913335,-0.3526537601288914,-0.373519499595609,-0.33840201994540114,-0.1488481231287959,-0.07140391300699693,-0.023794053748138005,0.060120942027353665,0.07072558021862095,0.07134410076235691,0.07142613432767099,0.07149687107789827,0.07150661791498104,0.07153590732523539,0.07153649970921613,0.07155899625158715,0.08000849246511632,0.1419537581755279,0.16916290349560448,0.11880868539150694,0.07454617479798514,0.07053947247712603,0.07035447412266982,0.07035447412266982,0.07021858525046795,0.07013773498138945,0.07007638214091255,0.07003927183124109,0.06986881791699164,0.06983313736139789,0.06979353992144746,0.06978369045841852,0.06974684887708822,0.06974684887708822,0.0697277558999699,0.06971322134249412,0.0696963485690096,0.06961485529206185,0.06961485529206185,0.0697107696441873,0.06964344617139939,0.06961958702417648,0.06961595585281857,0.06952103245942513,0.0694076622698664,0.06940620886089041,0.06938936096800549,0.06937183886420464,0.06937183886420464,0.0692757412432642,0.06924155077027816,0.06924155077027816,0.06924155077027816,0.0692617845695964,0.06922305111868683,0.0692465021512281,0.06925242131750356,0.0692600831970213,0.0692600831970213,0.0692600831970213,0.06926609979966047,0.06928832481074826,0.06933701475514537,0.06937066933106263,0.0693840175458299,0.06949329544075046,0.06959783125041191,0.06960169227540251,0.06957107820462823,0.06961986130170554,0.06978227384527746,0.06978227384527746,0.06978388092145234,0.06996333545441248,0.06998489074319252,0.07013237320735381,0.07013237320735381,0.07006882495722283,0.07011150550736757,0.07014234374239359,0.07025753484132846,0.070352131964135,0.07038073445816607,0.07064264295478666,0.07078648942896505,0.07153294579676922,0.07187389080611259,0.07278837701800876,0.07404488469570342,0.07625201511176882,0.07968859745744584,0.08773138110191071,0.10062789969011694,0.11669101672702044,0.15081419886255104,0.21779430240533196)
net_minHPD <- c(-1.1246797956650465, -1.1246797956650465,-0.8569831836514653,-0.501049002753767,-0.5022532613641166,-0.8434335586896357,-0.7551804466833493,-0.6701741255444656,-0.4183995001418042,-0.3641782860676692,-0.3249635501042182,-0.011740663156410314,0.024648880456449834,0.025354874755030996,0.024648880456449834,0.025354874755030996,0.025354874755030996,0.025354874755030996,0.025354874755030996,0.024648880456449834,0.02200696066468738,0.01253929494061927,0.015190064147376503,-0.024801439722331252,0.011414227387515727,0.014544852235998468,0.014544852235998468,0.014544852235998468,0.014954530607395003,0.015129991346506486,0.015129991346506486,0.015129991346506486,0.015989137816873944,0.016233401745918155,0.016233401745918155,0.016233401745918155,0.016233401745918155,0.016233401745918155,0.016233401745918155,0.016233401745918155,0.016399839887900794,0.016233401745918155,0.016233401745918155,0.016399839887900794,0.016233401745918155,0.016233401745918155,0.016233401745918155,0.015190064147376503,0.015129991346506486,0.014954530607395003,0.014544852235998468,0.013799076574170552,0.013799076574170552,0.013799076574170552,0.013192423318495822,0.013192423318495822,0.013192423318495822,0.012494166968621698,0.01222103875657804,0.01222103875657804,0.01222103875657804,0.01222103875657804,0.01222103875657804,0.01222103875657804,0.01222103875657804,0.01237863146749231,0.01237863146749231,0.01222103875657804,0.01222103875657804,0.01222103875657804,0.01222103875657804,0.01222103875657804,0.011985000149944941,0.011985000149944941,0.011985000149944941,0.011985000149944941,0.011985000149944941,0.01222103875657804,0.01222103875657804,0.011414227387515727,0.011414227387515727,0.011414227387515727,0.010975381902424017,0.010603748112290215,0.010603748112290215,0.011985000149944941,0.011985000149944941,0.01205441678347513,0.01205441678347513,0.01205441678347513,0.014544852235998468,0.01205441678347513,0.008259020674375867,0.004114762299596494,-0.0035607631645925286,-0.0318994777535133,-0.0318994777535133,-0.0217944326170064,-0.0217944326170064,-0.0025919761921447126)
net_maxHPD <- c(-0.16002859241693074, -0.16002859241693074,0.1689196050195536,0.16919039950161163,0.16919039950161163,-0.0808084980457899,-0.10958992790286859,0.09464512257776907,0.10205804058740559,0.10333101978163185,0.11360752903514279,0.12157612543665758,0.11227870252562629,0.11000847806872159,0.1086199509733617,0.1086199509733617,0.1086199509733617,0.1086199509733617,0.1086199509733617,0.1086199509733617,0.11360752903514279,0.7061865821552002,0.8455691920844766,0.562285610829871,0.10370646958921359,0.10370646958921359,0.10370646958921359,0.10370646958921359,0.10380931120688763,0.10380931120688763,0.10370646958921359,0.10370646958921359,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10370646958921359,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10370646958921359,0.10370646958921359,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10370646958921359,0.10349557492620118,0.10349557492620118,0.10349557492620118,0.10349557492620118,0.10349557492620118,0.10349557492620118,0.10349557492620118,0.10380931120688763,0.10380931120688763,0.10349557492620118,0.10349557492620118,0.10370646958921359,0.10370646958921359,0.10380931120688763,0.10370646958921359,0.10370646958921359,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10380931120688763,0.10370646958921359,0.10380931120688763,0.10588354124468342,0.10588354124468342,0.10602072263975228,0.1065212564917413,0.10872136008823374,0.11227870252562629,0.1126969996855009,0.11227870252562629,0.1126969996855009,0.1135040621623767,0.15758126221252855,0.3249533522618804,0.4764856699003428,0.7184948573971588,0.9657579726862311)

net_rate_df <- data.frame(time = time,
                          net_rate = net_rate)
net_ribbon <- data.frame(time = time,
                         min = net_minHPD,
                         max = net_maxHPD)
net_plot <- ggplot(data = net_rate_df, aes(x = time, y = net_rate))+
  scale_x_reverse(breaks = c(2.58, 5.33, 15.97, 23.03, 27.82, 33.9, 53.75),
                  labels = c(2.58, 5.33, 15.97, 23.03, 27.82, 33.9, 53.75)) +
  geom_ribbon(data = net_ribbon, aes(x = time, ymin = min, ymax = max),
              fill = "#504A4B",
              alpha = 0.2) +
  geom_line(aes(x = time, y = net_rate),
            linewidth = 1, colour = "#504A4B") +
  geom_hline(yintercept = 0,
             linetype = "dashed", colour = "red") +
  labs(x = NULL,
       y = "Rate (event/lineage/Myr)") +
  ylim(c(-1.5, 1.2)) +
  theme(axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        axis.text = element_text(size = 12),
        panel.background = element_blank(),
        panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
  #scale_colour_manual(values = c("")) +
  coord_geo(dat = "epochs", abbrv = FALSE, size = 3)

#LTT
ltt_tbl <- read.table(file = "../../PyRate_outputs/Xenarthra_cleaned/Cingulata/combined_logs/combined_6KEEP_se_est_ltt.txt",
                      header = T)
ltt_plot <- ggplot(data = ltt_tbl, aes(x = time, y = diversity)) +
  scale_x_reverse(breaks = c(2.58, 5.33, 15.97, 23.03, 27.82, 33.9, 53.75),
                  labels = c(2.58, 5.33, 15.97, 23.03, 27.82, 33.9, 53.75))+
  geom_line(linewidth = 1, colour = "#a1d99b") +
  xlab("Time (Ma)") +
  ylab("Diversity (nb. lineages)") +
  scale_y_continuous(breaks = seq(0, 50, 10), label = c(seq(0, 40, 10), NA)) +
  theme(axis.title.x = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        axis.text = element_text(size = 12),
        panel.background = element_blank(),
        panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.5)) +
  #scale_colour_manual(values = c("")) +
  coord_geo(dat = "epochs", abbrv = FALSE, size = 3)

#Combine
top_row <- cowplot::plot_grid(sp_ex, net_plot,
                              ncol = 2,
                              rel_widths = c(1/2, 1/2))
bottom_row <- cowplot::plot_grid(NULL, ltt_plot, NULL,
                                 ncol = 3,
                                 rel_widths = c(1, 2.5, 1))
p <- cowplot::plot_grid(top_row, bottom_row, nrow = 2)

#Save
ggsave("./figures/Cingulata_RTT_LTT.png",
       plot = p,
       height = 300,
       width = 400,
       units = "mm",
       dpi = 600)
